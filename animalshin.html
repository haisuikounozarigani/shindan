<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>å¿ƒã®ä¸­ã®æ€§æ ¼ã©ã†ã¶ã¤è¨ºæ–­</title>
<meta name="description" content="10å•ã®ç°¡æ˜“ãƒ“ãƒƒã‚°ãƒ•ã‚¡ã‚¤ãƒ–ã§â€œå¿ƒã®ä¸­ã®æ€§æ ¼ã©ã†ã¶ã¤â€ã‚’è¡¨ç¤ºã€‚ãƒ¡ã‚¤ãƒ³ï¼‹ç›¸æ£’ï¼ˆæ¡ä»¶ï¼‰ã¨å› å­ãƒãƒ¼ã€ã‚„ã•ã—ã„ã‚±ã‚¢ä»˜ãã€‚">
<meta name="theme-color" content="#f7f9ff">
<style>
:root{
  --accent:#6b9bff; --accent2:#8bd3ff;
  --ink:#1f2732; --muted:#667087; --paper:#fff;
  --bg1:#f7f9ff; --bg2:#f2fbff; --line:#e6ecf7;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;color:var(--ink);
  background:linear-gradient(180deg,var(--bg1),var(--bg2));
  font-family:"Noto Sans JP",system-ui,-apple-system,"Segoe UI",Roboto,"Hiragino Kaku Gothic ProN",sans-serif;
}
a{color:inherit}
.wrap{max-width:980px;margin:18px auto;padding:0 14px}
header.hd{display:grid;grid-template-columns:56px 1fr;gap:12px;align-items:center;margin:8px 0}
.logo{width:56px;height:56px;border-radius:14px;background:linear-gradient(135deg,#e6f0ff,#e9fffe);display:grid;place-items:center;font-size:28px}
h1{margin:0;font-size:clamp(22px,4.6vw,34px);letter-spacing:.02em}
.sub{margin:4px 0 0;color:var(--muted);font-size:.96em}
.card{background:var(--paper);border:1px solid var(--line);border-radius:16px;padding:14px}
.section{margin:14px 0}
.pill{display:inline-block;padding:4px 8px;border:1px solid var(--line);border-radius:999px;background:#fff;color:#6b6a77;font-size:.88em}
.meta{display:flex;gap:8px;flex-wrap:wrap}
.sticky{position:sticky;top:0;z-index:10;margin:-6px -14px 12px;padding:8px 14px;background:rgba(255,255,255,.8);backdrop-filter:blur(6px) saturate(1.05);border-bottom:1px solid #e9edf7;display:flex;align-items:center;gap:10px}
.progress{height:8px;background:#edf2fb;border-radius:999px;flex:1;overflow:hidden}
.progress>span{display:block;height:100%;width:0;background:linear-gradient(90deg,var(--accent),var(--accent2));transition:width .25s ease}
.btn{padding:10px 14px;border:1px solid var(--line);border-radius:12px;background:#fff;cursor:pointer}
.btn.primary{background:linear-gradient(90deg,var(--accent),var(--accent2));border-color:transparent;color:#fff;font-weight:700}
fieldset.q{border:1px solid var(--line);border-radius:12px;padding:10px;margin:10px 0;background:#fff}
legend{font-weight:700}
.scale{display:grid;grid-template-columns:repeat(5,minmax(66px,1fr));gap:8px;margin-top:8px}
.scale input{position:absolute;opacity:0;pointer-events:none}
.scale label{display:grid;place-items:center;border:1px solid #e5e9f3;border-radius:10px;padding:8px;cursor:pointer;user-select:none;background:#fff}
.scale input:checked+label{outline:2px solid var(--accent);border-color:transparent}
mark.need{animation:need 1.6s ease}
@keyframes need{0%{box-shadow:0 0 0 0 rgba(107,155,255,.45)}100%{box-shadow:0 0 0 0 rgba(107,155,255,0)}}
.result-head{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
.badge{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;background:linear-gradient(90deg,var(--accent),var(--accent2));color:#fff;font-weight:700}
.total{font-size:22px;font-weight:800}
.small{color:var(--muted);font-size:.92em}
.grid2{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px}
.stat{border:1px solid var(--line);border-radius:12px;padding:10px;background:#fff}
.stat .big{font-size:22px;font-weight:800}
.hr{height:1px;background:var(--line);margin:10px 0}
.factor-mini{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:10px}
.bar{border:1px solid var(--line);border-radius:12px;padding:10px;background:#fff}
.bar .row{height:10px;background:#edf2fb;border-radius:999px;overflow:hidden;margin-top:6px}
.bar .row>span{display:block;height:100%;width:0;background:linear-gradient(90deg,var(--accent),var(--accent2))}
.note{border:1px solid var(--line);border-radius:12px;background:#fff;padding:10px}
.note h4{margin:0 0 6px;font-size:16px}
.back-area{display:flex;justify-content:center;margin-top:12px}
.back{display:inline-block;padding:10px 16px;border:1px solid var(--line);border-radius:12px;background:#fff;text-decoration:none}
@media (max-width: 560px){
  .wrap{padding:0 10px}
  .sticky{top:calc(env(safe-area-inset-top) + 0px); padding:8px 10px}
  .scale{grid-template-columns:repeat(2,1fr)}
  .scale label{padding:12px 8px;font-size:14px}
  .grid2{grid-template-columns:1fr}
  .card{padding:12px}
  .note h4{font-size:15px}
}
/* ==== å› å­ã”ã¨ã®ã©ã†ã¶ã¤ã‚«ãƒ¼ãƒ‰ ==== */
.zoo-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(230px,1fr));gap:12px}
.zcard{border:1px solid var(--line);border-radius:12px;background:#fff;padding:10px}
.zcard .imgbox{width:100%;aspect-ratio:1/1;border-radius:12px;overflow:hidden;border:1px solid var(--line);background:#fff;margin-bottom:8px}
.zcard img{width:100%;height:100%;object-fit:cover;display:block}
.zcard .ttl{display:flex;flex-wrap:wrap;gap:6px;align-items:center;margin-bottom:4px}
.zcard .ttl .nm{font-weight:700}
.zcard .ttl .pill{padding:3px 8px;border:1px solid var(--line);border-radius:999px;background:#fff;font-size:.86em}
</style>
</head>
<body data-id="animal"><!-- â€»indexå´ã®IDã«åˆã‚ã›ã¦å¿…è¦ãªã‚‰å¤‰æ›´ -->
<main class="wrap" id="app">
  <header class="hd">
    <div class="logo">ğŸ¦Š</div>
    <div>
      <h1>å¿ƒã®ä¸­ã®æ€§æ ¼ã©ã†ã¶ã¤è¨ºæ–­</h1>
      <p class="sub">10å•ï¼ˆ0ã€œ4ã®5ä»¶æ³•ï¼‰ã€‚ãƒ“ãƒƒã‚°ãƒ•ã‚¡ã‚¤ãƒ–5å› å­ã®ï¼…ã¨ã€Œãƒ¡ã‚¤ãƒ³ã©ã†ã¶ã¤ã€ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚â€»ã‚¨ãƒ³ã‚¿ãƒ¡è‡ªå·±ç†è§£ï¼å› æœã¯æ–­å®šã—ã¾ã›ã‚“ã€‚</p>
    </div>
  </header>

  <div class="sticky" aria-live="polite">
    <div class="progress" aria-label="å›ç­”é€²æ—" role="progressbar" aria-valuemin="0" aria-valuemax="10">
      <span id="prog"></span>
    </div>
    <button class="btn primary" id="doScore">è¨ºæ–­ã™ã‚‹</button>
  </div>

  <section class="card section" id="desc">
    <h2 style="margin:4px 0 8px">èª¬æ˜</h2>
    <div class="meta" style="margin-bottom:8px">
      <span class="pill">è³ªå•æ•°ï¼š10</span>
      <span class="pill">å½¢å¼ï¼š0â€“4ï¼ˆ0=ãœã‚“ãœã‚“ / 4=ã¨ã¦ã‚‚ï¼‰</span>
      <span class="pill">å‡ºåŠ›ï¼š5å› å­ï¼…â†’ãƒ¡ã‚¤ãƒ³ï¼‹ç›¸æ£’ï¼ˆæ¡ä»¶ï¼‰</span>
    </div>
    <p class="small">ãƒ“ãƒƒã‚°ãƒ•ã‚¡ã‚¤ãƒ–ï¼ˆå¤–å‘æ€§ãƒ»å”èª¿æ€§ãƒ»èª å®Ÿæ€§ãƒ»ç¥çµŒç—‡å‚¾å‘ãƒ»é–‹æ”¾æ€§ï¼‰ã‚’ã€è¦ªã—ã¿ã‚„ã™ã„â€œã©ã†ã¶ã¤â€ã§è¡¨ç¾ã€‚<b>ã‚„ã•ã—ã„ã‚±ã‚¢ã®ã‚³ãƒ„</b>ã‚‚è¡¨ç¤ºã—ã¾ã™ã€‚</p>
  </section>

  <!-- è¨­å• -->
  <section class="card section" id="questions">
    <h2 style="margin:4px 0 8px">è¨­å•ï¼ˆãœã‚“ãœã‚“ï¼ã‚ã¾ã‚Šï¼ã©ã¡ã‚‰ã¨ã‚‚â€¦ï¼ã‚„ã‚„ï¼ã¨ã¦ã‚‚ï¼‰</h2>
    <div id="qWrap"></div>
    <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:10px">
      <button class="btn" id="clearAns">å›ç­”ã‚’ã‚¯ãƒªã‚¢</button>
      <button class="btn primary" id="doScore2">è¨ºæ–­ã™ã‚‹</button>
    </div>
  </section>

  <!-- çµæœ -->
  <section class="card section" id="result" aria-live="polite">
    <div id="resEmpty">
      <span class="badge">ã¾ã çµæœã¯ã‚ã‚Šã¾ã›ã‚“</span>
      <p class="small">å…¨10å•ã«å›ç­”ã—ã¦ã€Œè¨ºæ–­ã™ã‚‹ã€ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚</p>
    </div>

    <div id="resArea" style="display:none">
      <div class="result-head">
        <span class="badge">çµæœ</span>
        <div class="total" id="typeLine">â€”</div>
      </div>

      <div class="grid2">
        <article class="stat" aria-label="ç·åˆãƒ¡ãƒ¢">
          <div><strong>ãƒ¡ãƒ¢</strong></div>
          <div class="small" id="sumNote">â€”</div>
        </article>
        <article class="stat" aria-label="ç›¸æ£’">
          <div><strong>ç›¸æ£’ã©ã†ã¶ã¤</strong></div>
          <div class="big" id="allyName">â€”</div>
          <div class="small" id="allyNote">æ¡ä»¶ä¸€è‡´ã®ã¨ãè¡¨ç¤º</div>
        </article>
      </div>

      <div class="hr"></div>
      <!-- å› å­ãƒãƒ¼ï¼ˆ5ï¼‰ -->
      <div class="section">
        <h3 style="margin:8px 0">5å› å­ï¼ˆï¼…ï¼‰</h3>
        <div id="bars" class="factor-mini"></div>
      </div>

      <div class="hr"></div>
      <!-- å› å­ã”ã¨ã®ã©ã†ã¶ã¤ï¼ˆç”»åƒï¼‹ã²ã¨ã“ã¨ï¼‰ -->
<div class="section" id="factorZoo">
  <h3 style="margin:8px 0">å› å­ã”ã¨ã®ã©ã†ã¶ã¤</h3>
  <div id="zooGrid" class="zoo-grid"></div>
</div>
<div class="hr"></div>
      <!-- ä»Šæ—¥ã®ã‚±ã‚¢ -->
      <details class="section" open id="careSec">
        <summary><strong>ä»Šæ—¥ã®ã‚±ã‚¢</strong></summary>
        <ul class="small" id="careList" style="margin:6px 0 0 18px;line-height:1.8"></ul>
      </details>

      <div class="hr"></div>
      <!-- ç ”ç©¶ãƒ¡ãƒ¢ -->
      <details class="section" open>
        <summary><strong>ç ”ç©¶ãƒ¡ãƒ¢</strong></summary>
        <ul class="small" id="resMemo" style="margin:6px 0 0 18px;line-height:1.8"></ul>
        <p class="small" style="margin-top:6px">â€»ç›¸é–¢ä¸­å¿ƒã§å› æœã¯æ–­å®šã§ãã¾ã›ã‚“ã€‚å€‹äººå·®ãŒã‚ã‚Šã¾ã™ã€‚åŒ»ç™‚ãƒ»æ¡ç”¨ãªã©ã®ç”¨é€”ã«ã¯ä½¿ãˆã¾ã›ã‚“ã€‚</p>
      </details>

      <div class="back-area">
        <a class="back" href="/shindan/" id="backLink" aria-label="è¨ºæ–­ä¸€è¦§ã«æˆ»ã‚‹">è¨ºæ–­ä¸€è¦§ã«æˆ»ã‚‹</a>
      </div>
    </div>
  </section>

  <section class="footer card">
    <h2 style="margin:4px 0 8px">ã”åˆ©ç”¨ã«ã‚ãŸã£ã¦</h2>
    <p class="small">ã“ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯<b>ã‚¨ãƒ³ã‚¿ãƒ¡ç”¨ã®è‡ªå·±ç†è§£</b>ã§ã™ã€‚ç¾å®Ÿã®åˆ¤æ–­ã‚„åŒ»ç™‚ãƒ»æ¡ç”¨ã«ã¯ä½¿ãˆã¾ã›ã‚“ã€‚å¿…è¦ãªå ´åˆã¯é–¢ä¿‚æ©Ÿé–¢ãƒ»å°‚é–€å®¶ã«ã”ç›¸è«‡ãã ã•ã„ã€‚<br>
    ãƒ‡ãƒ¼ã‚¿ã¯ç«¯æœ«å†…ã§å‡¦ç†ã•ã‚Œã€å€‹äººã‚’ç‰¹å®šã™ã‚‹æƒ…å ±ã®é€ä¿¡ãƒ»åé›†ã¯è¡Œã„ã¾ã›ã‚“ï¼ˆã”åˆ©ç”¨ç’°å¢ƒã«ã‚ˆã‚Šã‚¢ã‚¯ã‚»ã‚¹è§£æç­‰ãŒå‹•ä½œã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ï¼‰ã€‚</p>
  </section>
</main>

<script>
(function(){
  // ====== ãƒšãƒ¼ã‚¸æƒ…å ± ======
  var SLUG = "animal"; // å¿…è¦ãªã‚‰ index å´ã®IDã«åˆã‚ã›ã¦å¤‰æ›´
  var TITLE = "å¿ƒã®ä¸­ã®æ€§æ ¼ã©ã†ã¶ã¤è¨ºæ–­";
  var ANS_KEY = "specimens:"+SLUG+":answers";

  // ====== å› å­ãƒ»è¨­å•ï¼ˆå„å› å­2å•ï¼åˆè¨ˆ10å•ï¼‰ ======
  var FACTORS = {
    E:{ name:"å¤–å‘æ€§", items:["Q01","Q02"] },
    A:{ name:"å”èª¿æ€§", items:["Q03","Q04"] },
    C:{ name:"èª å®Ÿæ€§", items:["Q05","Q06"] },
    N:{ name:"ç¥çµŒç—‡å‚¾å‘", items:["Q07","Q08"] },
    O:{ name:"é–‹æ”¾æ€§", items:["Q09","Q10"] }
  };
  window.FACTORS = FACTORS;

  var ITEMS = {
    Q01:{ text:"åˆå¯¾é¢ã§ã‚‚ã™ãæ‰“ã¡è§£ã‘ã‚‰ã‚Œã‚‹" },
    Q02:{ text:"å¤§å‹¢ã§éã”ã™ã“ã¨ãŒå¥½ãã " },

    Q03:{ text:"å›°ã£ã¦ã„ã‚‹äººã«è‡ªç„¶ã¨æ‰‹ã‚’å·®ã—ä¼¸ã¹ã‚‹" },
    Q04:{ text:"äººã®æ„Ÿæƒ…ã«æ•æ„Ÿãªã»ã†ã " },

    Q05:{ text:"ã‚„ã‚‹ã¨æ±ºã‚ãŸã“ã¨ã¯æœ€å¾Œã¾ã§ã‚„ã‚ŠæŠœã" },
    Q06:{ text:"è¨ˆç”»çš„ã«ç‰©äº‹ã‚’é€²ã‚ã‚‹æ–¹ã " },

    Q07:{ text:"äº›ç´°ãªã“ã¨ã§æ°—åˆ†ãŒè½ã¡è¾¼ã‚€ã“ã¨ãŒã‚ã‚‹" },
    Q08:{ text:"å¿ƒé…ã—ã™ãã¦ã—ã¾ã†ã“ã¨ãŒå¤šã„" },

    Q09:{ text:"èŠ¸è¡“ã‚„ã‚¢ã‚¤ãƒ‡ã‚¢ã«æƒ¹ã‹ã‚Œã‚‹" },
    Q10:{ text:"æ–°ã—ã„ä½“é¨“ã‚„ä¾¡å€¤è¦³ã«ãƒ¯ã‚¯ãƒ¯ã‚¯ã™ã‚‹" }
  };
  var LABELS = ["ãœã‚“ãœã‚“","ã‚ã¾ã‚Š","ã©ã¡ã‚‰ã¨ã‚‚","ã‚„ã‚„","ã¨ã¦ã‚‚"];

  // ã©ã†ã¶ã¤ï¼ˆlow/mid/highï¼‰
  var ANIMALS = {
    E:{
      low:{ icon:"ğŸ¦¥", name:"ãƒŠãƒã‚±ãƒ¢ãƒ", one:"é™ã‹ã«éã”ã™ãƒã‚¤ãƒšãƒ¼ã‚¹æ´¾ã€‚å°‘äººæ•°ãŒè½ã¡ç€ãã€‚", care:[
        "å°‘äººæ•°ã®é›‘è«‡ã‹ã‚‰ã‚¦ã‚©ãƒ¼ãƒ ã‚¢ãƒƒãƒ—ã€‚","åºƒã„å ´ã§ã¯â€œç›¸æ£’â€ã‚’æ±ºã‚ã¦å‹•ãã€‚","ä¼‘æ¯â†’è¡Œå‹•ã®é †ã§äºˆå®šã‚’çµ„ã‚€ã€‚"
      ]},
      mid:{ icon:"ğŸ¿ï¸", name:"ãƒªã‚¹", one:"è¦³å¯ŸåŠ›é«˜ã‚ã®ãƒãƒ©ãƒ³ã‚¹å‹ã€‚å¿…è¦ã«å¿œã˜ã¦ç¤¾äº¤çš„ã€‚", care:[
        "å¤§å‹¢ã®å‰ã¯â€œè©±ã™è¦ç‚¹3ã¤â€ã‚’ãƒ¡ãƒ¢ã€‚","é–“ã«ã²ã¨ã‚Šæ™‚é–“ã‚’ã¯ã•ã‚€ã€‚","çŸ­æ™‚é–“ã®äº¤æµâ†’å°ä¼‘æ†©ã€‚"
      ]},
      high:{ icon:"ğŸµ", name:"ã‚µãƒ«", one:"æ˜ã‚‹ãç¤¾äº¤çš„ã€‚äººã¨ã®é–¢ã‚ã‚ŠãŒã‚¨ãƒãƒ«ã‚®ãƒ¼ã«ã€‚", care:[
        "è©±ã™ï¼šè´ãï¼1:1ã‚’æ„è­˜ã€‚","äºˆå®šã«â€œç„¡è¨ˆç”»ã‚¿ã‚¤ãƒ â€ã‚’æ®‹ã™ã€‚","å¯ã‚‹å‰30åˆ†ã¯ãƒ‡ã‚¸ã‚¿ãƒ«ä¼‘æ†©ã€‚"
      ]}
    },
    A:{
      low:{ icon:"ğŸˆ", name:"ãƒã‚³", one:"è·é›¢æ„Ÿã†ã¾ãä¿ã¤ã‚¯ãƒ¼ãƒ«æ´¾ã€‚è‡ªåˆ†ã®ãƒšãƒ¼ã‚¹é‡è¦–ã€‚", care:[
        "æ–­ã‚‹è¨€ã„æ–¹ã‚’ç”¨æ„ï¼ˆä»Šã¯é›£ã—ã„ï¼‰ã€‚","é–¢ä¿‚ã¯â€œç›®çš„ãƒ™ãƒ¼ã‚¹â€ã§è¨­è¨ˆã€‚","ã²ã¨ã‚Šå……é›»ã®æ™‚é–“ã‚’æ­»å®ˆã€‚"
      ]},
      mid:{ icon:"ğŸ¦Š", name:"ã‚­ãƒ„ãƒ", one:"åˆç†ã¨å…±æ„Ÿã®ãƒãƒ©ãƒ³ã‚¹å‹ã€‚çŠ¶æ³ã«æŸ”è»Ÿã€‚", care:[
        "é ¼ã¾ã‚Œã”ã¨ã«æœŸé™ã¨ç¯„å›²ã‚’ç¢ºèªã€‚","â€œã§ãã‚‹ãƒ»ã§ããªã„â€ã‚’æ—©ã‚ã«å®£è¨€ã€‚","è‡ªåˆ†ã®äºˆå®šã‚’å…ˆã«ãƒ–ãƒ­ãƒƒã‚¯ã€‚"
      ]},
      high:{ icon:"ğŸ¶", name:"ã‚¤ãƒŒ", one:"æ¸©åšã§èª å®Ÿã€‚ãƒãƒ¼ãƒ ã®æ½¤æ»‘æ²¹ã€‚", care:[
        "ãŠé¡˜ã„ã‚’å—ã‘ã‚‹å‰ã«â€œä»Šé€±ã®ä½™ç™½â€ã‚’ç¢ºèªã€‚","åŠ©ã‘åˆã„ã¯â€œäº¤æ›åˆ¶â€ã«ã€‚","ç–²ã‚Œã‚µã‚¤ãƒ³ã‚’ãƒ¡ãƒ¢ã—ã¦æ—©ã‚ã«ä¼‘ã‚€ã€‚"
      ]}
    },
    C:{
      low:{ icon:"ğŸ", name:"ãƒ¤ã‚®", one:"ã‚¢ã‚¤ãƒ‡ã‚¢å…ˆè¡Œã®è‡ªç”±æ´¾ã€‚ç›´æ„Ÿé‡è¦–ã€‚", care:[
        "ç· åˆ‡å‰æ—¥ã«â€œæœ€ä½ãƒ©ã‚¤ãƒ³â€ã‚’å®šç¾©ã€‚","ToDoã¯3ã¤ã¾ã§ã€‚","ä½œæ¥­ã®å‰ã«5åˆ†ã®æ®µå–ã‚Šã€‚"
      ]},
      mid:{ icon:"ğŸ§", name:"ãƒšãƒ³ã‚®ãƒ³", one:"å …å®Ÿã§å®‰å®šã€‚çœŸé¢ç›®ã•ã¨éŠã³å¿ƒã®ä¸¡ç«‹ã€‚", care:[
        "å®Œç’§ã‚ˆã‚Šã‚‚â€œæå‡ºâ†’ä¿®æ­£â€ã€‚","ä¼‘æ†©ã‚¿ã‚¤ãƒãƒ¼25-5ã‚’è©¦ã™ã€‚","è¤’ã‚ã‚’è¨˜éŒ²ã—ã¦æ¬¡ã®ç‡ƒæ–™ã«ã€‚"
      ]},
      high:{ icon:"ğŸ¦«", name:"ãƒ“ãƒ¼ãƒãƒ¼", one:"åŠªåŠ›ã¨è¨ˆç”»ã®é”äººã€‚ä¿¡é ¼ã•ã‚Œã‚‹åƒãè€…ã€‚", care:[
        "ä»Šæ—¥ã¯â€œ7å‰²OKãƒ‡ãƒ¼â€ã‚’å…¥ã‚Œã‚‹ã€‚","ç›®çš„â†’æ‰‹æ®µã‚’2æ¡ˆä¸¦ã¹ã¦æŸ”è»Ÿã«ã€‚","ã‚„ã‚‹ã“ã¨ã‚’â€œä»Šã¯1ã¤â€ã«çµã‚‹ã€‚"
      ]}
    },
    N:{
      low:{ icon:"ğŸ»", name:"ã‚¯ãƒ", one:"å®‰å®šã—ã¦å‹•ã˜ã«ãã„ã€‚é ¼ã‚Œã‚‹å®‰å¿ƒæ„Ÿã€‚", care:[
        "è² è·ã‚’å°‘ã—å¢—ã‚„ã™ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚’é€±1ã€‚","ä¼‘ã¿æ–¹ã‚’å…ˆã«æ±ºã‚ã‚‹ã€‚","é‹å‹•10åˆ†ã§ä½“ã‚’æ¸©ã‚ã‚‹ã€‚"
      ]},
      mid:{ icon:"ğŸ°", name:"ã‚¦ã‚µã‚®", one:"ç¹Šç´°ã§å…±æ„ŸåŠ›ãŒé«˜ã„ã€‚æ°—é…ã‚Šä¸Šæ‰‹ã€‚", care:[
        "æ°—åˆ†ã¨äº‹å®Ÿã‚’åˆ¥è¡Œã§ãƒ¡ãƒ¢ã€‚","é‡è¦åˆ¤æ–­ã¯ç¿Œæ—¥ã«å›ã™ã€‚","ç³–ãƒ»æ°´åˆ†ãƒ»ç¡çœ ã®åœŸå°ã‚’æ•´ãˆã‚‹ã€‚"
      ]},
      high:{ icon:"ğŸ¦”", name:"ãƒãƒªãƒã‚ºãƒŸ", one:"å‚·ã¤ãã‚„ã™ãæ…é‡ã€‚è‡ªå·±é˜²è¡›ãŒå¼·ã„ã€‚", care:[
        "ä¸å®‰0â€“10ã‚’å¯è¦–åŒ–â†’å¯¾ç­–ã‚’1ã¤ã€‚","å®‰å¿ƒã§ãã‚‹äººã«çŸ­ã„ç›¸è«‡ã€‚","é€šçŸ¥ã‚’æ•´ç†ã—åˆºæ¿€ã‚’æ¸›ã‚‰ã™ã€‚"
      ]}
    },
    O:{
      low:{ icon:"ğŸ¦™", name:"ã‚¢ãƒ«ãƒ‘ã‚«", one:"å®‰å®šã¨æ—¥å¸¸ã‚’å¤§åˆ‡ã«ã€‚ã‚†ã£ãŸã‚Šå‹ã€‚", care:[
        "æ–°ã—ã„ã“ã¨ã¯â€œ1å°ã•ã˜â€ã‹ã‚‰ã€‚","è¦‹æ…£ã‚ŒãŸé“ã«1ã¤å¯„ã‚Šé“ã€‚","ä»Šæ—¥ã®è‰¯ã‹ã£ãŸã‚’1ã¤è¨˜éŒ²ã€‚"
      ]},
      mid:{ icon:"ğŸ¦", name:"ã‚ªã‚¦ãƒ ", one:"æŸ”è»Ÿã«é©å¿œã€‚å¥½å¥‡å¿ƒã¨å®‰å®šã®ãƒãƒ©ãƒ³ã‚¹ã€‚", care:[
        "èˆˆå‘³ãƒªã‚¹ãƒˆã‚’3æœ¬æŸ±ã«ã€‚","é€±1å›ã®â€œæ–°ã—ã„ä½“é¨“â€ã€‚","æ·±æ˜ã‚Šã¨æ¨ªåºƒã’ã‚’äº¤äº’ã«ã€‚"
      ]},
      high:{ icon:"ğŸ¬", name:"ã‚¤ãƒ«ã‚«", one:"å‰µé€ çš„ã§ç›´æ„Ÿçš„ã€‚ç™ºæƒ³ãŒè»½ã‚„ã‹ã€‚", care:[
        "ã²ã‚‰ã‚ãã‚’ãƒ¡ãƒ¢â†’ç¿Œæ—¥é¸åˆ¥ã€‚","å®Ÿé¨“ã‚’â€œå®‰å…¨ã«å°ã•ãâ€ã€‚","ä¼‘æ¯ã§ç›´æ„Ÿã®è§£åƒåº¦ã‚’ä¿ã¤ã€‚"
      ]}
    }
  };

  // è¦ç´ å‚ç…§
  var qWrap   = document.getElementById("qWrap");
  var prog    = document.getElementById("prog");
  var resEmpty= document.getElementById("resEmpty");
  var resArea = document.getElementById("resArea");
  var typeLine= document.getElementById("typeLine");
  var sumNote = document.getElementById("sumNote");
  var bars    = document.getElementById("bars");
  var careList= document.getElementById("careList");
  var resMemo = document.getElementById("resMemo");
  var allyName= document.getElementById("allyName");
  var allyNote= document.getElementById("allyNote");

  // è¨­å•ç”Ÿæˆ
  function buildQuestions(){
    var html = "";
    Object.keys(ITEMS).forEach(function(qid, i){
      var q = ITEMS[qid];
      html += '<fieldset class="q" id="fs-'+qid+'">'+
        '<legend>'+String(i+1).padStart(2,"0")+'. '+q.text+'</legend>'+
        '<div class="scale" role="radiogroup" aria-label="'+q.text+'">';
      for(var v=0;v<=4;v++){
        html += '<div style="position:relative">'+
          '<input id="q'+qid+'-'+v+'" type="radio" name="q'+qid+'" value="'+v+'">'+
          '<label for="q'+qid+'-'+v+'" title="'+LABELS[v]+'">'+LABELS[v]+'</label>'+
        '</div>';
      }
      html += '</div></fieldset>';
    });
    qWrap.innerHTML = html;

    qWrap.querySelectorAll('input[type="radio"]').forEach(function(r){
      r.addEventListener('change', function(){ saveAnswers(); updateProgress(); }, false);
    });
    restoreAnswers();
    updateProgress();
  }

  // ä¿å­˜/å¾©å…ƒï¼ˆã“ã®ãƒšãƒ¼ã‚¸å°‚ç”¨ï¼‰
  function saveAnswers(){
    try{
      var out = {};
      Object.keys(ITEMS).forEach(function(id){
        var chk = qWrap.querySelector('#fs-'+id+' input[type="radio"]:checked');
        if(chk){ out[id] = parseInt(chk.value,10); }
      });
      localStorage.setItem(ANS_KEY, JSON.stringify({ts:Date.now(), ans:out}));
    }catch(e){}
  }
  function restoreAnswers(){
    try{
      var raw = localStorage.getItem(ANS_KEY);
      if(!raw) return;
      var data = JSON.parse(raw);
      var ans = (data && data.ans) || {};
      Object.keys(ans).forEach(function(id){
        var v = ans[id];
        var input = qWrap.querySelector('#q'+id+'-'+v);
        if(input){ input.checked = true; }
      });
    }catch(e){}
  }
  function wipeAnswers(){ try{ localStorage.removeItem(ANS_KEY); }catch(e){} }

  // é€²æ—
  function updateProgress(){
    var total = Object.keys(ITEMS).length; // 10
    var answered = 0;
    Object.keys(ITEMS).forEach(function(id){
      if(qWrap.querySelector('#fs-'+id+' input[type="radio"]:checked')) answered++;
    });
    var pct = Math.round(100*answered/total);
    prog.style.width = pct + "%";
    var bar = prog.parentElement;
    if(bar){
      bar.setAttribute("aria-valuenow", answered);
      bar.setAttribute("aria-label", "å›ç­”é€²æ—ï¼š"+answered+" / "+total);
    }
  }

  // è¨ˆç®—
  function calc(){
    var missing = [];
    var ans = {};
    Object.keys(ITEMS).forEach(function(id){
      var chk = qWrap.querySelector('#fs-'+id+' input[type="radio"]:checked');
      if(!chk){ missing.push(id); return; }
      ans[id] = parseInt(chk.value,10);
    });
    if(missing.length){
      alert("æœªå›ç­”ãŒã‚ã‚Šã¾ã™ã€‚å…¨10å•ã«ãŠç­”ãˆãã ã•ã„ã€‚");
      var fs = document.getElementById('fs-'+missing[0]);
      if(fs){ fs.scrollIntoView({behavior:"smooth", block:"center"}); fs.classList.add("need"); setTimeout(function(){ fs.classList.remove("need"); },1600); }
      return;
    }

    var fScore = {}, fPct = {};
    Object.keys(FACTORS).forEach(function(key){
      var ids = FACTORS[key].items;
      var sum = ids.reduce(function(s,id){ return s + ans[id]; },0);
      var avg = sum / ids.length; // 0-4
      fScore[key] = avg;
      fPct[key] = Math.round((avg/4)*100);
    });

    render({ fScore, fPct });
  }

  // ãƒ¡ã‚¤ãƒ³ï¼‹ç›¸æ£’ï¼ˆä¸»å½¹ã¨ã®å·®ãŒ8ptæœªæº€ã§ç›¸æ£’è¡¨ç¤ºï¼‰
  function pickPair(pct){
    var order = Object.keys(pct).sort(function(a,b){ return pct[b]-pct[a]; });
    var top = order[0], sec = order[1];
    var t1 = pickAnimal(top, pct[top]);
    var t2 = (pct[top]-pct[sec] < 8) ? pickAnimal(sec, pct[sec]) : null;
    return { main:t1, ally:t2 };
  }
  function pickAnimal(key, valPct){
    var lv = (valPct<=40)?'low':(valPct<=70)?'mid':'high';
    var def = ANIMALS[key][lv];
    return { key:key, pct:valPct, icon:def.icon, name:def.name, one:def.one, care:def.care };
  }

  function drawBars(pct){
  var order = ["E","A","C","N","O"];
  var html = "";
  order.forEach(function(key){
    var label = FACTORS[key].name;
    var val   = pct[key] || 0;

    // ï¼…ã‹ã‚‰ãã®å› å­ã®â€œã©ã†ã¶ã¤â€ã‚’æ±ºå®šï¼ˆğŸ¦¥ ãƒŠãƒã‚±ãƒ¢ãƒ ãªã©ï¼‰
    var ani = pickAnimal(key, val); // â†æ—¢å­˜ã®é–¢æ•°ã‚’å†åˆ©ç”¨
    var aniLabel = ani && ani.name ? 'ï¼ˆ' + (ani.icon || '') + ' ' + ani.name + 'ï¼‰' : '';

    html += '<article class="bar" aria-label="'+label+'">'+
              '<div><strong>'+label+aniLabel+'</strong>'+
                '<span class="pill" style="margin-left:6px">'+String(val).padStart(2,"0")+'%</span>'+
              '</div>'+
              '<div class="row" aria-hidden="true"><span style="width:'+val+'%"></span></div>'+
            '</article>';
  });
  bars.innerHTML = html;
}

  function render(o){
    var pair = pickPair(o.fPct);
    var t = pair.main, ally = pair.ally;

    typeLine.textContent = 'ä»Šæ—¥ã®ãƒ¡ã‚¤ãƒ³ã©ã†ã¶ã¤ï¼š'+t.icon+' '+t.name+'ï¼ˆ'+FACTORS[t.key].name+'ï¼‰';
    sumNote.textContent = t.one;

    if(ally){
      allyName.textContent = ally.icon+' '+ally.name+'ï¼ˆ'+FACTORS[ally.key].name+'ï¼‰';
      allyNote.textContent = "ä¸»å½¹ã¨ã®å·®ãŒå°ã•ã„ãŸã‚ç›¸æ£’ã¨ã—ã¦è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚";
    }else{
      allyName.textContent = "â€”";
      allyNote.textContent = "æ¡ä»¶ä¸€è‡´ã®ã¨ãè¡¨ç¤º";
    }

    // å› å­ãƒãƒ¼
    drawBars(o.fPct);

    // ã‚±ã‚¢ï¼ˆ3è¡Œï¼‰
    careList.innerHTML = (t.care||[]).map(function(s){ return "<li>"+s+"</li>"; }).join("");

    // ç ”ç©¶ãƒ¡ãƒ¢ï¼ˆBig Five ã«å³ã—ãŸâ€œã‚„ã•ã—ã„è¦ç´„â€ï¼‰
var memo = [
  "å¤–å‘æ€§ãŒé«˜ã„æ—¥ã¯ã€çŸ­æ™‚é–“ã®ç¤¾äº¤ã‚„é›‘è«‡ã§å¹¸ç¦æ„ŸãŒä¸ŠãŒã‚Šã‚„ã™ã„ã¨è¨€ã‚ã‚Œã¾ã™ï¼ˆäººæ··ã¿ãŒè‹¦æ‰‹ãªã‚‰å°‘äººæ•°ã§OKï¼‰ã€‚",
  "å”èª¿æ€§ã¯â€œæ„Ÿè¬ã‚’ä¼ãˆã‚‹/ä¸Šæ‰‹ã«é ¼ã‚‹â€ç·´ç¿’ã¨ç›¸æ€§ãŒè‰¯ãã€é–¢ä¿‚ã®æº€è¶³åº¦ãŒä¸ŠãŒã‚Šã‚„ã™ã„å‚¾å‘ãŒå ±å‘Šã•ã‚Œã¦ã„ã¾ã™ã€‚",
  "èª å®Ÿæ€§ã¯â€œå°ã•ãªè¨ˆç”»â†’æå‡ºâ†’ä¿®æ­£â€ã®æµã‚Œã§åŠ›ã‚’ç™ºæ®ã—ã€ç›®æ¨™é”æˆç‡ãŒä¸ŠãŒã‚Šã‚„ã™ã„ã¨ã•ã‚Œã¾ã™ï¼ˆå®Œç’§ä¸»ç¾©ã¯åˆ†å‰²ã‚’ï¼‰ã€‚",
  "ç¥çµŒç—‡å‚¾å‘ãŒå¼·ã„æ—¥ã¯ã€ç¡çœ ãƒ»å‘¼å¸ãƒ»é‹å‹•10åˆ†ã®åœŸå°ãŒæ°—åˆ†ã®æ³¢ã‚’å’Œã‚‰ã’ã‚„ã™ã„ã¨ã„ã†çŸ¥è¦‹ãŒã‚ã‚Šã¾ã™ã€‚è¨˜éŒ²ã‚‚å½¹ç«‹ã¡ã¾ã™ã€‚",
  "é–‹æ”¾æ€§ã¯â€œæ–°ã—ã„ä½“é¨“ã‚’ä¸€åŒ™â€ãŒåˆå›³ã€‚å‰µé€ æ€§ã®ç‡ƒæ–™ã«ãªã‚Šã‚„ã™ã„ä¸€æ–¹ã§ã€ç–²ã‚Œã¦ã„ã‚‹æ—¥ã¯åˆºæ¿€é‡ã‚’æ§ãˆã‚‹ã¨ãƒãƒ©ãƒ³ã‚¹ãŒå–ã‚Šã‚„ã™ã„ã§ã™ã€‚"
];
resMemo.innerHTML = memo.map(function(s){ return "<li>"+s+"</li>"; }).join("");

    // è¡¨ç¤ºåˆ‡æ›¿
    resEmpty.style.display = "none";
    resArea.style.display  = "block";
    document.getElementById("result").scrollIntoView({behavior:"smooth", block:"start"});

    // æœ€å¾Œã«ä¿å­˜ï¼†ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ç”¨ãƒ¡ã‚¿
    try{
      localStorage.setItem("specimens:last", JSON.stringify({ id: SLUG, title: TITLE, href: location.pathname }));
    }catch(e){}

    // index åæ˜ ç”¨ã®åˆå›³ï¼ˆæ¸ˆï¼‹LvåŠ ç®—ã‚¹ãƒ‹ãƒšãƒƒãƒˆãŒæ‹¾ã†ï¼‰
    try{ document.dispatchEvent(new Event('result:ready')); }catch(_){}
  }

  function clearAnswers(){
    qWrap.querySelectorAll('input[type="radio"]').forEach(function(r){ r.checked=false; });
    wipeAnswers(); prog.style.width="0%";
    resEmpty.style.display = ""; resArea.style.display = "none";
    var app=document.getElementById("app"); if(app){ app.scrollIntoView({behavior:"smooth", block:"start"}); }
  }

  // åˆæœŸåŒ–
  function init(){
    buildQuestions();
    resMemo.innerHTML = ["ã‚ã‚‹ç ”ç©¶ã§ã¯ã€è¤‡æ•°è¦ç´ ãŒé‡ãªã£ã¦å°è±¡ãŒå½¢ã¥ãã‚‰ã‚Œã‚‹ç¤ºå”†ã€‚"].map(function(s){return "<li>"+s+"</li>";}).join("");
  }
  if(document.readyState === "loading"){ document.addEventListener("DOMContentLoaded", init); } else { init(); }
  document.getElementById("doScore").addEventListener("click", calc, false);
  document.getElementById("doScore2").addEventListener("click", calc, false);
  document.getElementById("clearAns").addEventListener("click", clearAnswers, false);

  var back = document.getElementById("backLink");
  if(back){
    back.addEventListener("click", function(){
      try{ localStorage.setItem("specimens:last", JSON.stringify({ id: SLUG, title: TITLE, href: location.pathname })); }catch(e){}
    }, false);
  }
})();
</script>

<!-- ===== ã‚³ãƒ”ãƒšç”¨ï¼šå›ç­”ä¿å­˜ï¼‹ã‚ãªãŸ/ã¿ã‚“ãªã®ã“ã“ã‚Lvï¼ˆCountAPIï¼‰ ===================
     ç½®ãå ´æ‰€ï¼šã“ã®ã¾ã¾ </body> ã®ç›´å‰ã€‚å„è¨ºæ–­ã§ data-id ã ã‘åˆã‚ã›ã‚Œã°å…±é€šã§ä½¿ãˆã¾ã™ã€‚
============================================================================= -->
<script>
(function(){
  'use strict';
  var DONE_KEY   = 'specimens:open:byid';
  var TOTAL_KEY  = 'specimens:open:total';
  var GLOBAL_LAST= 'specimens:open:global:last';
  var MY_ID = (document.body && document.body.getAttribute('data-id')) || 'unknown';

  var ANSWER_KEY = 'specimens:answers:' + MY_ID;

  var COUNTAPI_NS  = 'haisuikounozarigani_shindan';
  var COUNTAPI_KEY = 'specimens_open_total';
  function countapiHit(){
    var url = 'https://api.countapi.xyz/hit/'+COUNTAPI_NS+'/'+COUNTAPI_KEY;
    if(navigator.sendBeacon){
      try{ navigator.sendBeacon(url); }catch(_){}
    }else{
      fetch(url, {mode:'cors', cache:'no-store', keepalive:true}).catch(function(){});
    }
  }

  // å…¥åŠ›ä¿å­˜ï¼ˆæ±ç”¨ï¼‰
  function loadState(){ try{ return JSON.parse(localStorage.getItem(ANSWER_KEY) || '{}'); }catch(_){ return {}; } }
  function saveState(obj){ try{ localStorage.setItem(ANSWER_KEY, JSON.stringify(obj)); }catch(_){ } }
  function saveField(el){
    if(!el || !el.name) return;
    var st = loadState(), nm = el.name;
    if(el.type === 'radio'){
      var chosen = (el.form || document).querySelector('input[type="radio"][name="'+nm+'"]:checked');
      st[nm] = {t:'r', v: chosen ? chosen.value : null};
    }else if(el.type === 'checkbox'){
      var all = (el.form || document).querySelectorAll('input[type="checkbox"][name="'+nm+'"]');
      var vals = []; all.forEach(function(c){ if(c.checked) vals.push(c.value || 'on'); });
      st[nm] = {t:'c', v: vals};
    }else if(el.tagName==='SELECT'){
      if(el.multiple){
        var arr=[]; [].slice.call(el.options).forEach(function(o){ if(o.selected) arr.push(o.value); });
        st[nm] = {t:'m', v: arr};
      }else{ st[nm] = {t:'s', v: el.value}; }
    }else{ st[nm] = {t:'t', v: el.value}; }
    saveState(st);
  }
  document.addEventListener('change', function(e){
    var el = e.target; if(!(el instanceof HTMLElement)) return;
    if(el.matches('input[name], select[name], textarea[name]')) saveField(el);
  }, true);
  document.addEventListener('input', function(e){
    var el = e.target; if(!(el instanceof HTMLElement)) return;
    if(el.matches('input[type="text"][name], input:not([type])[name], textarea[name]')) saveField(el);
  }, true);
  (function restoreWhenReady(){
    var TRY_MAX=12, tries=0;
    function tick(){
      tries++;
      var hasAny = document.querySelector('input[name], select[name], textarea[name]');
      if(hasAny){
        var st = loadState(); Object.keys(st).forEach(function(nm){
          var info = st[nm]; if(!info) return;
          if(info.t==='r'){
            var r = document.querySelector('input[type="radio"][name="'+nm+'"][value="'+CSS.escape(String(info.v))+'"]');
            if(r){ r.checked = true; r.dispatchEvent(new Event('change',{bubbles:true})); }
          }else if(info.t==='c'){
            var all = document.querySelectorAll('input[type="checkbox"][name="'+nm+'"]');
            var set = new Set(info.v||[]); all.forEach(function(c){ c.checked = set.has(c.value || 'on'); });
          }else if(info.t==='m'){
            var sel = document.querySelector('select[name="'+nm+'"]');
            if(sel){ var setm = new Set(info.v||[]); [].slice.call(sel.options).forEach(function(o){ o.selected = setm.has(o.value); }); }
          }else if(info.t==='s'){
            var s = document.querySelector('select[name="'+nm+'"]'); if(s){ s.value = info.v; }
          }else{
            var t = document.querySelector('[name="'+nm+'"]'); if(t){ t.value = info.v==null? '' : String(info.v); }
          }
        });
        try{ document.dispatchEvent(new Event('change',{bubbles:true})); }catch(_){}
        return;
      }
      if(tries<TRY_MAX){ setTimeout(tick, 300); }
    }
    if(document.readyState==='complete' || document.readyState==='interactive'){ tick(); }
    else document.addEventListener('DOMContentLoaded', tick);
  })();

  // çµæœç¢ºå®šã§ã€Œæ¸ˆã€ï¼‹ ã‚ãªãŸ/ã¿ã‚“ãªã®Lv ã‚’åŠ ç®—
  var marked = false;
  function markOnce(){
    if(marked) return; marked = true;
    try{
      var total = (+localStorage.getItem(TOTAL_KEY) || 0) + 1;
      localStorage.setItem(TOTAL_KEY, String(total));

      var map={}; try{ map = JSON.parse(localStorage.getItem(DONE_KEY) || '{}'); }catch(_){}
      map[MY_ID] = (map[MY_ID] || 0) + 1;
      localStorage.setItem(DONE_KEY, JSON.stringify(Object.assign({}, map, {_ts: Date.now()})));

      countapiHit();
      try{
        var last = (+localStorage.getItem(GLOBAL_LAST) || 0) + 1;
        localStorage.setItem(GLOBAL_LAST, String(last));
      }catch(_){}
    }catch(_){}
  }
  document.addEventListener('result:ready', markOnce);
  setTimeout(markOnce, 2000);
})();
</script>
</body>
</html>