<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>7ã¤ã®ä¼‘æ¯Ã—ã‚¹ã‚¤ãƒ¼ãƒ„è¨ºæ–­</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body{font-family:sans-serif;background:#fffdf8;color:#333;margin:0;padding:22px}
    h1{color:#b86b77;text-align:center;margin:10px 0 8px}
    p.lead{text-align:center;margin:0 0 18px;font-size:14px;color:#666}
    .card{max-width:900px;margin:0 auto;background:#fff;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,.06);padding:18px}
    .question{margin:18px 0 22px}
    .question p{margin:0 0 10px}
    .scale{display:grid;gap:8px}
    .scale label{display:flex;align-items:center;gap:10px;background:#f6f3f1;border-radius:8px;padding:10px}
    .btn{display:inline-block;background:#b86b77;color:#fff;border:none;border-radius:8px;padding:10px 14px;font-size:15px;cursor:pointer}
    .btn:disabled{opacity:.6;cursor:not-allowed}
    .btn.alt{background:#8a6a74}
    .actions{display:flex;gap:10px;justify-content:center;margin-top:10px;flex-wrap:wrap}
    #result{max-width:900px;margin:18px auto 0;display:none}
    .pill{display:inline-block;background:#fde9ee;color:#b86b77;padding:4px 10px;border-radius:999px;font-size:12px;margin:0 0 10px}
    .type{background:#fdf1f3;border-left:6px solid #b86b77;border-radius:10px;padding:12px 14px;margin:10px 0}
    .type h3{margin:0 0 6px;color:#b86b77;font-size:18px}
    .type small{color:#666}
    .tabs{display:flex;gap:8px;flex-wrap:wrap;margin:6px 0 8px}
    .img{width:100%;height:auto;border-radius:10px;box-shadow:0 8px 20px rgba(0,0,0,.08);margin:6px 0}
    .note{font-size:14px;color:#444;background:#fff7e6;border-left:6px solid #ffbf66;border-radius:6px;padding:10px 12px;margin:14px 0}
    .footerlink{text-align:center;margin-top:12px;display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
    .linkbtn{display:inline-block;text-decoration:none}
  </style>
</head>
<body>
  <h1>ğŸ° 7ã¤ã®ä¼‘æ¯ Ã— ã‚¹ã‚¤ãƒ¼ãƒ„è¨ºæ–­</h1>
  <p class="lead">å½“ã¦ã¯ã¾ã‚‹åº¦åˆã„ã‚’é¸ã‚“ã§ãã ã•ã„ï¼ˆ1ã€œ5ã®5ä»¶æ³•ï¼‰</p>

  <div class="card" id="formWrap">
    <form id="quizForm"></form>
    <div class="actions">
      <button class="btn" type="button" onclick="calculate()">è¨ºæ–­ã™ã‚‹</button>
      <button class="btn alt" type="button" onclick="resetForm()">ãƒªã‚»ãƒƒãƒˆ</button>
    </div>
  </div>

  <div id="result" class="card" aria-live="polite">
    <span class="pill">åŸºæº–ï¼šå¹³å‡4.0ä»¥ä¸Šã®å› å­ã‚’ã™ã¹ã¦è¡¨ç¤ºï¼ˆè©²å½“ãªã—ãªã‚‰ä¸Šä½2å› å­ï¼‰</span>
    <div id="types"></div>

    <div class="note">
      ğŸ”– è¤‡æ•°ã®å› å­ãŒå‡ºã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚<br>
      <strong>ã“ã®çµæœã‚’ãƒ¡ãƒ¢ãƒ»ã‚¹ã‚¯ã‚·ãƒ§ã—ã¦ã‹ã‚‰</strong>ã€ä¸‹ã®ãƒœã‚¿ãƒ³ã§æ¬¡ã¸ï¼
    </div>
    <div class="footerlink">
      <a class="btn linkbtn" href="/shindan/">è¨ºæ–­ä¸€è¦§ã¸æˆ»ã‚‹</a>
      <a class="btn alt linkbtn" href="https://seikaku.my.canva.site/sweet-shin" target="_blank" rel="noopener">è©³ã—ã„è§£èª¬ï¼ˆCanvaï¼‰</a>
      <button class="btn linkbtn" type="button" onclick="window.scrollTo({top:0,behavior:'smooth'})">ã‚‚ã†ä¸€åº¦ã‚„ã‚‹</button>
    </div>
  </div>

  <script>
    // 7ã¤ã®ä¼‘æ¯ã‚¿ã‚¤ãƒ—ã¨ã‚¹ã‚¤ãƒ¼ãƒ„ï¼ˆè¡¨ç¤ºç”¨ï¼‰
    const TYPES = {
      body:   {label:"èº«ä½“ã®ä¼‘æ¯",  sweet:"ã‚·ãƒ¥ãƒ¼ã‚¯ãƒªãƒ¼ãƒ  ğŸ¥", desc:"ãµã‚ã£ã¨è»½ãã‚„ã•ã—ã„ä¼‘æ¯ã‚’ã€‚ç¡çœ ãƒ»å…¥æµ´ãƒ»ã‚¹ãƒˆãƒ¬ãƒƒãƒã§ç‰©ç†çš„ã«å›å¾©ã‚’ã€‚"},
      soul:   {label:"é­‚ã®ä¼‘æ¯",    sweet:"ãƒã‚¦ãƒ ã‚¯ãƒ¼ãƒ˜ãƒ³ ğŸ°", desc:"â€œã‚„ã‚‹ã¹ãâ€ã‚ˆã‚Šâ€œã‚„ã‚ŠãŸã„â€ã‚’ã€‚å¥½ããªæœ¬ãƒ»è‡ªç„¶ãƒ»å†…çœã§å±¤ã«ã†ã‚‹ãŠã„ã‚’ã€‚"},
      create: {label:"å‰µé€ ã®ä¼‘æ¯",  sweet:"ãƒŸãƒ«ãƒ•ã‚£ãƒ¼ãƒ¦ ğŸ°",   desc:"éŠã³å¿ƒã¨æ–°ã—ã„åˆºæ¿€ã‚’ã€‚æœªä½“é¨“ã®ã‚¢ãƒ¼ãƒˆã‚„è¡—ã€å³èˆˆã®å°ã•ãªå‰µä½œã‚’ã€‚"},
      sense:  {label:"æ„Ÿè¦šã®ä¼‘æ¯",  sweet:"æä»è±†è… ğŸ®",       desc:"äº”æ„Ÿã‚’é™ã‹ã«ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ã€‚ç…§æ˜ãƒ»éŸ³ãƒ»é¦™ã‚Šã‚’è½ã¨ã—ã¦ç©ã‚„ã‹ã«ã€‚"},
      social: {label:"ç¤¾ä¼šã®ä¼‘æ¯",  sweet:"ãƒ‰ãƒ¼ãƒŠãƒ„ ğŸ©",       desc:"â€œç©ºç™½ã®ç©´â€ã‚’å„ªã—ã„äº¤æµã§ã€‚æ°—æ¥½ãªç›¸æ‰‹ã¨çŸ­æ™‚é–“ã®ä¼šè©±ã‚„æ•£æ­©ã‚’ã€‚"},
      emotion:{label:"æ„Ÿæƒ…ã®ä¼‘æ¯",  sweet:"ãƒ—ãƒªãƒ³ ğŸ®",         desc:"æ›¸ããƒ»è©±ã™ãƒ»æ³£ãã§æµã™ã€‚è©•ä¾¡ã›ãšâ€œæ„Ÿã˜ã‚‹â€ã ã‘ã®æ™‚é–“ã‚’ã€‚"},
      mental: {label:"ç²¾ç¥ã®ä¼‘æ¯",  sweet:"ãƒã‚«ãƒ­ãƒ³ ğŸ¬",       desc:"æƒ…å ±ã¨é›‘éŸ³ã‚’ä¸€åº¦ãƒŸãƒ¥ãƒ¼ãƒˆã€‚ç‘æƒ³ãƒ»ç´™ã«æ›¸ãå‡ºã—ãƒ»äºˆå®šã‚’æ¸›ã‚‰ã™ã€‚"}
    };

    // key â†’ ç”»åƒãƒ•ã‚©ãƒ«ãƒ€slugï¼ˆã‚µã‚¤ãƒˆå†…ãƒ‘ã‚¹ï¼‰
    const KEY_TO_SLUG = {
      body:'physical',
      soul:'spiritual',
      create:'creative',
      sense:'sensory',
      social:'social',
      emotion:'emotional',
      mental:'mental'
    };

    // è¨­å•ï¼ˆ2å•Ã—7å› å­ï¼14å•ï¼‰
    const QUESTIONS = [
      // èº«ä½“
      {t:"æœèµ·ãã¦ã‚‚ç–²ã‚ŒãŒæ®‹ã£ã¦ã„ã‚‹ã“ã¨ãŒå¤šã„", k:"body"},
      {t:"ä½“ã®ã‚³ãƒªã‚„é‡ã ã‚‹ã•ã‚’ã‚ˆãæ„Ÿã˜ã‚‹", k:"body"},
      // é­‚
      {t:"â€œã‚„ã‚ŠãŸã„ã“ã¨â€ã‚ˆã‚Šâ€œã‚„ã‚‹ã¹ãã“ã¨â€ã§ä¸€æ—¥ãŒåŸ‹ã¾ã‚ŠãŒã¡ã ", k:"soul"},
      {t:"è‡ªåˆ†ã®ä¾¡å€¤è¦³ã‚„ç”ŸããŒã„ãŒè–„ããªã£ã¦ã„ã‚‹æ°—ãŒã™ã‚‹", k:"soul"},
      // å‰µé€ 
      {t:"æ–°ã—ã„ã‚¢ã‚¤ãƒ‡ã‚¢ãŒæµ®ã‹ã³ã«ãã„ï¼ãƒ¯ã‚¯ãƒ¯ã‚¯ãŒæ¸›ã£ãŸ", k:"create"},
      {t:"å®Œç’§ã‚’æ±‚ã‚ã™ãã¦æ‰‹ãŒæ­¢ã¾ã‚‹ã“ã¨ãŒå¤šã„", k:"create"},
      // æ„Ÿè¦š
      {t:"äººæ··ã¿ã‚„éŸ³ãƒ»å…‰ã§ãã£ãŸã‚Šã—ã‚„ã™ã„", k:"sense"},
      {t:"é€šçŸ¥ã‚„æƒ…å ±ã®å¤šã•ã«åœ§å€’ã•ã‚Œã‚‹", k:"sense"},
      // ç¤¾ä¼š
      {t:"æ°—ã‚’ä½¿ã„ã™ãã¦ã€äººã¨ä¼šã†ã®ãŒã—ã‚“ã©ã„ã“ã¨ãŒã‚ã‚‹", k:"social"},
      {t:"æœ€è¿‘ã€æ°—æ¥½ã«è©±ã›ã‚‹ç›¸æ‰‹ã¨ä¼šã£ã¦ã„ãªã„", k:"social"},
      // æ„Ÿæƒ…
      {t:"æ„Ÿæƒ…ã‚’æŠ‘ãˆè¾¼ã¿ãŒã¡ã§ã€ã†ã¾ãè¡¨ç¾ã§ããªã„", k:"emotion"},
      {t:"æ³£ã„ãŸã‚Šæ€’ã£ãŸã‚Šã™ã‚‹ã®ã‚’æˆ‘æ…¢ã—ã¦ã—ã¾ã†", k:"emotion"},
      // ç²¾ç¥
      {t:"è€ƒãˆã”ã¨ãŒå¤šã™ãã¦é ­ãŒä¼‘ã¾ã‚‰ãªã„", k:"mental"},
      {t:"é›†ä¸­ã§ããšã€æ€è€ƒã®å¼•ãå‡ºã—ãŒæ•£ã‚‰ã‹ã£ã¦ã„ã‚‹æ„Ÿã˜ãŒã™ã‚‹", k:"mental"},
    ];

    const SCALE = [
      "1ï¼ˆã¾ã£ãŸãå½“ã¦ã¯ã¾ã‚‰ãªã„ï¼‰",
      "2ï¼ˆã‚ã¾ã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„ï¼‰",
      "3ï¼ˆã©ã¡ã‚‰ã¨ã‚‚ã„ãˆãªã„ï¼‰",
      "4ï¼ˆã‚„ã‚„å½“ã¦ã¯ã¾ã‚‹ï¼‰",
      "5ï¼ˆã¨ã¦ã‚‚å½“ã¦ã¯ã¾ã‚‹ï¼‰"
    ];

    // ãƒ•ã‚©ãƒ¼ãƒ æç”»
    const form = document.getElementById("quizForm");
    QUESTIONS.forEach((q, i) => {
      const block = document.createElement("div");
      block.className = "question";
      block.innerHTML = `<p>Q${i+1}. ${q.t}</p>
        <div class="scale">
          ${SCALE.map((label, idx) =>
            `<label><input type="radio" name="q${i}" value="${idx+1}"> ${label}</label>`
          ).join("")}
        </div>`;
      form.appendChild(block);
    });

    // ãƒªã‚»ãƒƒãƒˆ
    function resetForm(){
      form.reset();
      document.getElementById("result").style.display="none";
      document.getElementById("types").innerHTML="";
      window.scrollTo({top:0,behavior:"smooth"});
    }

    // ç”»åƒãƒ‘ã‚¹ã‚’è¿”ã™ï¼ˆ01=èª¬æ˜ / 02=ãŠã™ã™ã‚ï¼‰ã€‚PNGâ†’ãƒ€ãƒ¡ãªã‚‰WebPã‚’è©¦ã™ã€‚
    function setImage(imgEl, slug, no){ // no: '01' or '02'
      const base = `/shindan/assets/results/sweet/${slug}/${no}`;
      imgEl.onerror = null;
      imgEl.src = `${base}.png`;
      imgEl.onerror = () => {
        if (imgEl.src.endsWith('.png')) imgEl.src = `${base}.webp`;
      };
    }

    // è¨ºæ–­
    function calculate(){
      // é›†è¨ˆ
      const sums = {body:0,soul:0,create:0,sense:0,social:0,emotion:0,mental:0};
      const counts = {body:0,soul:0,create:0,sense:0,social:0,emotion:0,mental:0};

      for(let i=0;i<QUESTIONS.length;i++){
        const sel = document.querySelector(`input[name="q${i}"]:checked`);
        if(!sel){ alert(`å…¨ã¦ã®è³ªå•ã«ç­”ãˆã¦ãã ã•ã„ï¼ˆQ${i+1}ãŒæœªå›ç­”ï¼‰`); return; }
        const v = parseInt(sel.value);
        const key = QUESTIONS[i].k;
        sums[key]+=v;
        counts[key]+=1;
      }

      // å¹³å‡
      const avgs = Object.keys(sums).map(k=>({ key:k, avg: sums[k]/counts[k] }));

      // å¹³å‡4.0ä»¥ä¸Šã‚’ã™ã¹ã¦è¡¨ç¤ºã€ã‚¼ãƒ­ãªã‚‰ä¸Šä½2å› å­
      const THRESH = 4.0;
      let picked = avgs.filter(x=>x.avg>=THRESH).sort((a,b)=>b.avg-a.avg);
      if(picked.length===0){ picked = avgs.sort((a,b)=>b.avg-a.avg).slice(0,2); }

      // çµæœæç”»ï¼ˆç”»åƒã‚¿ãƒ–ä»˜ãï¼‰
      const container = document.getElementById("types");
      container.innerHTML = picked.map(({key,avg})=>{
        const t = TYPES[key];
        const slug = KEY_TO_SLUG[key];
        const pct = Math.round((avg-1)/4*100);
        const imgId = `img-${slug}`;

        return `
          <div class="type" data-slug="${slug}">
            <h3>${t.sweet}ï½œ${t.label}ï¼ˆå¹³å‡ ${avg.toFixed(1)} / 5ï½œå¿…è¦åº¦ ${pct}%ï¼‰</h3>
            <div class="tabs">
              <button class="btn" type="button" onclick="setImage(document.getElementById('${imgId}'),'${slug}','01')">èª¬æ˜ï¼ˆ01ï¼‰</button>
              <button class="btn alt" type="button" onclick="setImage(document.getElementById('${imgId}'),'${slug}','02')">ä¼‘æ¯ãŠã™ã™ã‚ï¼ˆ02ï¼‰</button>
            </div>
            <img id="${imgId}" class="img" alt="${t.label}ã®çµæœç”»åƒ" decoding="async">
            <small>${t.desc}</small>
          </div>
        `;
      }).join("");

      // ã™ã¹ã¦ã®ã‚«ãƒ¼ãƒ‰ç”»åƒã‚’ 01ï¼ˆèª¬æ˜ï¼‰ã§åˆæœŸåŒ–
      picked.forEach(({key})=>{
        const slug = KEY_TO_SLUG[key];
        const img = document.getElementById(`img-${slug}`);
        setImage(img, slug, '01');
      });

      document.getElementById("result").style.display="block";
      window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"});
    }
  </script>
</body>
</html>
