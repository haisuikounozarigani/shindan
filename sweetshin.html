<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>7ã¤ã®ä¼‘æ¯ Ã— ã‚¹ã‚¤ãƒ¼ãƒ„è¨ºæ–­</title>
<meta name="description" content="14å•ã§ä»Šã»ã—ã„â€œ7ã¤ã®ä¼‘æ¯â€ã‚¿ã‚¤ãƒ—ã‚’åˆ¤å®šã€‚ä¸»å½¹ã‚¿ã‚¤ãƒ—ã¨ã‚¹ã‚¤ãƒ¼ãƒ„ã‚’è¡¨ç¤ºã€‚ã‚¨ãƒ³ã‚¿ãƒ¡è‡ªå·±ç†è§£ã§ã™ã€‚">
<meta name="theme-color" content="#fff7fb">
<meta property="og:type" content="website">
<meta property="og:title" content="7ã¤ã®ä¼‘æ¯ Ã— ã‚¹ã‚¤ãƒ¼ãƒ„è¨ºæ–­">
<meta property="og:description" content="14å•ãƒ»7ã‚¿ã‚¤ãƒ—ï¼…ã§ä¸»å½¹ã®ä¼‘æ¯ã‚’åˆ¤å®šã€‚ç”»åƒwebpå¯¾å¿œï¼†çµæœå…±æœ‰OKã€‚">
<meta property="og:image" content="/shindan/assets/results/sweet/t01.webp">
<style>
:root{
  --accent:#b86b77; --accent2:#ffb6c1;
  --ink:#44363a; --muted:#766e71; --paper:#fff;
  --bg1:#fff7fb; --bg2:#fffdf6; --line:#efdfdf;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;color:var(--ink);
  background:linear-gradient(180deg,var(--bg1),var(--bg2));
  font-family:"Noto Sans JP",system-ui,-apple-system,"Segoe UI",Roboto,"Hiragino Kaku Gothic ProN",sans-serif;
}
a{color:inherit}
.wrap{max-width:980px;margin:18px auto;padding:0 14px}
header.hd{display:grid;grid-template-columns:56px 1fr;gap:12px;align-items:center;margin:8px 0}
.logo{width:56px;height:56px;border-radius:14px;background:linear-gradient(135deg,#ffe5ec,#fff5e6);display:grid;place-items:center;font-size:28px}
h1{margin:0;font-size:clamp(22px,4.6vw,34px);letter-spacing:.02em}
.sub{margin:4px 0 0;color:var(--muted);font-size:.96em}
.card{background:var(--paper);border:1px solid var(--line);border-radius:16px;padding:14px}
.section{margin:14px 0}
.pill{display:inline-block;padding:4px 8px;border:1px solid var(--line);border-radius:999px;background:#fff;color:#6b6a77;font-size:.88em}
.meta{display:flex;gap:8px;flex-wrap:wrap}
.sticky{position:sticky;top:0;z-index:10;margin:-6px -14px 12px;padding:8px 14px;background:rgba(255,255,255,.85);backdrop-filter:blur(6px) saturate(1.06);border-bottom:1px solid #f0e3e3;display:flex;align-items:center;gap:10px}
.progress{height:8px;background:#fde8ee;border-radius:999px;flex:1;overflow:hidden}
.progress>span{display:block;height:100%;width:0;background:linear-gradient(90deg,var(--accent),var(--accent2));transition:width .25s ease}
.btn{padding:10px 14px;border:1px solid var(--line);border-radius:12px;background:#fff;cursor:pointer}
.btn.primary{background:linear-gradient(90deg,var(--accent),var(--accent2));border-color:transparent;color:#fff;font-weight:700}
fieldset.q{border:1px solid var(--line);border-radius:12px;padding:10px;margin:10px 0;background:#fff}
legend{font-weight:700}
.scale{display:grid;grid-template-columns:repeat(5,minmax(66px,1fr));gap:8px;margin-top:8px}
.scale input{position:absolute;opacity:0;pointer-events:none}
.scale label{display:grid;place-items:center;border:1px solid #efd8d8;border-radius:10px;padding:8px;cursor:pointer;user-select:none;background:#fff}
.scale input:checked+label{outline:2px solid var(--accent);border-color:transparent}
mark.need{animation:need 1.6s ease}
@keyframes need{0%{box-shadow:0 0 0 0 rgba(184,107,119,.4)}100%{box-shadow:0 0 0 0 rgba(184,107,119,0)}}
.result-head{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
.badge{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;background:linear-gradient(90deg,var(--accent),var(--accent2));color:#fff;font-weight:700}
.total{font-size:22px;font-weight:800}
.small{color:var(--muted);font-size:.92em}

/* ãƒ’ãƒ¼ãƒ­ãƒ¼ï¼ˆç”»åƒâ†’ãƒ†ã‚­ã‚¹ãƒˆï¼‰ */
.hero-vert{display:grid;place-items:center;border:1px solid var(--line);border-radius:16px;background:#fff;overflow:hidden}
.hero-vert figure{margin:0;width:min(720px,100%);max-width:100%;aspect-ratio:1/1;border-bottom:1px solid var(--line);background:#fff7fb}
.hero-vert img{width:100%;height:100%;object-fit:cover;display:block}
.hero-vert figcaption{padding:10px;width:100%}
.hero-vert .capline{font-weight:800;line-height:1.55;overflow-wrap:anywhere;word-break:break-word;white-space:normal}
.hero-vert .capmini{font-size:1em;line-height:1.85;color:var(--muted);overflow-wrap:anywhere;word-break:break-word;white-space:normal}

.grid2{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px}
.stat{border:1px solid var(--line);border-radius:12px;padding:10px;background:#fff}
.stat .big{font-size:22px;font-weight:800}
.hr{height:1px;background:var(--line);margin:10px 0}
.factor-mini{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:10px}
.bar{border:1px solid var(--line);border-radius:12px;padding:10px;background:#fff}
.bar .row{height:10px;background:#fde8ee;border-radius:999px;overflow:hidden;margin-top:6px}
.bar .row>span{display:block;height:100%;width:0;background:linear-gradient(90deg,var(--accent),var(--accent2))}
.note{border:1px solid var(--line);border-radius:12px;background:#fff;padding:10px}
.note h4{margin:0 0 6px;font-size:16px}

/* å…±æœ‰ãƒœã‚¿ãƒ³ */
.share-row{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
.btn.tw::before{content:"ğ•";margin-right:.25em}
.btn.line::before{content:"ğŸ’¬";margin-right:.25em}
.btn.ig::before{content:"ğŸ“¸";margin-right:.25em}
.btn.save::before{content:"â¬‡ï¸";margin-right:.25em}

@media (max-width:560px){
  .wrap{padding:0 10px}
  .sticky{top:calc(env(safe-area-inset-top) + 0px); padding:8px 10px}
  .scale{grid-template-columns:repeat(2,1fr)}
  .scale label{padding:12px 8px;font-size:14px}
  .hero-vert figure{width:100%}
  .grid2{grid-template-columns:1fr}
  .card{padding:12px}
  .hero-vert .capline{font-size:clamp(16px,5.2vw,20px);line-height:1.65}
  .hero-vert .capmini{font-size:clamp(14px,4.6vw,16px);line-height:1.95}
  .note h4{font-size:15px}
}
</style>
</head>
<body data-id="sweetshin">
<main class="wrap" id="app">
  <header class="hd">
    <div class="logo">ğŸ°</div>
    <div>
      <h1>7ã¤ã®ä¼‘æ¯ Ã— ã‚¹ã‚¤ãƒ¼ãƒ„è¨ºæ–­</h1>
      <p class="sub">14å•ï¼ˆ0ã€œ4ã®5ä»¶æ³•ï¼‰ã€‚7ã‚¿ã‚¤ãƒ—ã®ï¼…ã¨ã€Œä»Šã®ä¸»å½¹ä¼‘æ¯ã€ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚â€»ã‚¨ãƒ³ã‚¿ãƒ¡è‡ªå·±ç†è§£ï¼å› æœã¯æ–­å®šã—ã¾ã›ã‚“ã€‚</p>
    </div>
  </header>

  <div class="sticky" aria-live="polite">
    <div class="progress" aria-label="å›ç­”é€²æ—" role="progressbar" aria-valuemin="0" aria-valuemax="14">
      <span id="prog"></span>
    </div>
    <button class="btn primary" id="doScore">è¨ºæ–­ã™ã‚‹</button>
  </div>

  <section class="card section" id="desc">
    <h2 style="margin:4px 0 8px">èª¬æ˜</h2>
    <div class="meta" style="margin-bottom:8px">
      <span class="pill">è³ªå•æ•°ï¼š14</span>
      <span class="pill">å½¢å¼ï¼š0â€“4ï¼ˆ0=ãœã‚“ãœã‚“ / 4=ã¨ã¦ã‚‚ï¼‰</span>
      <span class="pill">å‡ºåŠ›ï¼š7å› å­ï¼…â†’ä¸»å½¹ï¼‹ï¼ˆæ¡ä»¶ã§ï¼‰ç›¸æ£’</span>
    </div>
    <p class="small">â€œä¼‘ã¿æ–¹ã®ã‚¯ã‚»â€ã‚’7ã‚¿ã‚¤ãƒ—ã§åˆ¤å®šã€‚<b>ã´ã£ãŸã‚Šãªã‚¹ã‚¤ãƒ¼ãƒ„</b>ã¨<b>ä»Šæ—¥ã®ã‚±ã‚¢</b>ã‚‚è¡¨ç¤ºã—ã¾ã™ã€‚</p>
  </section>

  <!-- è¨­å• -->
  <section class="card section" id="questions">
    <h2 style="margin:4px 0 8px">è¨­å•ï¼ˆãœã‚“ãœã‚“ï¼ã‚ã¾ã‚Šï¼ã¨ãã©ãï¼ã‚ˆãï¼ã¨ã¦ã‚‚ï¼‰</h2>
    <div id="qWrap"></div>
    <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:10px">
      <button class="btn" id="clearAns">å›ç­”ã‚’ã‚¯ãƒªã‚¢</button>
      <button class="btn primary" id="doScore2">è¨ºæ–­ã™ã‚‹</button>
    </div>
  </section>

  <!-- çµæœ -->
  <section class="card section" id="result" aria-live="polite">
    <div id="resEmpty">
      <span class="badge">ã¾ã çµæœã¯ã‚ã‚Šã¾ã›ã‚“</span>
      <p class="small">å…¨14å•ã«å›ç­”ã—ã¦ã€Œè¨ºæ–­ã™ã‚‹ã€ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚</p>
    </div>

    <div id="resArea" style="display:none">
      <div class="result-head">
        <span class="badge">çµæœ</span>
        <div class="total" id="typeLine">â€”</div>
      </div>

      <!-- ã‚¿ã‚¤ãƒ—ç”»åƒï¼ˆæ­£æ–¹å½¢webpï¼‰ -->
      <div class="hero-vert section" role="region" aria-label="ã‚¿ã‚¤ãƒ—ã‚¤ãƒ¡ãƒ¼ã‚¸">
        <figure>
          <img id="heroImg" src="/shindan/assets/results/sweets/t01.webp" alt="çµæœã‚¤ãƒ¡ãƒ¼ã‚¸" loading="lazy" width="1080" height="1080">
        </figure>
        <figcaption>
          <div class="capline" id="heroTitle">â€”</div>
          <div class="capmini" id="heroCopy">â€”</div>
          <div class="capmini" id="heroHint" style="margin-top:4px">â€”</div>

          <div class="share-row" id="shareRow" hidden>
            <button id="shareTw"  class="btn tw"   type="button">Xã§å…±æœ‰</button>
            <button id="shareLn"  class="btn line" type="button">LINEã§é€ã‚‹</button>
            <button id="shareIg"  class="btn ig"   type="button" aria-label="Instagramï¼ˆWebï¼‰">Instagram</button>
            <button id="shareCp"  class="btn"      type="button">ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼</button>
          </div>
        </figcaption>
      </div>

      <div class="grid2">
        <article class="stat" aria-label="ç·åˆã‚¹ã‚³ã‚¢">
          <div><strong>å› å­å¹³å‡ï¼ˆ0â€“4ï¼‰</strong></div>
          <div class="big"><span id="sumAvg">0.00</span> / 4.00 <span class="small" id="sumPct">= 0%</span></div>
          <div class="small" id="sumNote">â€”</div>
        </article>
        <article class="stat" aria-label="ç›¸æ£’">
          <div><strong>ç›¸æ£’ã‚¿ã‚¤ãƒ—</strong></div>
          <div class="big" id="allyName">â€”</div>
          <div class="small" id="allyNote">æ¡ä»¶ä¸€è‡´ã®ã¨ãè¡¨ç¤º</div>
        </article>
      </div>

      <div class="hr"></div>
      <!-- å› å­ãƒãƒ¼ï¼ˆ7ï¼‰ -->
      <div class="section">
        <h3 style="margin:8px 0">7å› å­ï¼ˆï¼…ï¼‰</h3>
        <div id="bars" class="factor-mini"></div>
      </div>

      <div class="hr"></div>
      <!-- â–¼ åŸºæº–å€¤ã‚’è¶…ãˆãŸä¼‘æ¯ï¼šè©²å½“å› å­ã¾ã¨ã‚è¡¨ç¤ºï¼ˆåˆæœŸã¯éè¡¨ç¤ºï¼‰ -->
<section class="section" id="hiScoreSec" style="display:none">
  <h3 style="margin:8px 0">åŸºæº–å€¤ã‚’è¶…ãˆãŸä¼‘æ¯</h3>
  <div id="hiWrap" class="factor-mini"></div>
</section>
<!-- â–² åŸºæº–å€¤ã‚’è¶…ãˆãŸä¼‘æ¯ -->
      <!-- ä»Šæ—¥ã®ã‚±ã‚¢ -->
      <details class="section" open id="careSec">
        <summary><strong>ä»Šæ—¥ã®ã‚±ã‚¢</strong></summary>
        <ul class="small" id="careList" style="margin:6px 0 0 18px;line-height:1.8"></ul>
      </details>

      <div class="hr"></div>
      <!-- ç ”ç©¶ãƒ¡ãƒ¢ï¼ˆæŸ”ã‚‰ã‹ãï¼‰ -->
      <details class="section" open>
        <summary><strong>ç ”ç©¶ãƒ¡ãƒ¢</strong></summary>
        <ul class="small" id="resMemo" style="margin:6px 0 0 18px;line-height:1.8"></ul>
        <p class="small" style="margin-top:6px">â€»ç›¸é–¢ä¸­å¿ƒã§å› æœã¯æ–­å®šã§ãã¾ã›ã‚“ã€‚å€‹äººå·®ãŒã‚ã‚Šã¾ã™ã€‚åŒ»ç™‚ãƒ»æ¡ç”¨ãªã©ã®ç”¨é€”ã«ã¯ä½¿ãˆã¾ã›ã‚“ã€‚</p>
      </details>

      <div class="back-area" style="display:flex;justify-content:center;margin-top:12px">
        <a class="btn" href="/shindan/" id="backLink" aria-label="è¨ºæ–­ä¸€è¦§ã«æˆ»ã‚‹">è¨ºæ–­ä¸€è¦§ã«æˆ»ã‚‹</a>
      </div>
    </div>
  </section>

  <section class="footer card">
    <h2 style="margin:4px 0 8px">ã”åˆ©ç”¨ã«ã‚ãŸã£ã¦</h2>
    <p class="small">ã“ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯<b>ã‚¨ãƒ³ã‚¿ãƒ¡ç”¨ã®è‡ªå·±ç†è§£</b>ã§ã™ã€‚ç¾å®Ÿã®åˆ¤æ–­ã‚„åŒ»ç™‚ãƒ»æ¡ç”¨ã«ã¯ä½¿ãˆã¾ã›ã‚“ã€‚å¿…è¦ãªå ´åˆã¯é–¢ä¿‚æ©Ÿé–¢ãƒ»å°‚é–€å®¶ã«ã”ç›¸è«‡ãã ã•ã„ã€‚<br>
    ãƒ‡ãƒ¼ã‚¿ã¯ç«¯æœ«å†…ã§å‡¦ç†ã•ã‚Œã€å€‹äººã‚’ç‰¹å®šã™ã‚‹æƒ…å ±ã®é€ä¿¡ãƒ»åé›†ã¯è¡Œã„ã¾ã›ã‚“ï¼ˆã”åˆ©ç”¨ç’°å¢ƒã«ã‚ˆã‚Šã‚¢ã‚¯ã‚»ã‚¹è§£æç­‰ãŒå‹•ä½œã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ï¼‰ã€‚</p>
  </section>
</main>

<script>
(function(){
  // ===== ãƒšãƒ¼ã‚¸æƒ…å ± =====
  var SLUG = "sweetshin";
  var TITLE = "7ã¤ã®ä¼‘æ¯ Ã— ã‚¹ã‚¤ãƒ¼ãƒ„è¨ºæ–­";
  var IMG_BASE = "/shindan/assets/results/sweet/"; // t01.webp..t07.webp
// 70%ä»¥ä¸Šã‚’ã€ŒåŸºæº–å€¤ã‚¯ãƒªã‚¢ã€ã¨ã¿ãªã™ï¼ˆå¿…è¦ãªã‚‰æ•°å€¤ã ã‘å¤‰ãˆã¦OKï¼‰
var HI_THRESH = 70;
  // ===== å› å­å®šç¾©ï¼ˆ7ï¼‰ =====
  // codeâ†’è¡¨ç¤ºåãƒ»ã‚¹ã‚¤ãƒ¼ãƒ„ãƒ»1è¡Œã‚³ãƒ”ãƒ¼ãƒ»ãƒ’ãƒ³ãƒˆãƒ»ã‚±ã‚¢
  var TYPES = [
    { id:1,  code:"body",   name:"èº«ä½“ã®ä¼‘æ¯",  sweet:"ã‚·ãƒ¥ãƒ¼ã‚¯ãƒªãƒ¼ãƒ  ğŸ¥",
      one:"ãµã‚ã£ã¨è»½ãã€ä½“ã«ã‚„ã•ã—ã„æ™‚é–“ãŒå¿…è¦ãã†ã€‚",
      hint:"ç¡çœ ãƒ»å…¥æµ´ãƒ»ã‚¹ãƒˆãƒ¬ãƒƒãƒã§â€œç‰©ç†çš„ã«â€å›å¾©ã€‚",
      care:["å¯ã‚‹å‰ã®ã‚¹ãƒãƒ›ã‚’15åˆ†ã‚«ãƒƒãƒˆ","ãŠé¢¨å‘‚ã§é¦–è‚©ã‚’æ¸©ã‚ã‚‹","1åˆ†ã®å…¨èº«ã‚¹ãƒˆãƒ¬ãƒƒãƒÃ—3å›"] },
    { id:2,  code:"soul",   name:"é­‚ã®ä¼‘æ¯",    sweet:"ãƒã‚¦ãƒ ã‚¯ãƒ¼ãƒ˜ãƒ³ ğŸ°",
      one:"â€œã‚„ã‚ŠãŸã„â€ã®å±¤ã‚’é‡ã­ã‚‹è£œçµ¦ãŒåˆã„ãã†ã€‚",
      hint:"è‡ªç„¶ãƒ»æœ¬ãƒ»å†…çœã§ä¾¡å€¤è¦³ã®å±¤ã«ã†ã‚‹ãŠã„ã‚’ã€‚",
      care:["å¥½ããªæœ¬ã‚’5ãƒšãƒ¼ã‚¸ã ã‘èª­ã‚€","å¤•æ–¹ã«ç©ºã‚’è¦‹ã‚‹/ç·‘ã‚’æ­©ã","ä»Šæ—¥ã®â€œã‚ˆã‹ã£ãŸâ€ã‚’1è¡Œãƒ¡ãƒ¢"] },
    { id:3,  code:"create", name:"å‰µé€ ã®ä¼‘æ¯",  sweet:"ãƒŸãƒ«ãƒ•ã‚£ãƒ¼ãƒ¦ ğŸ°",
      one:"éŠã³å¿ƒã®è–„çš®ã‚’é‡ã­ã‚‹ã¨ã€ç™ºæƒ³ã«é¢¨ãŒå…¥ã‚‹ã€‚",
      hint:"æœªä½“é¨“ã®å°ã•ãªåˆºæ¿€ã‚„å³èˆˆã®å‰µä½œã‚’ã€‚",
      care:["æœªé–‹ã®éŸ³æ¥½/è‰²ã‚’1ã¤è©¦ã™","5åˆ†ã ã‘â€œè½æ›¸ã/æ’®å½±â€","å®Œç’§ã‚ˆã‚Šâ€œã¨ã‚Šã‚ãˆãšã‚¢ãƒƒãƒ—â€"] },
    { id:4,  code:"sense",  name:"æ„Ÿè¦šã®ä¼‘æ¯",  sweet:"æä»è±†è… ğŸ®",
      one:"äº”æ„Ÿã‚’é™ã‹ã«ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ã€‚åˆºæ¿€ã‚’ä¸€æ®µä¸‹ã’ã‚ˆã†ã€‚",
      hint:"ç…§æ˜ãƒ»éŸ³ãƒ»é¦™ã‚Šã‚’è½ã¨ã—ã¦ç©ã‚„ã‹ã«ã€‚",
      care:["éƒ¨å±‹ã®å…‰é‡ã‚’50%ã«","é€šçŸ¥ã‚’30åˆ†ãƒŸãƒ¥ãƒ¼ãƒˆ","æ·±å‘¼å¸4-4-6Ã—3ã‚»ãƒƒãƒˆ"] },
    { id:5,  code:"social", name:"ç¤¾ä¼šã®ä¼‘æ¯",  sweet:"ãƒ‰ãƒ¼ãƒŠãƒ„ ğŸ©",
      one:"â€œç©ºç™½ã®ç©´â€ã‚’ã‚„ã•ã—ã„äº¤æµã§æº€ãŸã™ã¨å›å¾©ãŒæ—©ã„ã€‚",
      hint:"æ°—æ¥½ãªç›¸æ‰‹ã¨çŸ­æ™‚é–“ã®ä¼šè©±ã‚„æ•£æ­©ã‚’ã€‚",
      care:["3è¡Œã ã‘ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚‹","æ•£æ­©10åˆ†ã§å¤–ã®ç©ºæ°—ã‚’å¸ã†","â€œä»Šæ—¥ã¯ç„¡ç†ã—ãªã„â€åˆå›³ã‚’æ±ºã‚ã‚‹"] },
    { id:6,  code:"emotion",name:"æ„Ÿæƒ…ã®ä¼‘æ¯",  sweet:"ãƒ—ãƒªãƒ³ ğŸ®",
      one:"è©•ä¾¡ã›ãšã€ãŸã æ„Ÿã˜ã¦æµã™æ™‚é–“ãŒåŠ¹ãã€‚",
      hint:"æ›¸ããƒ»è©±ã™ãƒ»æ³£ãã§ãƒ‡ãƒˆãƒƒã‚¯ã‚¹ã€‚",
      care:["ä»Šæ—¥ã®æ°—åˆ†ã‚’å˜èªã§3ã¤æ›¸ã","ä¿¡é ¼ã§ãã‚‹äººã«5åˆ†ã ã‘è©±ã™","æ˜ ç”»ã‚„éŸ³æ¥½ã§â€œæ³£ãè¨±å¯â€ã‚’å‡ºã™"] },
    { id:7,  code:"mental", name:"ç²¾ç¥ã®ä¼‘æ¯",  sweet:"ãƒã‚«ãƒ­ãƒ³ ğŸ¬",
      one:"æƒ…å ±ã‚’ã²ã¨ãã¡ã‚µã‚¤ã‚ºã«ã€‚æ€è€ƒã®å¼•ãå‡ºã—ã‚’æ•´é “ã€‚",
      hint:"äºˆå®šã‚’æ¸›ã‚‰ã—ã€ç´™ã«å‡ºã—ã¦ã‹ã‚‰æ±ºã‚ã‚‹ã€‚",
      care:["ToDoã‚’3ã¤ã«çµã‚‹","è„³å†…ã®æ°—ãŒã‹ã‚Šã‚’å…¨éƒ¨æ›¸ãå‡ºã™","æ±ºæ–­ã¯â€œæ˜æ—¥æœâ€ã«å»¶æœŸã™ã‚‹"] }
  ];
  var CODE_ORDER = TYPES.map(t=>t.code); // è¡¨ç¤ºé †

  // ===== è¨­å•ï¼ˆ14ï¼‰ =====
  var ITEMS = [
    {id:"Q01", text:"æœèµ·ãã¦ã‚‚ç–²ã‚ŒãŒæ®‹ã£ã¦ã„ã‚‹ã“ã¨ãŒå¤šã„",  key:"body"},
    {id:"Q02", text:"ä½“ã®ã‚³ãƒªã‚„é‡ã ã‚‹ã•ã‚’ã‚ˆãæ„Ÿã˜ã‚‹",        key:"body"},
    {id:"Q03", text:"â€œã‚„ã‚‹ã¹ãâ€ã§ä¸€æ—¥ãŒåŸ‹ã¾ã‚ŠãŒã¡ã ",            key:"soul"},
    {id:"Q04", text:"è‡ªåˆ†ã®ä¾¡å€¤è¦³ã‚„ç”ŸããŒã„ãŒè–„ããªã£ã¦ã„ã‚‹æ°—ãŒã™ã‚‹", key:"soul"},
    {id:"Q05", text:"æ–°ã—ã„ã‚¢ã‚¤ãƒ‡ã‚¢ãŒæµ®ã‹ã³ã«ãã„/ãƒ¯ã‚¯ãƒ¯ã‚¯ãŒæ¸›ã£ãŸ", key:"create"},
    {id:"Q06", text:"å®Œç’§ã‚’æ±‚ã‚ã™ãã¦æ‰‹ãŒæ­¢ã¾ã‚‹ã“ã¨ãŒå¤šã„",        key:"create"},
    {id:"Q07", text:"äººæ··ã¿ã‚„éŸ³ãƒ»å…‰ã§ãã£ãŸã‚Šã—ã‚„ã™ã„",            key:"sense"},
    {id:"Q08", text:"é€šçŸ¥ã‚„æƒ…å ±ã®å¤šã•ã«åœ§å€’ã•ã‚Œã‚‹",                key:"sense"},
    {id:"Q09", text:"æ°—ã‚’ä½¿ã„ã™ãã¦ã€äººã¨ä¼šã†ã®ãŒã—ã‚“ã©ã„ã“ã¨ãŒã‚ã‚‹", key:"social"},
    {id:"Q10", text:"æœ€è¿‘ã€æ°—æ¥½ã«è©±ã›ã‚‹ç›¸æ‰‹ã¨ä¼šã£ã¦ã„ãªã„",        key:"social"},
    {id:"Q11", text:"æ„Ÿæƒ…ã‚’æŠ‘ãˆè¾¼ã¿ãŒã¡ã§ã€ã†ã¾ãè¡¨ç¾ã§ããªã„",      key:"emotion"},
    {id:"Q12", text:"æ³£ã„ãŸã‚Šæ€’ã£ãŸã‚Šã™ã‚‹ã®ã‚’æˆ‘æ…¢ã—ã¦ã—ã¾ã†",        key:"emotion"},
    {id:"Q13", text:"è€ƒãˆã”ã¨ãŒå¤šã™ãã¦é ­ãŒä¼‘ã¾ã‚‰ãªã„",            key:"mental"},
    {id:"Q14", text:"é›†ä¸­ã§ããšã€æ€è€ƒã®å¼•ãå‡ºã—ãŒæ•£ã‚‰ã‹ã£ã¦ã„ã‚‹æ„Ÿã˜",  key:"mental"}
  ];
  var LABELS = ["ãœã‚“ãœã‚“","ã‚ã¾ã‚Š","ã¨ãã©ã","ã‚ˆã","ã¨ã¦ã‚‚"];

  // ===== è¦ç´ å‚ç…§ =====
  var qWrap   = document.getElementById("qWrap");
  var prog    = document.getElementById("prog");
  var resEmpty= document.getElementById("resEmpty");
  var resArea = document.getElementById("resArea");
  var typeLine= document.getElementById("typeLine");
  var heroImg = document.getElementById("heroImg");
  var heroTitle= document.getElementById("heroTitle");
  var heroCopy = document.getElementById("heroCopy");
  var heroHint = document.getElementById("heroHint");
  var sumAvg  = document.getElementById("sumAvg");
  var sumPct  = document.getElementById("sumPct");
  var sumNote = document.getElementById("sumNote");
  var bars    = document.getElementById("bars");
  var resMemo = document.getElementById("resMemo");
  var careList= document.getElementById("careList");
  var shareRow= document.getElementById("shareRow");
  var shareTw = document.getElementById("shareTw");
  var shareLn = document.getElementById("shareLn");
  var shareIg = document.getElementById("shareIg");
  var back = document.getElementById("backLink");
  var hiSec   = document.getElementById("hiScoreSec");
var hiWrap  = document.getElementById("hiWrap");

  // ===== è¨­å•ç”Ÿæˆ =====
  function buildQuestions(){
    var html = "";
    ITEMS.forEach(function(q, i){
      html += '<fieldset class="q" id="fs-'+q.id+'">'+
        '<legend>'+String(i+1).padStart(2,"0")+'. '+q.text+'</legend>'+
        '<div class="scale" role="radiogroup" aria-label="'+q.text+'">';
      for(var v=0; v<=4; v++){
        html += '<div style="position:relative">'+
          '<input id="q'+q.id+'-'+v+'" type="radio" name="q'+q.id+'" value="'+v+'">'+
          '<label for="q'+q.id+'-'+v+'" title="'+LABELS[v]+'">'+LABELS[v]+'</label>'+
        '</div>';
      }
      html += '</div></fieldset>';
    });
    qWrap.innerHTML = html;

    qWrap.querySelectorAll('input[type="radio"]').forEach(function(r){
      r.addEventListener('change', function(){ updateProgress(); }, false);
    });
    updateProgress();
  }

  function updateProgress(){
    var total = ITEMS.length; // 14
    var answered = 0;
    ITEMS.forEach(function(q){
      if(qWrap.querySelector('#fs-'+q.id+' input[type="radio"]:checked')) answered++;
    });
    var pct = Math.round(100*answered/total);
    prog.style.width = pct + "%";
    var bar = prog.parentElement;
    if(bar){
      bar.setAttribute("aria-valuenow", answered);
      bar.setAttribute("aria-label", "å›ç­”é€²æ—ï¼š"+answered+" / "+total);
    }
  }

  // ===== è¨ˆç®— =====
  function heroPath(typeNo){ var id = String(typeNo).padStart(2,"0"); return IMG_BASE + "t" + id + ".webp"; }
  function calc(){
    // å›å
    var missing = [];
    var ans = {};
    ITEMS.forEach(function(q){
      var chk = qWrap.querySelector('#fs-'+q.id+' input[type="radio"]:checked');
      if(!chk){ missing.push(q.id); return; }
      ans[q.id] = parseInt(chk.value,10);
    });
    if(missing.length){
      alert("æœªå›ç­”ãŒã‚ã‚Šã¾ã™ã€‚å…¨14å•ã«ãŠç­”ãˆãã ã•ã„ã€‚");
      var fs = document.getElementById('fs-'+missing[0]);
      if(fs){ fs.scrollIntoView({behavior:"smooth", block:"center"}); fs.classList.add("need"); setTimeout(function(){ fs.classList.remove("need"); },1600); }
      return;
    }

    // å› å­é›†è¨ˆï¼ˆ0-4â†’ï¼…ï¼‰
    var fScore = {}, fPct = {};
    CODE_ORDER.forEach(function(code){ fScore[code]=0; fPct[code]=0; });
    var counts = {};
    CODE_ORDER.forEach(function(c){ counts[c]=0; });
    ITEMS.forEach(function(q){
      fScore[q.key] += ans[q.id];
      counts[q.key] += 1;
    });
    CODE_ORDER.forEach(function(c){
      var avg = fScore[c] / Math.max(1, counts[c]);
      fScore[c] = avg;
      fPct[c] = Math.round((avg/4)*100);
    });

    var totalAvg = CODE_ORDER.reduce(function(s,k){ return s + fScore[k]; },0) / CODE_ORDER.length;
    var totalPct = Math.round((totalAvg/4)*100);

    render({ fScore, fPct, totalAvg, totalPct });
  }

  // ä¸»å½¹ï¼†ç›¸æ£’ï¼ˆå·®ãŒ8ptæœªæº€ã§ç›¸æ£’ï¼‰
  function pickType(p){
    var order = CODE_ORDER.slice().sort(function(a,b){ return p[b]-p[a]; });
    var top = order[0], second = order[1];
    var main = TYPES.find(t=>t.code===top);
    var ally = (p[top]-p[second] < 8) ? TYPES.find(t=>t.code===second) : null;
    return {main, ally};
  }

  function drawBars(pct){
    var html = "";
    CODE_ORDER.forEach(function(code){
      var def = TYPES.find(t=>t.code===code), val = pct[code]||0;
      html += '<article class="bar" aria-label="'+def.name+'">'+
        '<div><strong>'+def.name+'</strong><span class="pill" style="margin-left:6px">'+String(val).padStart(2,"0")+'%</span></div>'+
        '<div class="row" aria-hidden="true"><span style="width:'+val+'%"></span></div>'+
      '</article>';
    });
    bars.innerHTML = html;
  }

  function render(o){
    var pair = pickType(o.fPct);
    var t = pair.main, ally = pair.ally;

    // ã‚¿ã‚¤ãƒˆãƒ«è¡Œ
    typeLine.textContent = 'ä»Šæ—¥ã®ä¸»å½¹ä¼‘æ¯ï¼š' + t.name + 'ï¼ˆ' + t.sweet + 'ï¼‰';

    // ç”»åƒãƒ»ãƒ†ã‚­ã‚¹ãƒˆ
    heroImg.src = heroPath(t.id);
    heroImg.alt = t.name + " ã®ã‚¤ãƒ¡ãƒ¼ã‚¸";
    heroTitle.textContent = t.sweet + "ï½œ" + t.name;
    heroCopy.textContent  = t.one;
    heroHint.textContent  = "ãƒ’ãƒ³ãƒˆï¼š" + t.hint;

    // ç·åˆ
    sumAvg.textContent = o.totalAvg.toFixed(2);
    sumPct.textContent = "= " + o.totalPct + "%";
    var topKey = CODE_ORDER.slice().sort((a,b)=>o.fPct[b]-o.fPct[a])[0];
    sumNote.textContent = "ä¸Šä½å› å­ï¼š"+(TYPES.find(x=>x.code===topKey)||{}).name;

    // ç›¸æ£’
    if(ally){
      document.getElementById("allyName").textContent = ally.name + "ï¼ˆ" + ally.sweet + "ï¼‰";
      document.getElementById("allyNote").textContent = "ä¸»å½¹ã¨ã®å·®ãŒå°ã•ã„ãŸã‚ç›¸æ£’ã¨ã—ã¦è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚";
    }else{
      document.getElementById("allyName").textContent = "â€”";
      document.getElementById("allyNote").textContent = "æ¡ä»¶ä¸€è‡´ã®ã¨ãè¡¨ç¤º";
    }

    // å› å­ãƒãƒ¼
    drawBars(o.fPct);
// åŸºæº–å€¤ã‚’è¶…ãˆãŸå› å­ã‚’ã¾ã¨ã‚è¡¨ç¤º
(function showHiScores(){
  if(!hiSec || !hiWrap) return;
  var hiList = CODE_ORDER.filter(function(c){ return (o.fPct[c] || 0) >= HI_THRESH; });

  if(!hiList.length){
    hiSec.style.display = "none";
    hiWrap.innerHTML = "";
    return;
  }

  hiSec.style.display = ""; // è¡¨ç¤º
  hiWrap.innerHTML = hiList.map(function(c){
    var def = TYPES.find(function(t){ return t.code===c; });
    var val = o.fPct[c] || 0;
    var line = ''
      + '<article class="bar" aria-label="'+def.name+'">'
      +   '<div><strong>'+def.name+'</strong>'
      +     '<span class="pill" style="margin-left:6px">'+String(val).padStart(2,"0")+'%</span>'
      +   '</div>'
      +   '<div class="row" aria-hidden="true"><span style="width:'+val+'%"></span></div>'
      +   '<div class="small" style="margin-top:6px">'
      +     def.sweet+'ï½œ'+def.one+'<br>ãƒ’ãƒ³ãƒˆï¼š'+def.hint
      +   '</div>'
      + '</article>';
    return line;
  }).join("");
})();
    // ã‚±ã‚¢
    if(careList){
      careList.innerHTML = t.care.map(s=>"<li>"+s+"</li>").join("");
    }

    // ç ”ç©¶ãƒ¡ãƒ¢ï¼ˆã«ã”ã—è¡¨ç¾ï¼‰
    var memo = [
      "çŸ­æ™‚é–“ã§ã‚‚â€œé©ã—ãŸä¼‘ã¿æ–¹â€ã‚’æŒŸã‚€ã¨ã€æ°—åˆ†ã‚„é›†ä¸­ãŒæŒã¡ç›´ã—ã‚„ã™ã„ã¨å ±å‘Šã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚",
      "äº”æ„Ÿã‚’è½ã¡ç€ã‘ã‚‹/å‘¼å¸ã‚’æ•´ãˆã‚‹ã¨ã€éå‰°ãªè¦šé†’ãŒä¸‹ãŒã‚Šã‚„ã™ã„ã¨è¨€ã‚ã‚Œã¾ã™ï¼ˆå€‹äººå·®ã‚ã‚Šï¼‰ã€‚",
      "ã‚„ã•ã—ã„äº¤æµã‚„â€œè¨€èªåŒ–ã™ã‚‹æ™‚é–“â€ã¯ã€è² æ‹…æ„Ÿã®è»½æ¸›ã¨è‡ªå·±åŠ¹åŠ›æ„Ÿã®å›å¾©ã«ã¤ãªãŒã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚"
    ];
    resMemo.innerHTML = memo.map(s=>"<li>"+s+"</li>").join("");

    // å…±æœ‰ï¼ˆX/LINE/Instagram/ã‚³ãƒ”ãƒ¼ï¼‰
    var shareText = 'ã€7ã¤ã®ä¼‘æ¯Ã—ã‚¹ã‚¤ãƒ¼ãƒ„è¨ºæ–­ã€ä¸»å½¹ï¼š'+t.name+'ï½œå› å­å¹³å‡ '+o.totalAvg.toFixed(2)+' / 4';
    var url = location.href.split('#')[0];
    function openBlank(u){ window.open(u, '_blank', 'noopener'); }
    shareTw.onclick = function(){ openBlank('https://twitter.com/intent/tweet?text='+encodeURIComponent(shareText)+'&url='+encodeURIComponent(url)); };
    shareLn.onclick = function(){ openBlank('https://line.me/R/msg/text/?'+encodeURIComponent(shareText+' '+url)); };
    shareIg.onclick = function(){
      var cap = shareText+' '+url;
      copyToClipboard(cap).then(function(){
        openBlank('https://www.instagram.com/');
        toast('ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸã€‚Instagramã§è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚');
      });
    };
    var shareCp = document.getElementById('shareCp');
    if(shareCp){
      shareCp.onclick = function(){
        copyToClipboard(shareText+' '+url).then(function(){ toast('ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ'); });
      };
    }
    shareRow.hidden = false;
    shareRow.style.display = 'flex';

    // è¡¨ç¤ºåˆ‡æ›¿
    resEmpty.style.display = "none";
    resArea.style.display  = "block";
    document.getElementById("result").scrollIntoView({behavior:"smooth", block:"start"});

    // æœ€å¾Œã«ã€ŒçµæœãŒå‡ºãŸã€åˆå›³â†’ ã¿ã‚“ãªã®Lv +1 / æ¸ˆãƒãƒ¼ã‚¯ ãªã©ï¼ˆå…±é€šã‚¹ãƒ‹ãƒšãƒƒãƒˆãŒæ‹¾ã†ï¼‰
    document.dispatchEvent(new Event('result:ready'));

    // last ä¿å­˜ï¼ˆä¸€è¦§ã§ã®å¾©å¸°ç”¨ï¼‰
    try{
      localStorage.setItem("specimens:last", JSON.stringify({ id: SLUG, title: TITLE, href: location.pathname }));
    }catch(e){}
  }

  // å…±æœ‰ãƒ˜ãƒ«ãƒ‘ãƒ¼
  function copyToClipboard(text){
    if(navigator.clipboard && navigator.clipboard.writeText){ return navigator.clipboard.writeText(text); }
    return new Promise(function(res){
      var ta=document.createElement('textarea'); ta.value=text;
      document.body.appendChild(ta); ta.select();
      try{ document.execCommand('copy'); }catch(_){}
      document.body.removeChild(ta); res();
    });
  }
  function toast(msg){
    var t=document.createElement('div');
    t.textContent=msg;
    t.style.position='fixed'; t.style.left='50%'; t.style.bottom='20px';
    t.style.transform='translateX(-50%)'; t.style.background='rgba(68,54,58,.92)';
    t.style.color='#fff'; t.style.padding='8px 12px'; t.style.borderRadius='10px';
    t.style.zIndex=9999; t.style.fontSize='13px';
    document.body.appendChild(t);
    setTimeout(function(){ t.remove(); },1500);
  }

  // ã‚¯ãƒªã‚¢
  function clearAnswers(){
    qWrap.querySelectorAll('input[type="radio"]').forEach(function(r){ r.checked=false; });
    updateProgress();
    resEmpty.style.display=""; resArea.style.display="none";
    var app=document.getElementById("app"); if(app){ app.scrollIntoView({behavior:"smooth", block:"start"}); }
  }

  // åˆæœŸåŒ–
  function init(){
    buildQuestions();
  }
  if(document.readyState === "loading"){ document.addEventListener("DOMContentLoaded", init); } else { init(); }
  document.getElementById("doScore").addEventListener("click", calc, false);
  document.getElementById("doScore2").addEventListener("click", calc, false);
  document.getElementById("clearAns").addEventListener("click", clearAnswers, false);
  if(back){
    back.addEventListener("click", function(){
      try{ localStorage.setItem("specimens:last", JSON.stringify({ id: SLUG, title: TITLE, href: location.pathname })); }catch(e){}
    }, false);
  }
})(); // IIFE
</script>

<!-- â–¼â–¼ ã“ã“ã‹ã‚‰ä¸‹ï¼šå„è¨ºæ–­ãƒšãƒ¼ã‚¸å…±é€šã‚¹ãƒ‹ãƒšãƒƒãƒˆï¼ˆå›ç­”ä¿å­˜ï¼‹ã‚ãªãŸ/ã¿ã‚“ãªã®Lvï¼‰ â–¼â–¼ -->
<script>
/* ============================================================
   è¨ºæ–­ãƒšãƒ¼ã‚¸å…±é€šã‚¹ãƒ‹ãƒšãƒƒãƒˆï¼ˆã‚³ãƒ”ãƒšç”¨ï¼‰
   1) å›ç­”ã®è‡ªå‹•ä¿å­˜ãƒ»è‡ªå‹•å¾©å…ƒï¼ˆå…¥åŠ›ä¸­ã‚‚é€æ¬¡ä¿å­˜ï¼‰
   2) çµæœè¡¨ç¤ºã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã€Œæ¸ˆã€ï¼‹ ã‚ãªãŸã®Lv +1
   3) ã¿ã‚“ãªã®ã“ã“ã‚Lvï¼ˆCountAPIï¼‰ã« +1ï¼ˆå¤±æ•—ã¯ç„¡è¦–ï¼‰
   ------------------------------------------------------------
   â˜…ç½®ãå ´æ‰€ï¼šå„è¨ºæ–­HTMLã® </body> ã®ç›´å‰
   â˜…ãƒšãƒ¼ã‚¸IDï¼š<body data-id="xxxxx"> ã‚’æ¨å¥¨ï¼ˆæœªè¨­å®šã§ã‚‚å‹•ä½œï¼‰
============================================================ */
(function(){
  'use strict';

  // å›ºå®šã‚­ãƒ¼ï¼ˆindex ã¨åˆã‚ã›ã‚‹ï¼‰
  var DONE_KEY   = 'specimens:open:byid';   // è¨ºæ–­ã”ã¨ã®ã€Œæ¸ˆã€ãƒãƒƒãƒ—
  var TOTAL_KEY  = 'specimens:open:total';  // ã‚ãªãŸã®ã“ã“ã‚Lvï¼ˆåˆè¨ˆï¼‰
  var GLOBAL_LAST= 'specimens:open:global:last'; // ã¿ã‚“ãªã®Lvã®å‰å›è¡¨ç¤ºã‚­ãƒ£ãƒƒã‚·ãƒ¥

  // ã“ã®ãƒšãƒ¼ã‚¸ã®ID
  var MY_ID = (document.body && document.body.getAttribute('data-id')) || 'unknown';

  // å›ç­”ä¿å­˜ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼ˆã“ã®è¨ºæ–­ã ã‘ã®ç®±ï¼‰
  var ANSWER_KEY = 'specimens:answers:' + MY_ID;

  // ã¿ã‚“ãªã®Lvï¼ˆCountAPIè¨­å®šï¼‰
  var COUNTAPI_NS  = 'haisuikounozarigani_shindan';
  var COUNTAPI_KEY = 'specimens_open_total';
  function countapiHit(){
    var url = 'https://api.countapi.xyz/hit/'+COUNTAPI_NS+'/'+COUNTAPI_KEY;
    if(navigator.sendBeacon){
      try{ navigator.sendBeacon(url); }catch(_){}
    }else{
      fetch(url, {mode:'cors', cache:'no-store', keepalive:true}).catch(function(){});
    }
  }

  // å›ç­”ã®ä¿å­˜/å¾©å…ƒ
  function loadState(){ try{ return JSON.parse(localStorage.getItem(ANSWER_KEY) || '{}'); }catch(_){ return {}; } }
  function saveState(obj){ try{ localStorage.setItem(ANSWER_KEY, JSON.stringify(obj)); }catch(_){ } }
  function saveField(el){
    if(!el || !el.name) return;
    var st = loadState();
    var nm = el.name;

    if(el.type === 'radio'){
      var chosen = (el.form || document).querySelector('input[type="radio"][name="'+nm+'"]:checked');
      st[nm] = {t:'r', v: chosen ? chosen.value : null};
    }else if(el.type === 'checkbox'){
      var all = (el.form || document).querySelectorAll('input[type="checkbox"][name="'+nm+'"]');
      var vals = []; all.forEach(function(c){ if(c.checked) vals.push(c.value || 'on'); });
      st[nm] = {t:'c', v: vals};
    }else if(el.tagName==='SELECT'){
      if(el.multiple){
        var arr=[]; [].slice.call(el.options).forEach(function(o){ if(o.selected) arr.push(o.value); });
        st[nm] = {t:'m', v: arr};
      }else{
        st[nm] = {t:'s', v: el.value};
      }
    }else{
      st[nm] = {t:'t', v: el.value};
    }
    saveState(st);
  }
  function restoreOnce(){
    var st = loadState();
    var names = Object.keys(st);
    if(!names.length) return false;

    names.forEach(function(nm){
      var info = st[nm]; if(!info) return;

      if(info.t==='r'){
        var r = document.querySelector('input[type="radio"][name="'+nm+'"][value="'+CSS.escape(String(info.v))+'"]');
        if(r){ r.checked = true; r.dispatchEvent(new Event('change',{bubbles:true})); }
      }else if(info.t==='c'){
        var all = document.querySelectorAll('input[type="checkbox"][name="'+nm+'"]');
        var set = new Set(info.v||[]); all.forEach(function(c){ c.checked = set.has(c.value || 'on'); });
      }else if(info.t==='m'){
        var sel = document.querySelector('select[name="'+nm+'"]');
        if(sel){ var setm = new Set(info.v||[]); [].slice.call(sel.options).forEach(function(o){ o.selected = setm.has(o.value); }); }
      }else if(info.t==='s'){
        var s = document.querySelector('select[name="'+nm+'"]'); if(s){ s.value = info.v; }
      }else{
        var t = document.querySelector('[name="'+nm+'"]'); if(t){ t.value = info.v==null? '' : String(info.v); }
      }
    });
    try{ document.dispatchEvent(new Event('change', {bubbles:true})); }catch(_){}
    return true;
  }
  document.addEventListener('change', function(e){
    var el = e.target;
    if(!(el instanceof HTMLElement)) return;
    if(el.matches('input[name], select[name], textarea[name]')) saveField(el);
  }, true);
  document.addEventListener('input', function(e){
    var el = e.target;
    if(!(el instanceof HTMLElement)) return;
    if(el.matches('input[type="text"][name], input:not([type])[name], textarea[name]')) saveField(el);
  }, true);

  (function restoreWhenReady(){
    var TRY_MAX=12, tries=0;
    function tick(){
      tries++;
      var hasAny = document.querySelector('input[name], select[name], textarea[name]');
      if(hasAny){ restoreOnce(); return; }
      if(tries<TRY_MAX){ setTimeout(tick, 300); }
    }
    if(document.readyState==='complete' || document.readyState==='interactive'){ tick(); }
    else document.addEventListener('DOMContentLoaded', tick);
  })();

  function clearAnswers(){ try{ localStorage.removeItem(ANSWER_KEY); }catch(_){} }
  document.addEventListener('click', function(e){
    var t = e.target;
    if(!(t instanceof HTMLElement)) return;
    if(t.id==='btnReset' || t.matches('[data-role="reset"]')) clearAnswers();
  }, true);

  // çµæœç¢ºå®šã§ã€Œæ¸ˆã€ï¼‹LvåŠ ç®—
  var marked = false;
  function markOnce(){
    if(marked) return; marked = true;
    try{
      var total = (+localStorage.getItem(TOTAL_KEY) || 0) + 1;
      localStorage.setItem(TOTAL_KEY, String(total));

      var map={}; try{ map = JSON.parse(localStorage.getItem(DONE_KEY) || '{}'); }catch(_){}
      map[MY_ID] = (map[MY_ID] || 0) + 1;
      localStorage.setItem(DONE_KEY, JSON.stringify(Object.assign({}, map, {_ts: Date.now()})));

      countapiHit();
      try{
        var last = (+localStorage.getItem(GLOBAL_LAST) || 0) + 1;
        localStorage.setItem(GLOBAL_LAST, String(last));
      }catch(_){}
    }catch(_){}
  }
  document.addEventListener('result:ready', markOnce);
  setTimeout(markOnce, 2000);
})();
</script>
<!-- â–²â–² å…±é€šã‚¹ãƒ‹ãƒšãƒƒãƒˆã“ã“ã¾ã§ â–²â–² -->
</body>
</html>