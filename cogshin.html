<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>èªçŸ¥ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨ºæ–­ï¼ˆç”»åƒãªã—ãƒ»ã‚µã‚¤ãƒˆå®Œçµï¼‰</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
:root{--brand:#b86b77;--bg:#fffaf6;--card:#fff;--muted:#666;--bar:#f5e8eb;--fill:#b86b77}
*{box-sizing:border-box}
body{font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Hiragino Kaku Gothic ProN","Noto Sans JP",sans-serif;background:var(--bg);color:#333;margin:0;padding:20px}
h1{text-align:center;color:var(--brand);margin:0 0 8px}
.lead{text-align:center;margin:0 0 16px;color:#777}
.wrap{max-width:980px;margin:0 auto}
.card{background:var(--card);border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,.06);padding:16px;margin:12px 0}
.sec-title{display:flex;gap:8px;align-items:center;margin:0 0 10px}
.badge{display:inline-block;background:#fde9ee;color:var(--brand);padding:4px 10px;border-radius:999px;font-size:12px}
.q{margin:12px 0}
.q p{margin:0 0 8px;font-weight:600}
.opt{display:block;background:#f4f4f4;border:1px solid transparent;border-radius:10px;padding:10px;margin:6px 0;cursor:pointer}
.opt input{margin-right:8px}
.opt.on{background:#fff6f8;border-color:#e6c6ce}
.row{display:flex;gap:10px;flex-wrap:wrap}
.btn{background:var(--brand);color:#fff;border:none;border-radius:10px;padding:10px 14px;font-size:16px;cursor:pointer}
.btn.ghost{background:#eee;color:#333}
.small{font-size:12px;color:#777}
.grid{display:grid;gap:8px}
.kbd{display:inline-block;border:1px solid #ddd;border-bottom-width:2px;border-radius:6px;padding:4px 8px;background:#fff}
.center{text-align:center}
.bar{height:12px;background:var(--bar);border-radius:999px;overflow:hidden}
.fill{height:100%;width:0;background:var(--fill);transition:width .5s ease}
.result-head{display:flex;justify-content:space-between;align-items:center;margin:0 0 10px}
.pill{background:#fdf1f3;color:#7b3f4a;border:1px solid #e3c5cc;border-radius:999px;padding:6px 10px}
.score-row{display:grid;grid-template-columns:130px 1fr 56px;gap:10px;align-items:center;margin:8px 0}
.note{font-size:13px;color:#555;background:#fff7e6;border-left:6px solid #ffbf66;border-radius:8px;padding:10px;margin-top:12px}
.links{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:10px}
@media (max-width:640px){
  .score-row{grid-template-columns:1fr}
}
</style>
</head>
<body>
<div class="wrap">
  <h1>ğŸ§  èªçŸ¥ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨ºæ–­ï¼ˆãƒŸãƒ‹ï¼‰</h1>
  <p class="lead">ç”»åƒãªã—ãƒ»ã‚µã‚¤ãƒˆå®Œçµã€‚5é ˜åŸŸï¼ˆæ¨ç†/è¨€èª/ç©ºé–“/ä½œå‹•è¨˜æ†¶/å‡¦ç†é€Ÿåº¦ï¼‰ã‚’ã‚µã‚¯ãƒƒã¨æ¨å®šã—ã¾ã™ã€‚</p>

  <!-- 1. ãƒ‘ã‚¿ãƒ¼ãƒ³æ¨ç† -->
  <section class="card" id="sec-pattern">
    <div class="sec-title"><span class="badge">1ï½œãƒ‘ã‚¿ãƒ¼ãƒ³æ¨ç†</span><strong>æ•°åˆ—ã‚„æ³•å‰‡æ€§ã‚’è¦‹æŠœã</strong></div>
    <div id="patternQs" class="grid"></div>
  </section>

  <!-- 2. è¨€èª -->
  <section class="card" id="sec-verbal">
    <div class="sec-title"><span class="badge">2ï½œè¨€èª</span><strong>èªå½™ãƒ»è«–ç†ãƒ»é¡æ¯”</strong></div>
    <div id="verbalQs" class="grid"></div>
  </section>

  <!-- 3. ç©ºé–“ï¼ˆçŸ¢å°å›è»¢ãƒ»å‘ãï¼‰ -->
  <section class="card" id="sec-spatial">
    <div class="sec-title"><span class="badge">3ï½œç©ºé–“</span><strong>å‘ã/å›è»¢ã®é ­å†…æ“ä½œï¼ˆçŸ¢å°ï¼‰</strong></div>
    <div id="spatialQs" class="grid"></div>
  </section>

  <!-- 4. ä½œå‹•è¨˜æ†¶ï¼ˆçŸ­æ™‚é–“ã®ä¿æŒã¨æ“ä½œï¼‰ -->
  <section class="card" id="sec-memory">
    <div class="sec-title"><span class="badge">4ï½œä½œå‹•è¨˜æ†¶</span><strong>çŸ­æ™‚é–“ã®ä¿æŒã¨ä¸¦ã¹æ›¿ãˆ</strong></div>
    <div class="q">
      <p>4-1. <strong>æ•°å­—ã®é †å”±</strong>ï¼ˆ3ç§’ãšã¤è¡¨ç¤º â†’ ãã®ã¾ã¾å…¥åŠ›ï¼‰</p>
      <div class="row">
        <button class="btn" type="button" id="memShowDigits">è¡¨ç¤ºé–‹å§‹</button>
        <div id="memDigitsNow" class="kbd" aria-live="polite">â€”â€”</div>
      </div>
      <div class="row" style="margin-top:8px">
        <input id="memDigitsAns" class="kbd" inputmode="numeric" placeholder="è¡¨ç¤ºé †ã«å…¥åŠ›" />
        <button class="btn ghost" type="button" id="memDigitsCheck">ãƒã‚§ãƒƒã‚¯</button>
        <span class="small" id="memDigitsMsg"></span>
      </div>
    </div>
    <div class="q">
      <p>4-2. <strong>æ–‡å­—ã®é€†å”±</strong>ï¼ˆä¸€åº¦ã ã‘è¡¨ç¤º â†’ é€†é †ã§å…¥åŠ›ï¼‰</p>
      <div class="row">
        <button class="btn" type="button" id="memShowLetters">è¡¨ç¤º</button>
        <div id="memLettersNow" class="kbd" aria-live="polite">â€”â€”</div>
      </div>
      <div class="row" style="margin-top:8px">
        <input id="memLettersAns" class="kbd" placeholder="é€†é †ã§å…¥åŠ›ï¼ˆä¾‹ ABC â†’ CBAï¼‰" />
        <button class="btn ghost" type="button" id="memLettersCheck">ãƒã‚§ãƒƒã‚¯</button>
        <span class="small" id="memLettersMsg"></span>
      </div>
    </div>
  </section>

  <!-- 5. å‡¦ç†é€Ÿåº¦ï¼ˆè¨˜å·æ¢ç´¢ï¼šåå¿œæ™‚é–“ã‚’æ¸¬å®šï¼‰ -->
  <section class="card" id="sec-speed">
    <div class="sec-title"><span class="badge">5ï½œå‡¦ç†é€Ÿåº¦</span><strong>ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒå«ã¾ã‚Œã‚‹ï¼Ÿï¼ˆYes/No åå¿œï¼‰</strong></div>
    <div class="q">
      <p>5-1. æ–‡å­—åˆ—ã« <span class="kbd" id="spdT1">??</span> ã¯ <strong>å«ã¾ã‚Œã‚‹ï¼Ÿ</strong></p>
      <div class="kbd" id="spdS1" style="display:inline-block;min-width:260px">ï¼ˆé–‹å§‹ã§è¡¨ç¤ºï¼‰</div>
      <div class="row" style="margin-top:8px">
        <button class="btn" type="button" id="spdStart1">é–‹å§‹</button>
        <button class="btn ghost" type="button" id="spdYes1" disabled>Yes</button>
        <button class="btn ghost" type="button" id="spdNo1"  disabled>No</button>
        <span class="small" id="spdMsg1"></span>
      </div>
    </div>
    <div class="q">
      <p>5-2. æ–‡å­—åˆ—ã« <span class="kbd" id="spdT2">??</span> ã¯ <strong>å«ã¾ã‚Œã‚‹ï¼Ÿ</strong></p>
      <div class="kbd" id="spdS2" style="display:inline-block;min-width:260px">ï¼ˆé–‹å§‹ã§è¡¨ç¤ºï¼‰</div>
      <div class="row" style="margin-top:8px">
        <button class="btn" type="button" id="spdStart2">é–‹å§‹</button>
        <button class="btn ghost" type="button" id="spdYes2" disabled>Yes</button>
        <button class="btn ghost" type="button" id="spdNo2"  disabled>No</button>
        <span class="small" id="spdMsg2"></span>
      </div>
    </div>
    <p class="small">â€» åå¿œãŒé€Ÿãæ­£ç¢ºãªã»ã©ã‚¹ã‚³ã‚¢ãŒä¸ŠãŒã‚Šã¾ã™ï¼ˆ300ã€œ3000msã§ã‚¹ã‚±ãƒ¼ãƒ«ï¼‰ã€‚</p>
  </section>

  <!-- å®Ÿè¡Œï¼†çµæœ -->
  <section class="card">
    <div class="row" style="justify-content:center">
      <button class="btn" id="calcBtn" type="button">é›†è¨ˆã™ã‚‹</button>
      <a class="btn ghost" href="/shindan/">è¨ºæ–­ä¸€è¦§ã¸æˆ»ã‚‹</a>
    </div>
  </section>

  <section id="result" class="card" style="display:none">
    <div class="result-head">
      <h2 style="margin:0;color:#7b3f4a">çµæœï½œèªçŸ¥ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«</h2>
      <span id="topType" class="pill">â€”</span>
    </div>
    <div id="scores"></div>
    <div class="note">ã“ã®è¨ºæ–­ã¯è‡ªå·±ç†è§£/å¨¯æ¥½å‘ã‘ã®ç°¡æ˜“æ¨å®šã§ã™ã€‚åŒ»ç™‚ãƒ»é¸æŠœç›®çš„ã§ã¯ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„ã€‚</div>
  </section>

</div>

<script>
/* ---------- 1) ãƒ‘ã‚¿ãƒ¼ãƒ³æ¨ç†ï¼ˆ3å•ï¼‰ ---------- */
const patternQs = [
  {q:"2, 4, 7, 11, ï¼Ÿ", opts:["15","16","17","18"], a:1}, // +2 +3 +4 +5 â†’ 16
  {q:"3, 6, 12, 24, ï¼Ÿ", opts:["36","48","54","60"], a:1}, // Ã—2 â†’ 48
  {q:"1, 1, 2, 3, 5, ï¼Ÿ", opts:["6","7","8","9"], a:2},    // Fibonacci â†’ 8
];

/* ---------- 2) è¨€èªï¼ˆ3å•ï¼‰ ---------- */
const verbalQs = [
  {q:"ã€Œè¿…é€Ÿã€ã«æœ€ã‚‚è¿‘ã„ã‚‚ã®", opts:["ãŠã ã‚„ã‹","ã™ã°ã‚„ã„","å …å®Ÿ","è©³ç´°"], a:1},
  {q:"ã€ŒæŠ½è±¡çš„ã€ã®åå¯¾èª",     opts:["è¤‡é›‘","å…·ä½“çš„","ç²¾å·§","ç‰¹æ®Š"], a:1},
  {q:"çŒ«ï¼šå­çŒ« ï¼ çŠ¬ï¼šï¼Ÿ",      opts:["å­çŠ¬","çŒŸçŠ¬","ç•ªçŠ¬","å­é¹¿"], a:0},
];

/* ---------- 3) ç©ºé–“ï¼ˆçŸ¢å°ã®å›è»¢/å‘ã 3å•ï¼‰ ---------- */
const spatialQs = [
  {q:"â†’ ã‚’90Â°åæ™‚è¨ˆå›ã‚Šã«å›ã™ã¨ï¼Ÿ", opts:["â†‘","â†“","â†","â†’"], a:0},
  {q:"â†‘ ã‚’180Â°å›è»¢ã™ã‚‹ã¨ï¼Ÿ",        opts:["â†‘","â†’","â†“","â†"], a:2},
  {q:"â†– ã‚’90Â°æ™‚è¨ˆå›ã‚Šã«å›ã™ã¨ï¼Ÿ",   opts:["â†™","â†—","â†˜","â†‘"], a:1},
];

/* ç”Ÿæˆï¼ˆå…±é€šï¼‰ */
function renderRadioBlock(containerId, list, namePrefix){
  const box = document.getElementById(containerId);
  list.forEach((it, i)=>{
    const wrap = document.createElement('div');
    wrap.className = 'q';
    const qname = `${namePrefix}${i}`;
    const opts = it.opts.map((txt, n)=>(
      `<label class="opt"><input type="radio" name="${qname}" value="${n}"> ${txt}</label>`
    )).join("");
    wrap.innerHTML = `<p>${i+1}. ${it.q}</p>${opts}`;
    box.appendChild(wrap);
  });
  // é¸æŠã®è¦‹ãŸç›®ãƒã‚¤ãƒ©ã‚¤ãƒˆ
  box.addEventListener('change', (e)=>{
    if(!e.target.name?.startsWith(namePrefix)) return;
    document.querySelectorAll(`input[name="${e.target.name}"]`).forEach(inp=>{
      inp.closest('.opt').classList.toggle('on', inp.checked);
    });
  });
}
renderRadioBlock('patternQs', patternQs, 'p');
renderRadioBlock('verbalQs',  verbalQs,  'v');
renderRadioBlock('spatialQs', spatialQs, 's');

/* ---------- 4) ä½œå‹•è¨˜æ†¶ ---------- */
const memDigitsSeq = (()=>{ // 5æ¡ã®ãƒ©ãƒ³ãƒ€ãƒ æ•°å­—ï¼ˆé‡è¤‡ã‚ã‚Šï¼‰
  return Array.from({length:5},()=>Math.floor(Math.random()*10)).join('');
})();
const memLettersSeq = (()=>{ // 4æ–‡å­—ãƒ©ãƒ³ãƒ€ãƒ ï¼ˆAï½Zï¼‰
  const A=65; return Array.from({length:4},()=>String.fromCharCode(A+Math.floor(Math.random()*26))).join('');
})();
const memDigitsNow = document.getElementById('memDigitsNow');
const memLettersNow= document.getElementById('memLettersNow');
const memDigitsMsg = document.getElementById('memDigitsMsg');
const memLettersMsg= document.getElementById('memLettersMsg');

document.getElementById('memShowDigits').onclick = async()=>{
  memDigitsMsg.textContent="";
  memDigitsNow.textContent="æº–å‚™â€¦";
  await wait(300);
  memDigitsNow.textContent = memDigitsSeq[0]; await wait(700);
  memDigitsNow.textContent = memDigitsSeq[1]; await wait(700);
  memDigitsNow.textContent = memDigitsSeq[2]; await wait(700);
  memDigitsNow.textContent = memDigitsSeq[3]; await wait(700);
  memDigitsNow.textContent = memDigitsSeq[4]; await wait(700);
  memDigitsNow.textContent="â€” éš ã—ã¾ã—ãŸ â€”";
};
document.getElementById('memDigitsCheck').onclick = ()=>{
  const ans = (document.getElementById('memDigitsAns').value||"").replace(/\s/g,'');
  const correct = memDigitsSeq;
  const hit = scorePositional(ans, correct);
  memDigitsMsg.textContent = `ä¸€è‡´ï¼š${hit}/${correct.length}`;
  memDigitsMsg.dataset.score = hit/correct.length; // 0..1
};

document.getElementById('memShowLetters').onclick = ()=>{
  memLettersMsg.textContent="";
  memLettersNow.textContent = memLettersSeq + "ï¼ˆ3ç§’å¾Œã«éš ã‚Œã¾ã™ï¼‰";
  setTimeout(()=>{memLettersNow.textContent="â€” éš ã—ã¾ã—ãŸ â€”"}, 3000);
};
document.getElementById('memLettersCheck').onclick = ()=>{
  const ans = (document.getElementById('memLettersAns').value||"").replace(/\s/g,'').toUpperCase();
  const correct = [...memLettersSeq].reverse().join('');
  const hit = scorePositional(ans, correct);
  memLettersMsg.textContent = `ä¸€è‡´ï¼š${hit}/${correct.length}`;
  memLettersMsg.dataset.score = hit/correct.length; // 0..1
};

function scorePositional(ans, correct){
  const L = Math.min(ans.length, correct.length);
  let c=0; for(let i=0;i<L;i++){ if(ans[i]===correct[i]) c++; }
  return c;
}
function wait(ms){ return new Promise(r=>setTimeout(r,ms)); }

/* ---------- 5) å‡¦ç†é€Ÿåº¦ï¼ˆ2ãƒˆãƒ©ã‚¤ã‚¢ãƒ«ï¼‰ ---------- */
function makeSearchTrial(){
  const letters = "ABCDEFGHJKLMNPQRSTUVWXYZ"; // è¦‹åˆ†ã‘ã‚„ã™ã„
  const target = randPair(letters);
  const present = Math.random()<0.5;
  let line = "";
  for(let i=0;i<26;i++){
     const p = Math.random();
     if(present && i===Math.floor(Math.random()*26)) line += target;
     else line += randPair(letters);
     line += " ";
  }
  if(!present){ // å¿µã®ãŸã‚ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’å«ã¾ãªã„ã‚ˆã†ã«
    line = line.replaceAll(target, "ZZ");
  }
  return {target, line: line.trim(), present};
}
function randPair(pool){
  const a = pool[Math.floor(Math.random()*pool.length)];
  const b = pool[Math.floor(Math.random()*pool.length)];
  return a+b;
}
const speed = {
  t1: makeSearchTrial(), t2: makeSearchTrial(),
  startTime1:0, startTime2:0, rt1:null, rt2:null, ok1:null, ok2:null
};
document.getElementById('spdT1').textContent = speed.t1.target;
document.getElementById('spdT2').textContent = speed.t2.target;

function setupSpeedTrial(idx){
  const T = speed[`t${idx}`];
  const sEl = document.getElementById(`spdS${idx}`);
  const yes = document.getElementById(`spdYes${idx}`);
  const no  = document.getElementById(`spdNo${idx}`);
  const msg = document.getElementById(`spdMsg${idx}`);
  document.getElementById(`spdStart${idx}`).onclick = ()=>{
    msg.textContent=""; sEl.textContent=T.line;
    yes.disabled = no.disabled = false;
    speed[`startTime${idx}`] = performance.now();
  };
  yes.onclick = ()=> finish(true);
  no.onclick  = ()=> finish(false);
  function finish(ans){
    if(yes.disabled) return;
    const rt = performance.now() - speed[`startTime${idx}`];
    const ok = (ans===T.present);
    speed[`rt${idx}`] = rt; speed[`ok${idx}`] = ok;
    yes.disabled = no.disabled = true;
    msg.textContent = `${ok?"æ­£è§£":"ä¸æ­£è§£"}ï½œ${Math.round(rt)}ms`;
  }
}
setupSpeedTrial(1);
setupSpeedTrial(2);

/* ---------- é›†è¨ˆ ---------- */
document.getElementById('calcBtn').onclick = ()=>{
  // 1) pattern/verbal/spatialï¼ˆæ­£ç­”ç‡ï¼‰
  const pctPattern = radioScore('p', patternQs);
  const pctVerbal  = radioScore('v', verbalQs);
  const pctSpatial = radioScore('s', spatialQs);

  // 2) memoryï¼ˆé †å”±ãƒ»é€†å”±ã®å¹³å‡ 0..1 â†’ 0..100ï¼‰
  const mem1 = parseFloat(document.getElementById('memDigitsMsg').dataset.score||"0");
  const mem2 = parseFloat(document.getElementById('memLettersMsg').dataset.score||"0");
  const pctMemory = Math.round(((mem1+mem2)/2)*100);

  // 3) speedï¼ˆæ­£ç¢ºã•Ã—é€Ÿåº¦ã§ã‚¹ã‚³ã‚¢åŒ–ï¼‰
  const pctSpeed = speedScore(speed.rt1, speed.ok1, speed.rt2, speed.ok2);

  const scores = {
    pattern:pctPattern, verbal:pctVerbal, spatial:pctSpatial,
    memory:pctMemory, speed:pctSpeed
  };
  showResults(scores);
};

function radioScore(prefix, list){
  let correct=0, answered=0;
  list.forEach((it,i)=>{
    const v = document.querySelector(`input[name="${prefix}${i}"]:checked`)?.value;
    if(v!==undefined){ answered++; if(parseInt(v,10)===it.a) correct++; }
  });
  if(answered<list.length){
    alert(`æœªå›ç­”ã®è¨­å•ãŒã‚ã‚Šã¾ã™ï¼ˆ${prefix==="p"?"ãƒ‘ã‚¿ãƒ¼ãƒ³":prefix==="v"?"è¨€èª":"ç©ºé–“"}ï¼‰ã€‚`);
    // é€”ä¸­ã§ã‚‚è¨ˆç®—ã¯ç¶™ç¶šã—ãªã„
    throw new Error("unanswered");
  }
  return Math.round(correct/list.length*100);
}
function speedScore(rt1,ok1,rt2,ok2){
  // æœªå®Ÿæ–½ãªã‚‰æ³¨æ„
  if(rt1==null || rt2==null){
    alert("å‡¦ç†é€Ÿåº¦ã®è©¦è¡ŒãŒæœªå®Ÿæ–½ã§ã™ï¼ˆé–‹å§‹â†’Yes/No ã¾ã§å®Ÿè¡Œã—ã¦ãã ã•ã„ï¼‰ã€‚");
    throw new Error("speed not done");
  }
  // 300ã€œ3000msã‚’0ã€œ100ã«ã‚¹ã‚±ãƒ¼ãƒ«ï¼ˆé…ã„ã»ã©ä½å¾—ç‚¹ï¼‰ã€‚èª¤ç­”ã¯ãã®è©¦è¡Œ0ç‚¹ã€‚
  const S = (rt,ok)=>{
    if(!ok) return 0;
    const min=300, max=3000, clamped=Math.min(Math.max(rt,min),max);
    return Math.round(100*(max-clamped)/(max-min));
  };
  return Math.round((S(rt1,ok1)+S(rt2,ok2))/2);
}

/* ---------- çµæœæç”» ---------- */
function showResults(scores){
  const labels = {
    pattern:"ãƒ‘ã‚¿ãƒ¼ãƒ³æ¨ç†", verbal:"è¨€èª", spatial:"ç©ºé–“",
    memory:"ä½œå‹•è¨˜æ†¶", speed:"å‡¦ç†é€Ÿåº¦"
  };
  const tips = {
    pattern:"æ³•å‰‡ç™ºè¦‹ãƒ»æŠ½è±¡åŒ–ãŒå¾—æ„ã€‚é“ç­‹ã®è¨€èªåŒ–ã‚’åŠ ãˆã‚‹ã¨é‰„å£ã«ã€‚",
    verbal:"èªå½™ãƒ»èª¬æ˜ãƒ»æ¯”å–©ç†è§£ãŒå¼·ã¿ã€‚è¦ç‚¹â†’çµè«–ã®é †ã§ã•ã‚‰ã«ä¼ã‚ã‚‹ã€‚",
    spatial:"å›è»¢ãƒ»å‘ããƒ»é…ç½®ã®æ•´ç†ãŒé€Ÿã„ã€‚ä¿¯ç°â†’éƒ¨åˆ†â†’å†ä¿¯ç°ã§ãƒŸã‚¹æ¸›ã€‚",
    memory:"ä¿æŒã—ãªãŒã‚‰ã®æ›´æ–°ãŒåŠ¹ãã€‚çŸ­ã„å¡Šã«åŒºåˆ‡ã‚‹ã¨ãƒãƒ†ã«ãã„ã€‚",
    speed:"åˆå‹•ã®é€Ÿã•ãŒæ­¦å™¨ã€‚æœ€å¾Œã«â€œ10ç§’åœæ­¢â†’ä¸€æ‹¬è¦‹ç›´ã—â€ã§ç²¾åº¦UPã€‚"
  };
  // ãƒˆãƒƒãƒ—é ˜åŸŸ
  const topKey = Object.entries(scores).sort((a,b)=>b[1]-a[1])[0][0];
  document.getElementById('topType').textContent = `æœ€ã‚‚é«˜ã„é ˜åŸŸï¼š${labels[topKey]}`;

  // ãƒãƒ¼
  const box = document.getElementById('scores');
  box.innerHTML = "";
  Object.keys(labels).forEach(k=>{
    const row = document.createElement('div');
    row.className = 'score-row';
    row.innerHTML = `
      <div><strong>${labels[k]}</strong></div>
      <div class="bar"><div class="fill" style="width:${scores[k]}%"></div></div>
      <div style="text-align:right">${scores[k]}%</div>
      <div class="small" style="grid-column:1 / -1">${tips[k]}</div>
    `;
    box.appendChild(row);
  });

  document.getElementById('result').style.display = 'block';
  window.scrollTo({top:document.body.scrollHeight,behavior:'smooth'});
}
</script>
</body>
</html>
