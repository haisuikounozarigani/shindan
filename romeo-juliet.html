<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<title>ãƒ­ãƒŸã‚ªã¨ã‚¸ãƒ¥ãƒªã‚¨ãƒƒãƒˆè¨ºæ–­ï½œ32å•ã§ã€Œç¦æ–­ã«è¸ã¿è¾¼ã‚€åŠ›ã€ã‚’æ¸¬ã‚‹</title>
<meta name="description" content="è¶Šå¢ƒè¡å‹•ãƒ»èƒŒå¾³ç‡ƒæ–™ãƒ»éš å¯†é‹ç”¨ãƒ»ä»£å„Ÿè¦šæ‚Ÿãƒ»å…ç½ªã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ»ç ´æ»…ãƒ­ãƒãƒ³ãƒ»ç‹‚ç†±åŸ·ç€ãƒ»ç†æ€§ãƒ–ãƒ¬ãƒ¼ã‚­ï¼ˆé€†è»¢ï¼‰ã‚’32å•ã§å¯è¦–åŒ–ã€‚å¨¯æ¥½ç”¨ã€‚">
<meta name="theme-color" content="#fff7fd">

<!-- OG -->
<meta property="og:type" content="website">
<meta property="og:title" content="ãƒ­ãƒŸã‚ªã¨ã‚¸ãƒ¥ãƒªã‚¨ãƒƒãƒˆè¨ºæ–­">
<meta property="og:description" content="ç¦æ–­ã«è¸ã¿è¾¼ã‚€åŠ›ã‚’32å•ã§æ¸¬ã‚‹ï¼ˆå¨¯æ¥½ç”¨ï¼‰ã€‚">
<meta property="og:url" content="https://haisuikounozarigani.github.io/shindan/romeo-juliet.html">
<meta property="og:image" content="https://haisuikounozarigani.github.io/shindan/assets/results/romeo-juliet/t00.webp">

<style>
:root{
  --bg:#fdf7ff;
  --paper:#fff;
  --ink:#201322;
  --muted:#6a5b70;
  --line:#ece3f5;
  --accent:#8c6bff;
  --accent2:#ff8fc7;
}
html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);
  font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Noto Sans JP","Hiragino Sans","Yu Gothic",Meiryo,sans-serif;
}
a{color:#5b2ea8;text-decoration:none}
.wrap{max-width:980px;margin:0 auto;padding:16px}
header.hd{
  background:linear-gradient(160deg,#fff7fd,#f3ecff);
  border-bottom:1px solid var(--line);
}
header.hd .wrap{padding:20px 16px 10px}
.ttl{
  font-weight:900;font-size:1.35rem;letter-spacing:.02em;
  display:flex;gap:10px;align-items:center;flex-wrap:wrap;
}
.sub{color:var(--muted);font-size:.95rem}

/* ãƒ©ãƒ³ã‚¯ãƒãƒƒã‚¸ï¼ˆãƒ˜ãƒƒãƒ€ï¼‰ */
.rank{
  display:inline-flex;align-items:center;gap:6px;
  padding:.2em .75em;border-radius:999px;
  background:#f3e9ff;color:#4b266e;font-weight:850;font-size:.85rem;
}

/* å›ºå®šé€²æ—ãƒãƒ¼ */
.progress-fixed{
  position:sticky;top:0;z-index:20;
  height:8px;background:var(--line)
}
.progress-bar{
  height:100%;border-radius:6px;
  background:linear-gradient(90deg,var(--accent),var(--accent2));
  transition:width .2s ease
}
[role="progressbar"]{width:100%}

/* ãƒ’ãƒ¼ãƒ­ãƒ¼ï¼ˆæ­£æ–¹å½¢å›ºå®šï¼‰ */
figure.hero{
  margin:12px 0;border:1px solid var(--line);
  border-radius:16px;overflow:hidden;background:#fff;
}
figure.hero img{
  display:block;width:100%;
  aspect-ratio:1/1;object-fit:cover;
}

/* å…±é€šã‚«ãƒ¼ãƒ‰ */
.paper{
  background:var(--paper);
  border:1px solid var(--line);
  border-radius:16px;
  padding:16px;
  margin:14px 0;
}

/* ãƒ—ãƒ­ãƒ­ãƒ¼ã‚° */
#prologue h2{margin-top:0;font-size:1.1rem}
#prologue p{margin:.45rem 0;color:var(--muted)}
#prologue .note{color:var(--muted);font-size:.9rem}
.start-btn{
  margin-top:12px;width:100%;
  padding:12px 16px;border-radius:999px;border:0;
  background:linear-gradient(135deg,var(--accent),var(--accent2));
  color:#1b0f1c;font-weight:900;letter-spacing:.03em;
  cursor:pointer;box-shadow:0 10px 20px rgba(140,107,255,.18);
  display:inline-flex;align-items:center;justify-content:center;gap:8px;
}
.start-btn span.emo{font-size:1.2rem}

/* è³ªå• */
.qhead{display:flex;justify-content:space-between;align-items:center;gap:8px}
.qnum{font-weight:900;color:#4c2b5f}
.qtag{
  font-size:.8rem;color:#7a6c86;
  padding:2px 8px;border-radius:999px;
  border:1px solid var(--line);
  background:#f9f3ff;
  display:inline-flex;align-items:center;gap:4px;
}
.qtext{margin:.65rem 0 1rem;font-weight:850}
.opts{display:grid;grid-template-columns:1fr;gap:8px}
.btn{
  display:flex;align-items:center;justify-content:space-between;gap:12px;
  padding:12px 14px;border:1px solid var(--line);
  border-radius:12px;background:#fff;cursor:pointer;transition:.12s;
}
.btn[aria-pressed="true"]{outline:2px solid var(--accent2);background:#fff4fa}
.btn:hover{transform:translateY(-1px)}
.btn-label{font-weight:850}
.opt-note{color:#8b7b93;font-size:.9rem;white-space:nowrap}
.ctrls{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap}
.ctrls button{
  padding:10px 14px;border-radius:10px;border:1px solid var(--line);
  background:#faf5ff;cursor:pointer;font-weight:800;
}
.ctrls button:disabled{opacity:.55;cursor:not-allowed}

/* çµæœ */
.result{display:none}
.flex{display:flex;gap:16px;flex-wrap:wrap}
.result .imgbox{flex:1 1 280px;min-width:260px}
.result .imgbox img{
  width:100%;aspect-ratio:1/1;object-fit:cover;
  border-radius:14px;border:1px solid var(--line);display:block;
}
.result .text{flex:2 1 360px;min-width:300px}
.badge-line{display:flex;flex-wrap:wrap;gap:6px;align-items:center;margin:.2rem 0 .55rem}
.badge-pill{
  display:inline-flex;align-items:center;gap:6px;
  padding:3px 10px;border-radius:999px;background:#fff1fb;font-size:.85rem;
  border:1px solid rgba(236,227,245,.9);
}
.result-title-main{margin:.1rem 0 0}
.result-title-sub{margin:.15rem 0 .8rem;font-size:.9rem;color:var(--muted)}
.result-comment{
  margin:.35rem 0 .9rem;
  padding:10px 12px;
  border-radius:14px;
  border:1px solid var(--line);
  background:linear-gradient(180deg,#fff,#fff6fb);
}
.result-comment p{margin:.25rem 0;color:#5a3a4f}
.result-comment .rc-ttl{font-weight:950;color:#3a2433}
.result-small{margin:.2rem 0 0;color:var(--muted);font-size:.88rem}

/* ä»Šæ—¥ã®ä¸€æ‰‹ */
.today-box{
  margin:.9rem 0 .2rem;
  padding:12px 12px 10px;
  border-radius:16px;
  border:1px solid rgba(140,107,255,.35);
  background:linear-gradient(135deg, rgba(140,107,255,.14), rgba(255,143,199,.12));
  box-shadow:0 10px 22px rgba(140,107,255,.12);
}
.today-head{
  display:inline-flex;align-items:center;gap:8px;
  font-weight:950;color:#2b1830;
  padding:2px 10px;border-radius:999px;
  background:rgba(255,255,255,.75);
  border:1px solid rgba(236,227,245,.9);
}
.today-text{margin:.55rem 0 0;font-weight:850;color:#2b1830}

/* å› å­ãƒãƒ¼ */
.bars{display:grid;grid-template-columns:1fr;gap:10px;margin-top:10px}
.bar{background:transparent;border-radius:10px;padding:4px 0 6px}
.bar .h{
  display:flex;justify-content:space-between;align-items:center;
  padding:2px 10px 4px;font-size:.9rem
}
.bar .h span:first-child{font-weight:850}
.bar .track{
  margin:0 10px 4px;height:10px;border-radius:999px;background:#f3e9ff;overflow:hidden;
  border:1px solid var(--line);
}
.bar .fill{
  height:100%;width:0%;
  background:linear-gradient(90deg,var(--accent),var(--accent2));
  border-radius:inherit;transition:width .25s ease-out;
}
.bar-desc{padding:0 10px 2px;font-size:.8rem;color:var(--muted)}

/* å‰å›å›ç­” */
.prev-list{list-style:none;padding-left:0;margin:.4rem 0 .2rem .9rem}
.prev-item{
  display:flex;gap:8px;align-items:flex-start;
  padding:6px 0;border-bottom:1px solid var(--line);
}
.prev-q{
  flex:1;min-width:0;
  display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;
  overflow:hidden;overflow-wrap:anywhere;
}
.prev-a{
  flex:0 0 auto;white-space:nowrap;
  border:1px solid var(--line);border-radius:999px;padding:2px 8px;
  font-size:.9rem;background:#faf5ff;
}

/* ã‚®ãƒ£ãƒ©ãƒªãƒ¼ */
.gallery{margin-top:2px;display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:10px;}
.gallery figure{
  margin:0;border:1px solid var(--line);border-radius:12px;background:#fff;
  padding:6px;text-align:center;font-size:.85rem;color:var(--muted);
  display:flex;flex-direction:column;gap:4px;
}
.gallery img{width:100%;aspect-ratio:1/1;object-fit:cover;border-radius:8px;display:block}

/* æŠ˜ã‚ŠãŸãŸã¿ */
.fold-card{
  margin:10px 0 8px;padding:8px 10px;border-radius:12px;
  border:1px solid var(--line);background:#fff;color:var(--muted);font-size:.9rem;
}
.fold-card summary{
  cursor:pointer;list-style:none;font-weight:850;
  display:flex;align-items:center;justify-content:space-between;
}
.fold-card[open]{background:#fdf7ff;box-shadow:0 3px 8px rgba(0,0,0,.03)}
.fold-card[open] summary{margin-bottom:6px}

/* ç ”ç©¶ãƒ¡ãƒ¢ï¼ˆã‚†ã‚‹ã‚ï¼‰ */
.meta-note{
  margin-top:8px;padding:8px 10px;border-radius:12px;
  border:1px solid var(--line);background:#fdf7ff;color:var(--muted);font-size:.9rem;
}
.meta-note summary{
  cursor:pointer;list-style:none;font-weight:850;
  display:flex;align-items:center;justify-content:space-between;
}
.meta-note[open]{background:#fff}
.meta-note ul{margin:.5rem 0 0 1.1rem;padding-left:0}
.meta-note ul li + li{margin-top:10px;padding-top:6px;border-top:1px dashed var(--line)}

/* ãƒ•ãƒƒã‚¿ */
.meta{color:#7a6c86;font-size:.92rem;clear:both;margin-top:.6rem}

/* æœ€åˆã‹ã‚‰ï¼†ä¸€è¦§ã¸ */
.back-row{display:flex;gap:10px;flex-wrap:wrap;margin:12px 0 6px;}
.back{
  flex:1 1 220px;
  display:inline-flex;align-items:center;justify-content:center;gap:8px;
  padding:12px 16px;border-radius:999px;
  border:1px solid var(--line);background:#fff;color:var(--ink);
  font-weight:900;letter-spacing:.02em;cursor:pointer;
  box-shadow:0 12px 24px rgba(140,107,255,.14);
  transition:transform .12s ease, box-shadow .12s ease, border-color .12s ease;
}
.back:hover{transform:translateY(-1px);box-shadow:0 16px 30px rgba(140,107,255,.18);border-color:#ead9f2}
.back:active{transform:translateY(0);box-shadow:0 10px 20px rgba(140,107,255,.14)}
.back:focus-visible{outline:3px solid rgba(182,156,255,.35);outline-offset:3px}
.back-primary{
  border:0;background:linear-gradient(135deg,var(--accent),var(--accent2));
  color:#1b0f1c;box-shadow:0 14px 28px rgba(140,107,255,.22);
}
.back-ghost{background:linear-gradient(180deg,#fff,#fff6fb)}
.back .chev{
  display:inline-grid;place-items:center;width:22px;height:22px;border-radius:999px;
  background:rgba(182,156,255,.18);color:rgba(32,19,34,.75);
  font-size:1.15rem;line-height:1;
}

/* ãƒˆãƒ¼ã‚¹ãƒˆ */
.mini-toast{
  position:fixed;left:50%;bottom:24px;
  transform:translateX(-50%) translateY(20px);
  opacity:0;background:#4c2b5f;color:#fff;
  padding:8px 12px;border-radius:999px;
  font-size:1.1rem;transition:.25s;z-index:40;
}
.mini-toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

/* å°ç”»é¢ */
@media (max-width:600px){
  header.hd .wrap{padding:16px 12px 8px}
  .paper{padding:14px 12px}
}
</style>
</head>

<body data-id="romeo-juliet">
<header class="hd" role="banner">
  <div class="wrap">
    <div class="ttl">
      <span aria-hidden="true">ğŸ</span>
      <span id="pageTitle">ãƒ­ãƒŸã‚ªã¨ã‚¸ãƒ¥ãƒªã‚¨ãƒƒãƒˆè¨ºæ–­</span>
      <span class="rank" aria-label="ç¾åœ¨ã®ãƒ©ãƒ³ã‚¯">
        <span aria-hidden="true">ğŸ§©</span><span>æœªåˆ¤å®š</span>
      </span>
    </div>
    <div class="sub" id="pageSub">
      ã€Œãƒ€ãƒ¡ã€ã®ç·šã‚’è¦‹ãŸç¬é–“ã€ãªãœã‹å¿ƒãŒè¿‘ã¥ãã€‚ãã†ã„ã†ç¦æ–­ã®æ¨é€²åŠ›ã‚’32å•ã§å¯è¦–åŒ–ã—ã¾ã™ï¼ˆå¨¯æ¥½ç”¨ï¼‰ã€‚
    </div>
  </div>
</header>

<!-- å›ºå®šé€²æ—ãƒãƒ¼ -->
<div class="progress-fixed" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
  <div class="progress-bar" style="width:0%"></div>
</div>

<main class="wrap" id="app" role="main" aria-live="polite">

  <!-- ãƒ’ãƒ¼ãƒ­ãƒ¼ï¼ˆt00.webpï¼‰ -->
  <figure class="hero">
    <img id="heroImg" src="/shindan/assets/results/romeo-juliet/t00.webp" alt="ç¦æ–­ã®æœå®Ÿã‚’æŒã¤ç”·å¥³" loading="lazy">
  </figure>

<!-- ãƒ—ãƒ­ãƒ­ãƒ¼ã‚° -->
<section id="prologue" class="paper" aria-label="ãƒ—ãƒ­ãƒ­ãƒ¼ã‚°">
  <h2>ãƒ—ãƒ­ãƒ­ãƒ¼ã‚°ï¼šä½•ã‚‚ã—ã¦ãªã„ã€‚ã ã‘ã©å¤œã¯ã€è¨€ã„è¨³ã‚’å¢—ã‚„ã™</h2>

  <p>ä½•ã‚‚ã—ã¦ãªã„ã€‚</p>
  <p>æœ¬å½“ã«ä½•ã‚‚ã—ã¦ãªã„ã€‚</p>
  <p>ãŸã ã€åå‰ã‚’å‘¼ã°ã‚ŒãŸã ã‘ã§ã€‚</p>
  <p>ä¸–ç•Œã®è‰²ãŒä¸€æ®µã€é™ã‹ã«å¡—ã‚Šæ›¿ã‚ã£ãŸã ã‘ã§ã€‚</p>

  <p>ç¦æ–­ã¯æ´¾æ‰‹ãªæ‚ªã˜ã‚ƒãªã„ã€‚</p>
  <p>ã ã„ãŸã„ã€è¦ªåˆ‡ã¿ãŸã„ãªé¡”ã§å§‹ã¾ã‚‹ã€‚</p>
  <p>ä¸€ã¤ç›®ã¯è¦ªåˆ‡ã€‚</p>
  <p>äºŒã¤ç›®ã¯å¿ƒé…ã€‚</p>
  <p>ä¸‰ã¤ç›®ã§ã€ä¸–ç•ŒãŒäºŒé‡ã«ãªã‚‹ã€‚</p>
  <p>å®ˆã‚ŠãŸã„ã‚‚ã®ã¨ã€è§¦ã‚ŒãŸã„ã‚‚ã®ãŒã€åŒã˜æ‰‹ã®ã²ã‚‰ã«ä¹—ã£ã¦ã—ã¾ã†ã€‚</p>

  <p>å¤œã¯ã€è¨¼æ‹ ã‚’è–„ãã—ã¦ãã‚Œã‚‹ã€‚</p>
  <p>è¡—ç¯ã®ä¸‹ãªã‚‰ã€ç›®ãŒåˆã†ã ã‘ã§ã€Œå¶ç„¶ã€ã«ãªã‚‹ã€‚</p>
  <p>çµ‚é›»ã®æ™‚é–“ãªã‚‰ã€ä¼šã„ãŸã„ç†ç”±ãŒã€Œç”¨äº‹ã€ã«åŒ–ã‘ã‚‹ã€‚</p>
  <p>é€šçŸ¥ãŒé³´ã‚‹ã ã‘ã§ã€ã€Œã¾ã ã€ã®è¨€ã„è¨³ãŒå¢—ãˆã¦ã„ãã€‚</p>

  <p>ãªãœã‚ãªãŸã¯ãƒ­ãƒŸã‚ªãªã®â€¦</p>

  <p class="note">â€»æœ¬ãƒšãƒ¼ã‚¸ã¯å¨¯æ¥½ï¼‹è‡ªå·±ç†è§£ã®è£œåŠ©ã‚’ç›®çš„ã¨ã—ãŸç°¡æ˜“ãƒ†ã‚¹ãƒˆã§ã™ã€‚ã—ã‚“ã©ã•ãŒç¶šãå ´åˆã¯å°‚é–€æ©Ÿé–¢ã¸ã”ç›¸è«‡ãã ã•ã„ã€‚</p>

  <button type="button" id="startBtn" class="start-btn" aria-label="è¨ºæ–­ã‚’å§‹ã‚ã‚‹">
    <span class="emo">â¤ï¸â€ğŸ”¥</span><span>æ—æªã‚’é£Ÿã¹ã‚‹</span>
  </button>
</section>

  <!-- è³ªå•ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆåˆæœŸã¯éè¡¨ç¤ºï¼‰ -->
  <section id="quiz" class="paper" aria-label="è³ªå•ã‚»ã‚¯ã‚·ãƒ§ãƒ³" style="display:none">
    <div class="qhead">
      <div class="qnum" id="qnum">Q1/32</div>
      <div class="qtag" id="qtag"><span aria-hidden="true">ğŸ”</span><span>åˆ¤å®šä¸­</span></div>
    </div>
    <div class="qtext" id="qtext">â€¦</div>
    <div class="opts" id="opts" role="group" aria-label="å›ç­”ã‚’é¸æŠ"></div>

    <div class="ctrls">
      <button type="button" id="prevBtn" aria-label="å‰ã®è¨­å•ã¸æˆ»ã‚‹">ã‚‚ã©ã‚‹</button>
    </div>
  </section>

  <!-- çµæœã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
  <section id="result" class="paper result" aria-label="çµæœã‚»ã‚¯ã‚·ãƒ§ãƒ³">
    <h2 style="margin-top:0">çµæœ</h2>

    <div class="flex">
      <div class="imgbox">
        <img id="resultImg" src="" alt="" loading="lazy">
      </div>
      <div class="text">
        <div class="badge-line">
          <span class="badge-pill" id="gradeBadge"><span aria-hidden="true">ğŸ§©</span><span>æœªåˆ¤å®š</span></span>
          <span class="badge-pill" id="scoreBadge">ç¦æ–­åº¦ â€”ç‚¹</span>
          <span class="badge-pill" id="brakeBadge">ç†æ€§ â€”%</span>
        </div>

        <h3 class="result-title-main" id="resultTitle">â€”</h3>
        <p class="result-title-sub" id="resultSubtitle">â€”</p>

        <div class="result-comment" id="resultComment" aria-label="çµæœã‚³ãƒ¡ãƒ³ãƒˆ">
          <p class="rc-ttl">â€”</p>
          <p>â€”</p>
        </div>

        <div class="today-box" aria-label="ä»Šæ—¥ã®ä¸€æ‰‹">
          <div class="today-head"><span aria-hidden="true">ğŸ—ï¸</span><span>ä»Šæ—¥ã®ä¸€æ‰‹</span></div>
          <div class="today-text" id="todayText">â€”</div>
        </div>

        <p class="result-small" id="resultSmall"></p>

        <!-- å› å­ãƒãƒ¼ -->
        <div class="bars" id="bars" aria-label="å› å­ãƒãƒ¼"></div>
      </div>
    </div>

    <!-- å‰å›ã®å›ç­”ï¼ˆä¸€è¦§ï¼‰ -->
    <details id="prevBlock" class="fold-card">
      <summary>ğŸ“ å‰å›ã®å›ç­”ï¼ˆä¸€è¦§ï¼‰<span aria-hidden="true">â–¾</span></summary>
      <ul id="prevList" class="prev-list"></ul>
    </details>

    <!-- ã‚®ãƒ£ãƒ©ãƒªãƒ¼ï¼ˆt01ã€œt05ï¼‰ -->
    <details id="galleryBlock" class="fold-card">
      <summary>ğŸ–¼ ãƒ©ãƒ³ã‚¯ã®ã‚®ãƒ£ãƒ©ãƒªãƒ¼<span aria-hidden="true">â–¾</span></summary>
      <div class="gallery" id="gallery"></div>
    </details>

    <!-- ç ”ç©¶ãƒ¡ãƒ¢ï¼ˆã‚†ã‚‹ã‚ï¼‰ -->
    <details class="meta-note" id="researchNotes">
      <summary>ğŸ“š ç ”ç©¶ãƒ¡ãƒ¢ï¼ˆã‚†ã‚‹ã‚ï¼‰<span aria-hidden="true">â–¾</span></summary>
      <ul id="researchList">
        <li><strong>ã–ã£ãã‚Š</strong>ï¼šä¸ç¢ºå®Ÿæ€§ã‚„ã€Œã‚‚ã†å°‘ã—ã§å±Šãæ„Ÿã€ã¯ã€å ±é…¬ç³»ã‚’åˆºæ¿€ã—ã‚„ã™ã„ã¨è¨€ã‚ã‚ŒãŒã¡ã€‚</li>
        <li><strong>æ³¨æ„</strong>ï¼šã“ã‚Œã¯å¨¯æ¥½ã€‚ç¾å®Ÿã®æ„æ€æ±ºå®šã¯ã€ç¾å®Ÿã®æå¾—ã¨å®‰å…¨ãŒå„ªå…ˆã€‚</li>
      </ul>
    </details>

    <p class="meta">â€»æœ¬ãƒšãƒ¼ã‚¸ã¯å¨¯æ¥½ï¼‹è‡ªå·±ç†è§£ã®è£œåŠ©ã‚’ç›®çš„ã¨ã—ãŸç°¡æ˜“ãƒ†ã‚¹ãƒˆã§ã™ã€‚ã—ã‚“ã©ã•ãŒç¶šãå ´åˆã¯å°‚é–€æ©Ÿé–¢ã¸ã”ç›¸è«‡ãã ã•ã„ã€‚</p>

    <div class="back-row" aria-label="æ“ä½œãƒ¡ãƒ‹ãƒ¥ãƒ¼">
      <button type="button" class="back back-primary" id="restartBtn" aria-label="æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™">
        <span aria-hidden="true">ğŸ”</span><span>æœ€åˆã‹ã‚‰</span>
      </button>

      <a class="back back-ghost" href="/shindan/" aria-label="è¨ºæ–­ä¸€è¦§ã«æˆ»ã‚‹">
        <span aria-hidden="true">ğŸ§ª</span><span>è¨ºæ–­ä¸€è¦§ã¸</span><span class="chev" aria-hidden="true">â€º</span>
      </a>
    </div>
  </section>
</main>

<!-- âœ…ã ã‘ã®ãƒˆãƒ¼ã‚¹ãƒˆ -->
<div class="mini-toast" id="toast" role="status" aria-live="polite">âœ…</div>

<script>
/* ===== å›ºå®šé€²æ—ãƒãƒ¼ ===== */
function updateProgress(p){
  var bar = document.querySelector('.progress-bar');
  var wrap = document.querySelector('.progress-fixed');
  var val = Math.max(0,Math.min(100,p));
  if(bar) bar.style.width = val + '%';
  if(wrap) wrap.setAttribute('aria-valuenow', String(val));
}

/* ===== åŸºæœ¬è¨­å®š ===== */
const SLUG = 'romeo-juliet';
const IMG_BASE = `/shindan/assets/results/${SLUG}/`;

/* ä¿å­˜ã‚­ãƒ¼ï¼ˆè¡çªå›é¿ï¼‰ */
const LS_ANS     = `shindan:${SLUG}:answers`;
const LS_IDX     = `shindan:${SLUG}:index`;
const LS_LASTANS = `shindan:${SLUG}:lastAnswers`;

/* å›ç­”ãƒ©ãƒ™ãƒ«ï¼ˆæ•°å­—ç¦æ­¢ï¼‰ */
const LABELS = ['ãœã‚“ãœã‚“','ã‚ã¾ã‚Š','ã©ã¡ã‚‰ã¨ã‚‚','ã‚ã‚Šã¨','ã¨ã¦ã‚‚'];
function descFor(i){
  return ['ã»ã¼ãªã„','ã™ã“ã—','åŠã€…','ã‚ˆãã‚ã‚‹','ã‚ã£ã¡ã‚ƒã‚ã‚‹'][i] || '';
}

/* æ¼”å‡ºãƒ†ãƒ³ãƒï¼ˆå¼·åˆ¶ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãŒæ—©ã™ãã‚‹å•é¡Œã®ä¿é™ºï¼‰ */
const NEXT_Q_DELAY_MS = 220;          // 1å•é€²ã‚€å¾…ã¡
const RESULT_SCROLL_DELAY_MS = 1100;  // æœ€çµ‚å›ç­”å¾Œã€çµæœã¸ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã™ã‚‹å¾…ã¡ï¼ˆå›³æŸ„ã®ä½™éŸ»æ ï¼‰

/* =========================================================
   8å› å­ï¼ˆç¦æ–­ã¸è¡Œãæ¨é€²åŠ›ï¼‰
========================================================= */
const FACTS = ['CROSS','GUILT','STEALTH','COST','STORY','ROMANCE','OBSESS','BRAKE'];
const FACT_LABEL = {
  CROSS:'è¶Šå¢ƒè¡å‹•',
  GUILT:'èƒŒå¾³ç‡ƒæ–™',
  STEALTH:'éš å¯†é‹ç”¨',
  COST:'ä»£å„Ÿè¦šæ‚Ÿ',
  STORY:'å…ç½ªã‚¹ãƒˆãƒ¼ãƒªãƒ¼',
  ROMANCE:'ç ´æ»…ãƒ­ãƒãƒ³',
  OBSESS:'ç‹‚ç†±åŸ·ç€',
  BRAKE:'ç†æ€§ãƒ–ãƒ¬ãƒ¼ã‚­'
};
const FACT_DESC = {
  CROSS:'ã€Œãƒ€ãƒ¡ã€ã‚’è¦‹ãŸç¬é–“ã«è¸ã¿ãŸããªã‚‹åŠ›',
  GUILT:'ç½ªæ‚ªæ„Ÿã‚’ç†±ã«å¤‰ãˆã‚‹å‚¾å‘',
  STEALTH:'ãƒãƒ¬ãªã„æ®µå–ã‚Šã¨åˆ‡ã‚Šæ›¿ãˆã®ã†ã¾ã•',
  COST:'å¤±ã†å¯èƒ½æ€§ã‚’ç†è§£ã—ã¦ã‚‚é€²ã‚€èƒ†åŠ›',
  STORY:'æ­£å½“åŒ–ã®ç‰©èªã‚’æˆç«‹ã•ã›ã‚‹ã†ã¾ã•',
  ROMANCE:'å±ã†ã•ã‚„çµ‚ã‚ã‚Šã«ç¾ã‚’æ„Ÿã˜ã‚‹å‚¾å‘',
  OBSESS:'ç›¸æ‰‹ãŒä¸­å¿ƒã«ãªã‚‹å›ºå®šåŠ›',
  BRAKE:'å€«ç†ãƒ»ç«‹å ´ãƒ»æœªæ¥ã§è¸ã¿ã¨ã©ã¾ã‚‹åŠ›ï¼ˆé«˜ã„ã»ã©æ­¢ã¾ã‚‹ï¼‰'
};

/* è¨­å•ï¼ˆ32å•ï½œ8å› å­Ã—4ï¼‰
   answers ã¯ 0..4ï¼ˆLABELSã®indexï¼‰
   reverse:true ã¯ v=4-v
*/
const QUESTIONS = [
  /* =========================
     32å•ï¼ˆ8å› å­Ã—4ï¼‰
     reverse:true ã¯é€†è»¢ï¼ˆåŒæ„ã™ã‚‹ã¨ç¦æ–­åº¦ã¯ä¸‹ãŒã‚‹ï¼‰
  ========================= */

  /* 1) è¶Šå¢ƒè¡å‹• CROSS */
  {t:'ã€Œä»•äº‹ã®é€£çµ¡ã¯æ¥­å‹™æ™‚é–“å†…ã§ã€ã¨è¨€ã‚ã‚ŒãŸã®ã«ã€å¤œã«ç§ç”¨ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚ŠãŸããªã‚‹ã€‚', key:'CROSS'},
  {t:'æ—¢ã«æ‹äºº/é…å¶è€…ãŒã„ã‚‹ç›¸æ‰‹ã§ã‚‚ã€å¥½æ„ã‚’åŒ‚ã‚ã›ã‚‹ã‚„ã‚Šå–ã‚Šã‚’ã—ãŸããªã‚‹ã€‚', key:'CROSS'},
  {t:'ç›¸æ‰‹ãŒã€Œè·é›¢ã‚’ç½®ã“ã†ã€ã¨è¨€ã£ã¦ããŸã‚‰ã€ã“ã¡ã‚‰ã‚‚ç´ ç›´ã«å¼•ã‘ã‚‹ã€‚', key:'CROSS', reverse:true},
  {t:'ã€Œãã‚Œã¯ç«‹å ´çš„ã«ã¾ãšã„ã€ã¨è¨€ã‚ã‚Œã‚‹ã»ã©ã€ä¼šã†å£å®Ÿã‚’è€ƒãˆã¦ã—ã¾ã†ã€‚', key:'CROSS'},

  /* 2) èƒŒå¾³ç‡ƒæ–™ GUILT */
  {t:'ã€Œãƒãƒ¬ãŸã‚‰ã¾ãšã„ã€ã¨æ€ã†ã¨ã€æ°—æŒã¡ãŒå¼·ããªã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚', key:'GUILT'},
  {t:'ç½ªæ‚ªæ„ŸãŒå‡ºãŸæ™‚ç‚¹ã§ã€æ°—æŒã¡ãŒå†·ã‚ã‚„ã™ã„ã€‚', key:'GUILT', reverse:true},
  {t:'éš ã—ã¦ã„ã‚‹ã‚„ã‚Šå–ã‚Šï¼ˆé€šè©±/DM/ä¼šã†ç´„æŸï¼‰ãŒã‚ã‚‹ã¨ã€ã‚€ã—ã‚æ°—åˆ†ãŒä¸ŠãŒã‚‹ã€‚', key:'GUILT'},
  {t:'ç›¸æ‰‹ãŒå›°ã‚‹ã¨åˆ†ã‹ã£ã¦ã„ã¦ã‚‚ã€æ°—æŒã¡ãŒæ­¢ã¾ã‚‰ãªã„ç¬é–“ãŒã‚ã‚‹ã€‚', key:'GUILT'},

  /* 3) éš å¯†é‹ç”¨ STEALTH */
  {t:'èª°ã«è¦‹ã‚‰ã‚ŒãŸã‚‰ã¾ãšã„ã‹ã‚’æƒ³å®šã—ã¦ã€ä¼šã†å ´æ‰€ã‚„æ™‚é–“ã‚’é¸ã¹ã‚‹ã€‚', key:'STEALTH'},
  {t:'é€šçŸ¥è¨­å®šãƒ»å±¥æ­´ãƒ»å†™çœŸãªã©ã€ãƒãƒ¬è¦ç´ ã®ç®¡ç†ãŒã‚ã‚Šã¨å¾—æ„ã ã€‚', key:'STEALTH'},
  {t:'æ®µå–ã‚Šã‚„éš ã—æ–¹ã‚’è€ƒãˆã‚‹ã®ãŒè‹¦æ‰‹ã§ã€ã™ããƒœãƒ­ãŒå‡ºã‚‹ã€‚', key:'STEALTH', reverse:true},
  {t:'ã€Œå¶ç„¶ä¼šã£ãŸã€ã€Œç›¸è«‡ã ã£ãŸã€ãªã©ã€èª¬æ˜ã®ç­‹ã‚’ç”¨æ„ã§ãã‚‹ã€‚', key:'STEALTH'},

  /* 4) ä»£å„Ÿè¦šæ‚Ÿ COST */
  {t:'å™‚ã§è·å ´/å­¦æ ¡ã«å±…ã¥ã‚‰ããªã‚‹å¯èƒ½æ€§ãŒã‚ã£ã¦ã‚‚ã€é€²ã‚€é¸æŠè‚¢ã¯æ®‹ã‚‹ã€‚', key:'COST'},
  {t:'é–¢ä¿‚ãŒå£Šã‚ŒãŸã‚Šä¿¡ç”¨ã‚’å¤±ã†ãªã‚‰ã€æ°—æŒã¡ãŒã‚ã£ã¦ã‚‚æ­¢ã¾ã‚Œã‚‹ã€‚', key:'COST', reverse:true},
  {t:'å®¶æ—ãƒ»å‹äººãƒ»å‘¨å›²ã‚’å·»ãè¾¼ã‚€ãƒªã‚¹ã‚¯ãŒã‚ã£ã¦ã‚‚ã€è¸ã¿å‡ºã™è¦šæ‚ŸãŒå‡ºã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚', key:'COST'},
  {t:'è‡ªåˆ†ãŒæ‚ªè€…ã«ãªã‚‹å±•é–‹ã§ã‚‚ã€å—ã‘å…¥ã‚Œã¦ã§ã‚‚ç¶šã‘ãŸã„ã¨æ€ã†ã“ã¨ãŒã‚ã‚‹ã€‚', key:'COST'},

  /* 5) å…ç½ªã‚¹ãƒˆãƒ¼ãƒªãƒ¼ STORY */
  {t:'ã€Œã“ã‚Œã¯æ‹ã˜ã‚ƒãªã„ã€ã€Œç›¸è«‡ã ã‹ã‚‰ã€ã§ã€è‡ªåˆ†ã®ä¸­ã§æ­£å½“åŒ–ã§ãã‚‹ã€‚', key:'STORY'},
  {t:'ã€Œä»Šã ã‘ã€ã€Œä¸€å›ã ã‘ã€ã§ã€è¶Šãˆã¦ã„ã„ç†ç”±ã‚’ä½œã‚Šã‚„ã™ã„ã€‚', key:'STORY'},
  {t:'æ­£å½“åŒ–ã‚’è€ƒãˆã‚‹ã»ã©è‡ªå·±å«Œæ‚ªãŒå¢—ãˆã¦ã€çµå±€å¼•ã„ã¦ã—ã¾ã†ã€‚', key:'STORY', reverse:true},
  {t:'ç›¸æ‰‹ãŒã€Œé‹å‘½ã ã‚ˆã­ã€ã¨è¨€ã†ã¨ã€ãã®è¨€è‘‰ã«ä¹—ã‚Šã‚„ã™ã„ã€‚', key:'STORY'},

  /* 6) ç ´æ»…ãƒ­ãƒãƒ³ ROMANCE */
  {t:'å±ãªã„çŠ¶æ³ï¼ˆç§˜å¯†ãƒ»éšœå®³ãŒå¤šã„ï¼‰ã»ã©ã€ç‡ƒãˆã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚', key:'ROMANCE'},
  {t:'å®‰å®šã—ãŸé–¢ä¿‚ã‚ˆã‚Šã€æ³¢ãŒã‚ã‚‹é–¢ä¿‚ã®æ–¹ãŒã€Œç”Ÿãã¦ã‚‹æ„Ÿã€ãŒå‡ºã‚‹ã€‚', key:'ROMANCE'},
  {t:'ãƒ‰ãƒ©ãƒã£ã½ã„å±•é–‹ã¯è‹¦æ‰‹ã§ã€ç¾å®Ÿçš„ã«æãªã‚‰é¿ã‘ãŸã„ã€‚', key:'ROMANCE', reverse:true},
  {t:'ã€Œçµ‚ã‚ã‚ŠãŒè¦‹ãˆã¦ã‚‹é–¢ä¿‚ã€ã§ã‚‚ã€ç¶šã‘ãŸã„æ°—æŒã¡ãŒå‡ºã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚', key:'ROMANCE'},

  /* 7) ç‹‚ç†±åŸ·ç€ OBSESS */
  {t:'ç›¸æ‰‹ã®è¿”ä¿¡ã‚„æ—¢èª­ã®é€Ÿã•ã§ã€æ°—åˆ†ãŒã‹ãªã‚Šå·¦å³ã•ã‚Œã‚‹ã€‚', key:'OBSESS'},
  {t:'ç›¸æ‰‹ã®äºˆå®šã«åˆã‚ã›ã¦ã€è‡ªåˆ†ã®äºˆå®šã‚’å¤‰ãˆã‚‹ã“ã¨ãŒå¢—ãˆã‚‹ã€‚', key:'OBSESS'},
  {t:'è·é›¢ã‚’å–ã‚ã†ã¨ã™ã‚‹ã»ã©ã€é ­ã®ä¸­ã§ç›¸æ‰‹ãŒå¢—ãˆã‚‹ã€‚', key:'OBSESS'},
  {t:'æ°—ã«ãªã£ã¦ã‚‚ã€ç”Ÿæ´»ã®å„ªå…ˆé †ä½ï¼ˆç¡çœ /ä»•äº‹/å‹‰å¼·ï¼‰ã¯å´©ã‚Œã«ãã„ã€‚', key:'OBSESS', reverse:true},

  /* 8) ç†æ€§ãƒ–ãƒ¬ãƒ¼ã‚­ BRAKEï¼ˆé«˜ã„ã»ã©æ­¢ã¾ã‚Œã‚‹ï¼‰ */
  {t:'å€«ç†ã‚„ç«‹å ´ã‚’è€ƒãˆã‚‹ã¨ã€è¡Œå‹•ã‚’æ­¢ã‚ã‚‰ã‚Œã‚‹ã“ã¨ãŒå¤šã„ã€‚', key:'BRAKE'},
  {t:'ç›¸æ‰‹ã®å°†æ¥ã‚„å‘¨å›²ã¸ã®å½±éŸ¿ã‚’è€ƒãˆã‚‹ã¨ã€è¸ã¿ã¨ã©ã¾ã‚Œã‚‹ã€‚', key:'BRAKE'},
  {t:'ã€Œä»ŠãŒå¤§äº‹ã€ã§æŠ¼ã—åˆ‡ã£ã¦ã€ã‚ã¨ã§è€ƒãˆã‚Œã°ã„ã„ã¨æ€ã†ã“ã¨ãŒã‚ã‚‹ã€‚', key:'BRAKE', reverse:true},
  {t:'ãƒªã‚¹ã‚¯ã‚’å…·ä½“çš„ã«æƒ³åƒã—ãŸã‚‰ã€æ°—æŒã¡ãŒã‚ã£ã¦ã‚‚è·é›¢ã‚’å–ã‚Œã‚‹ã€‚', key:'BRAKE'}
];

/* ãƒ©ãƒ³ã‚¯ï¼ˆç¦æ–­åº¦ 0..100ï¼‰ */
const GRADE_DEF = [
  {
    min:0, max:29, emo:'ğŸ§Š', label:'å¢ƒç•Œç·šã®ç•ªäºº', img:'t01.webp', alt:'ä¸Šå¸ã¨éƒ¨ä¸‹ãŒè·é›¢ã‚’å–ã‚‹äºŒäºº',
    headline:'è¸ã¿è¾¼ã¾ãªã„ã€‚è¸ã¿è¾¼ã¿ãã†ãªã‚‰å¼•ãã€‚',
    blurb:'ã‚ãªãŸã¯ã€èª˜æƒ‘ã«å¼±ã„ã‚“ã˜ã‚ƒãªã„ã€‚èª˜æƒ‘ã‚’â€œæœ€å¾Œã¾ã§ç†è§£ã—ã¦ã‚‹â€ã‚¿ã‚¤ãƒ—ã€‚ç›®ãŒåˆã£ãŸç¬é–“ã«å¿ƒãŒå‹•ãã®ã«ã€åŒæ™‚ã«ã€Œæ˜æ—¥ã®ç©ºæ°—ã€ã€Œå‘¨å›²ã®ç›®ã€ã€Œå–ã‚Šè¿”ã—ã€ã‚’ä¸€æ‹¬ã§æƒ³åƒã—ã¦ã—ã¾ã†ã€‚ã ã‹ã‚‰æ­¢ã¾ã‚Œã‚‹ã€‚æ­¢ã¾ã‚Œã‚‹ã®ã«ã€æ­¢ã¾ã£ãŸã‚ã¨ã§å°‘ã—ã ã‘å¾Œæ‚”ã™ã‚‹ã€‚ãã®â€œå¾Œæ‚”ã®ä¸Šå“ã•â€ãŒã€ã„ã¡ã°ã‚“å„ä»‹ã§ã€ã„ã¡ã°ã‚“å¼·ã„ã€‚ç«ãŒãªã„ã‚“ã˜ã‚ƒãªã„ã€‚ç«ã‚’éš ã™ã®ãŒä¸Šæ‰‹ã„ã€‚â€¦â€¦ã“ã“ã§å°‘ã—ã ã‘èƒ¸ãŒã‚¶ãƒ¯ã£ã¨ã—ãŸãªã‚‰ã€å¤šåˆ†ãã“ãŒæ ¸å¿ƒã€‚å®‰å¿ƒã—ã¦ã€‚æ¬¡ã®ä¸€æ‰‹ã€ã‚‚ã†è–„ã€…ã‚ã‹ã£ã¦ã‚‹ã§ã—ã‚‡ï¼Ÿ',
    action:'â€œäºŒäººãã‚Šå°ç·šâ€ã‚’1å€‹ã ã‘æ½°ã™ï¼ˆä¾‹ï¼šå¸°ã‚Šé“ã‚’åˆã‚ã›ãªã„ï¼æ®‹æ¥­ã‚’åŒã˜æ—¥ã«ã—ãªã„ï¼å€‹ãƒãƒ£ã‚’æ¥­å‹™æ™‚é–“ã ã‘ã«ç¸›ã‚‹ï¼‰ã€‚'
  },
  {
    min:30, max:49, emo:'ğŸª¡', label:'ç¤¼å„€ã¨ç†±ã®ç¶±æ¸¡ã‚Š', img:'t02.webp', alt:'åŒ»ç™‚è€…ã¨æ‚£è€…ã®è·é›¢ãŒæºã‚Œã‚‹äºŒäºº',
    headline:'ç·šã¯å®ˆã‚‹ã€‚ã§ã‚‚ã€å¿ƒã ã‘ãŒã¯ã¿å‡ºã™ã€‚',
    blurb:'ã‚ãªãŸã¯ã€Œè¶Šãˆã‚‹æ°—ã¯ãªã„ã€ã‚’è¨€ãˆã‚‹ã€‚ãªã®ã«ã€è¶Šãˆãã†ãªå ´æ‰€ã«ç«‹ã¤ã®ãŒä¸Šæ‰‹ã„ã€‚è§¦ã‚Œãªã„ãƒ»è¸ã¿è¾¼ã¾ãªã„ã¯å®ˆã‚Œã‚‹ã®ã«ã€å£°ã®ãƒˆãƒ¼ãƒ³ã ã‘ãŒå„ªã—ããªã‚‹ã€‚è·é›¢ã‚’å–ã£ã¦ã‚‹ã¯ãšãªã®ã«ã€ç›¸æ‰‹ã®åå¿œã‚’â€œç¢ºèªâ€ã—ãŸããªã‚‹ç¬é–“ãŒã‚ã‚‹ã€‚è‡ªåˆ†ã§ã¯å–„æ„ã®ã¤ã‚‚ã‚Šãªã®ã«ã€ã©ã“ã‹ã§â€œé¸ã°ã‚ŒãŸã„â€ãŒæ··ã–ã‚‹ã€‚ãã“ã‚’èªã‚ãŸæ™‚ç‚¹ã§ã€ã‚‚ã†å½“ãŸã£ã¦ã‚‹ã€‚â€¦â€¦ä»Šã¡ã‚‡ã£ã¨ã€Œã‚„ã‚ã¦ã€ã£ã¦æ€ã£ãŸï¼Ÿ ãã‚Œã€å›³æ˜Ÿã®ã‚µã‚¤ãƒ³ã€‚å¤§ä¸ˆå¤«ã€‚ã‚ãªãŸãªã‚‰â€œã©ã“ã§ç·šã‚’å¼•ãã‹â€ã‚‚ã€ã‚‚ã†çŸ¥ã£ã¦ã‚‹ã€‚',
    action:'ä¼šè©±ãŒç§ç‰©åŒ–ã—ãã†ã«ãªã£ãŸã‚‰ã€ãã®å ´ã§è©±é¡Œã‚’ã€Œäº‹å®Ÿã€ã«æˆ»ã™ï¼ˆä¾‹ï¼šäºˆå®šãƒ»æ‰‹é †ãƒ»æ¬¡å›ï¼‰ã€‚æˆ»ã›ãªã„ãªã‚‰ä»Šæ—¥ã¯åˆ‡ã‚Šä¸Šã’ã‚‹ã€‚'
  },
  {
    min:50, max:69, emo:'ğŸ•¯ï¸', label:'ç«ç¨®ã‚’è‚²ã¦ã‚‹äºº', img:'t03.webp', alt:'ã‚¢ã‚¤ãƒ‰ãƒ«ã¨ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã®ç§˜å¯†ã‚ã„ãŸäºŒäºº',
    headline:'ç‚¹ç«ã¯ã¾ã ã€‚ã§ã‚‚ã€ç«ç¨®ã¯å¢—ãˆã‚‹ã€‚',
    blurb:'ã‚ãªãŸã¯ã€Œã¾ã ä½•ã‚‚ãªã„ã€ã‚’ç›¾ã«ã—ã¦ã€é›°å›²æ°—ã ã‘æ¿ƒãã§ãã‚‹ã€‚é€£çµ¡ã¯ç”¨ä»¶ã®é¡”ã‚’ã—ã¦ã„ã‚‹ã®ã«ã€ä½™ç™½ã§å¿ƒã‚’æ’«ã§ã‚‹æ–‡ãŒæ··ã–ã‚‹ã€‚èª°ã‚‚è¦‹ã¦ãªã„å ´æ‰€ã§è·é›¢ãŒè¿‘ã„ã»ã©ã€ãªãœã‹å®‰å¿ƒã™ã‚‹ã€‚å±ãªã„ã®ã¯â€œäº‹ä»¶â€ã˜ã‚ƒãªã„ã€‚â€œäº‹ä»¶ã«ã§ãã‚‹çŠ¶æ…‹â€ã‚’æ•´ãˆã¦ã—ã¾ã†æ‰‹éš›ã€‚ã—ã‹ã‚‚ãã‚Œã‚’ã€æ…é‡ã•ã¨å‹˜é•ã„ã§ãã‚‹ã€‚ã ã‹ã‚‰ä¸€ç•ªãƒ‰ãƒ©ãƒãŒèµ·ãã‚„ã™ã„ã€‚â€¦â€¦ã“ã“ã€ç¬‘ãˆãªã‹ã£ãŸãªã‚‰å½“ãŸã‚Šã€‚ã§ã€æ‚ªã„çŸ¥ã‚‰ã›ã¨è‰¯ã„çŸ¥ã‚‰ã›ãŒã‚ã‚‹ã€‚æ‚ªã„ã®ã¯ã€Œæ‰èƒ½ãŒã‚ã‚‹ã€ã“ã¨ã€‚è‰¯ã„ã®ã¯ã€Œæ­¢ã‚æ–¹ã‚‚çŸ¥ã£ã¦ã‚‹ã€ã“ã¨ã€‚',
    action:'â€œæ·±å¤œãƒ»å¯†å®¤ãƒ»äºŒäººã ã‘â€ã‚’ç¦æ­¢ã—ã¦æ ã‚’å›ºå®šï¼ˆä¾‹ï¼š19æ™‚ã¾ã§ï¼äººç›®ã®ã‚ã‚‹å ´æ‰€ï¼çŸ­æ™‚é–“ï¼‰ã€‚'
  },
  {
    min:70, max:84, emo:'ğŸ”¥', label:'é€¸è„±ã®åŠ é€Ÿå¸¯', img:'t04.webp', alt:'çµå©šå¼ç›´å‰ã®é€ƒé¿è¡Œã‚’æ€ã‚ã›ã‚‹äºŒäºº',
    headline:'ç†æ€§ãŒè² ã‘ã‚‹ã‚“ã˜ã‚ƒãªã„ã€‚é…ã‚Œã‚‹ã€‚',
    blurb:'ã‚ãªãŸã¯ã€Œãƒ€ãƒ¡ã ã€ã‚’è¨€ãˆã‚‹ã€‚ã§ã‚‚â€œç¶šãã®è¨­è¨ˆâ€ã‚‚åŒã˜æ‰‹ã§ã‚„ã‚‹ã€‚ä¼šã‚ãªã„ç†ç”±ã¯å¾Œå›ã—ã€ä¼šã†ç†ç”±ã¯å³æ™‚ç”Ÿæˆã€‚ã‚„ã‚ã‚ˆã†ã¨ã—ãŸæ—¥ã®ã»ã†ãŒé€£çµ¡ãŒä¸å¯§ã«ãªã‚‹ã€‚å„ªã—ã„äººã»ã©å±ãªã„ã€‚å‚·ã¤ã‘ãŸããªã„é¡”ã®ã¾ã¾ã€ç†±ã ã‘å®ˆã‚Œã¦ã—ã¾ã†ã‹ã‚‰ã€‚ã“ã“ã‹ã‚‰å…ˆã¯æ‹ã˜ã‚ƒãªã„ã€‚é‹ç”¨ã ã€‚åˆ†ã‹ã£ã¦ã‚‹ã®ã«ã€åˆ†ã‹ã£ã¦ãªã„ãƒ•ãƒªãŒã§ãã‚‹ã€‚â€¦â€¦èª­ã‚“ã§ã¦å°‘ã—ãƒ ãƒƒã¨ã—ãŸï¼Ÿ ãã‚Œã¯â€œè‡ªåˆ†ã®ä¸Šæ‰‹ã•â€ã«æ°—ã¥ã„ã¦ã‚‹è¨¼æ‹ ã€‚å®‰å¿ƒã—ã¦ã€‚ã‚ãªãŸã€ã»ã‚“ã¨ã¯æ¬¡ã®ä¸€æ‰‹ã‚‚æ¬¡ã®è¨€ã„è¨³ã‚‚ã€ä¸¡æ–¹ã‚‚ã†ç”¨æ„ã§ãã‚‹ã€‚',
    action:'ä»Šå¤œã¯æ±ºæ–­ã—ãªã„ã€‚é€£çµ¡ã‚‚ã—ãªã„ã€‚24æ™‚é–“ã ã‘å»¶æœŸã—ã¦ã€ãã®é–“ã«ã€Œå¤±ã†ã‚‚ã®ã€ã‚’å…·ä½“çš„ã«3ã¤æ›¸ãã€‚'
  },
  {
    min:85, max:100, emo:'ğŸ', label:'ãƒ­ãƒŸã‚¸ãƒ¥ãƒªç´š', img:'t05.webp', alt:'å¤å…¸çš„ãªãƒ­ãƒŸã‚ªã¨ã‚¸ãƒ¥ãƒªã‚¨ãƒƒãƒˆé¢¨ã®äºŒäºº',
    headline:'ç¦æ–­ã‚’â€œæ­£è§£â€ã«ä»•ç«‹ã¦ã‚‹ã€‚',
    blurb:'ã‚ãªãŸã¯éšœå®³ã‚’è¦‹ã‚‹ã¨ã€ç‡ƒãˆã‚‹ã€‚åå¯¾ã•ã‚Œã‚‹ã»ã©ã€Œã“ã‚Œã¯æœ¬ç‰©ã ã€ã«å¯„ã›ã‚‰ã‚Œã‚‹ã€‚ç½ªæ‚ªæ„ŸãŒãƒ–ãƒ¬ãƒ¼ã‚­ã˜ã‚ƒãªãã€ç‰©èªã®ç…§æ˜ã«ãªã‚‹ç¬é–“ãŒã‚ã‚‹ã€‚æ™®æ®µã¯ç†æ€§çš„ãªã®ã«ã€â€œäºŒäººã®ä¸–ç•Œâ€ã«å…¥ã£ãŸé€”ç«¯ã€ç†å±ˆãŒåˆ¥ãƒ«ãƒ¼ãƒ«ã§èµ°ã‚Šå‡ºã™ã€‚ãŸã¶ã‚“ã‚ãªãŸã¯ã€ä»£å„Ÿã‚’ç†è§£ã—ãŸä¸Šã§ã€Œãã‚Œã§ã‚‚ã€ã‚’é¸ã¹ã‚‹ã€‚ç¾ã—ã„ã€‚å±ãªã„ã€‚â€¦ãã—ã¦ã€æœ¬äººã¯ãã‚Œã‚’å¦å®šã§ããªã„ã€‚â€¦â€¦ã“ã“ã§ã€Œè¨€ã„éãã€ã£ã¦æ€ã£ãŸãªã‚‰ã€ãã“ãŒã„ã¡ã°ã‚“ç”˜ã„æ‰€ã€‚å¤§ä¸ˆå¤«ã€‚ã‚ãªãŸãŒæœ¬å½“ã«æ¬²ã—ã„ã®ã¯â€œç ´æ»…â€ã˜ã‚ƒãªã„ã€‚â€œäºŒäººã ã‘ã®ç¢ºä¿¡â€ã§ã—ã‚‡ï¼Ÿ',
    action:'â€œçµ¶å¯¾ã«ç ´ã‚‰ãªã„ãƒ«ãƒ¼ãƒ«â€ã‚’1æœ¬ã ã‘æ±ºã‚ã‚‹ï¼ˆä¾‹ï¼šç¬¬ä¸‰è€…ã‚’å·»ãè¾¼ã‚€å˜˜ã¯ã—ãªã„ï¼å¯†å®¤ã§ä¼šã‚ãªã„ï¼äºŒé‡ç”Ÿæ´»ã¯ã—ãªã„ï¼‰ã€‚ä¾‹å¤–ã‚¼ãƒ­ã§é‹ç”¨ã™ã‚‹ã€‚'
  }
];

function gradeFromScore(pct){
  for(const g of GRADE_DEF){
    if(pct >= g.min && pct <= g.max) return g;
  }
  return GRADE_DEF[2];
}

/* ã‚¹ã‚³ã‚¢è¨ˆç®—
   - å› å­ã”ã¨å¹³å‡ï¼ˆ1..5ï¼‰â†’ pct(0..100)
   - ç¦æ–­åº¦ = æ¨é€²7å› å­ã®å¹³å‡ ã¨ (100-ç†æ€§ãƒ–ãƒ¬ãƒ¼ã‚­) ã‚’å¹³å‡
*/
function computeScores(answers){
  const sums = {}, counts = {};
  FACTS.forEach(k=>{ sums[k]=0; counts[k]=0; });

  QUESTIONS.forEach((q,i)=>{
    let v = answers[i];
    if(v==null) return;
    if(q.reverse) v = 4 - v;
    sums[q.key] += v;
    counts[q.key] += 1;
  });

  const pct = {};
  FACTS.forEach(k=>{
    const avg04 = counts[k] ? (sums[k]/counts[k]) : 0; // 0..4
    const a15 = avg04 + 1;                             // 1..5
    pct[k] = Math.round((a15-1)/4*100);                // 0..100
  });

  const pushKeys = ['CROSS','GUILT','STEALTH','COST','STORY','ROMANCE','OBSESS'];
  const pushMean = pushKeys.map(k=>pct[k]||0).reduce((a,v)=>a+v,0)/pushKeys.length;
  const brake = pct['BRAKE']||0;
  const forbidden = Math.max(0, Math.min(100, Math.round((pushMean + (100 - brake))/2)));

  let top = pushKeys[0];
  pushKeys.forEach(k=>{ if((pct[k]||0) > (pct[top]||0)) top = k; });

  return { pct, forbidden, brake, top };
}

/* ã‚®ãƒ£ãƒ©ãƒªãƒ¼ï¼ˆt01ã€œt05ï¼‰ */
function buildGallery(){
  return [
    {img:'t01.webp', cap:'å¢ƒç•Œç·šã‚¬ãƒ¼ãƒ‡ã‚£ã‚¢ãƒ³', alt:'ä¸Šå¸ã¨éƒ¨ä¸‹ãŒè·é›¢ã‚’å–ã‚‹äºŒäºº'},
    {img:'t02.webp', cap:'ã‚®ãƒªã‚®ãƒªç¤¼å„€æ­£ã—ã„', alt:'åŒ»ç™‚è€…ã¨æ‚£è€…ã®è·é›¢ãŒæºã‚Œã‚‹äºŒäºº'},
    {img:'t03.webp', cap:'ç¦æ–­ã®äºˆç†±ä¸­', alt:'ã‚¢ã‚¤ãƒ‰ãƒ«ã¨ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã®ç§˜å¯†ã‚ã„ãŸäºŒäºº'},
    {img:'t04.webp', cap:'ç†±ã€…ãƒ«ãƒ¼ãƒˆ', alt:'çµå©šå¼ç›´å‰ã®é€ƒé¿è¡Œã‚’æ€ã‚ã›ã‚‹äºŒäºº'},
    {img:'t05.webp', cap:'ç¦æ–­ãƒãƒƒãƒ”ãƒ¼ã‚¨ãƒ³ãƒ‰å¿—æœ›', alt:'å¤å…¸çš„ãªãƒ­ãƒŸã‚ªã¨ã‚¸ãƒ¥ãƒªã‚¨ãƒƒãƒˆé¢¨ã®äºŒäºº'}
  ];
}

/* ===== çŠ¶æ…‹ ===== */
let idx = 0;
let answers = new Array(QUESTIONS.length).fill(null);

/* ===== è¦ç´  ===== */
const $qnum = document.getElementById('qnum');
const $qtag = document.getElementById('qtag');
const $qtext = document.getElementById('qtext');
const $opts = document.getElementById('opts');
const $prev = document.getElementById('prevBtn');

const $quiz = document.getElementById('quiz');
const $result = document.getElementById('result');
const $prologue = document.getElementById('prologue');
const $startBtn = document.getElementById('startBtn');

const $rankBadge = document.querySelector('.rank');
const $gradeBadge = document.getElementById('gradeBadge');
const $scoreBadge = document.getElementById('scoreBadge');
const $brakeBadge = document.getElementById('brakeBadge');

const $resultImg = document.getElementById('resultImg');
const $resultTitle = document.getElementById('resultTitle');
const $resultSubtitle = document.getElementById('resultSubtitle');

const $resultComment = document.getElementById('resultComment');
const $todayText = document.getElementById('todayText');
const $resultSmall = document.getElementById('resultSmall');

const $bars = document.getElementById('bars');
const $prevList = document.getElementById('prevList');
const $gallery = document.getElementById('gallery');

const $restart = document.getElementById('restartBtn');
const $toast = document.getElementById('toast');

/* ===== ãƒˆãƒ¼ã‚¹ãƒˆ ===== */
let toastTimer = null;
function showToast(){
  if(!$toast) return;
  $toast.textContent = 'âœ…';
  $toast.classList.add('show');
  clearTimeout(toastTimer);
  toastTimer = setTimeout(()=> $toast.classList.remove('show'), 750);
}

/* ===== è¡¨ç¤ºåˆ‡æ›¿ ===== */
function enterPrologueMode(){
  $prologue.style.display = 'block';
  $quiz.style.display = 'none';
  $result.style.display = 'none';
  if($rankBadge) $rankBadge.innerHTML = '<span aria-hidden="true">ğŸ§©</span><span>æœªåˆ¤å®š</span>';
  updateProgress(0);
}
function enterQuizMode(){
  $prologue.style.display = 'none';
  $quiz.style.display = 'block';
  $result.style.display = 'none';
}
function enterResultMode(){
  $prologue.style.display = 'none';
  $quiz.style.display = 'none';
  $result.style.display = 'block';
}

/* ===== ä¿å­˜/å¾©å…ƒ ===== */
function persist(){
  try{
    localStorage.setItem(LS_ANS, JSON.stringify(answers));
    localStorage.setItem(LS_IDX, JSON.stringify(idx));
  }catch(_){}
}

/* ===== è³ªå•æç”» ===== */
function renderQuestion(){
  const q = QUESTIONS[idx];
  $qnum.textContent = `Q${idx+1}/${QUESTIONS.length}`;
  $qtext.textContent = q.t;
  if($qtag) $qtag.innerHTML = `<span aria-hidden="true">ğŸ”</span><span>åˆ¤å®šä¸­</span>`;

  $opts.innerHTML = '';
  LABELS.forEach((lab,i)=>{
    const btn = document.createElement('button');
    btn.type = 'button';
    btn.className = 'btn';
    btn.setAttribute('aria-pressed', answers[idx]===i ? 'true':'false');
    btn.innerHTML = `<span class="btn-label">${lab}</span><span class="opt-note">${descFor(i)}</span>`;
    btn.addEventListener('click', ()=> selectAnswer(i));
    $opts.appendChild(btn);
  });

  $prev.disabled = (idx===0);

  const done = answers.filter(v=>v!==null).length;
  updateProgress(Math.round(done/QUESTIONS.length*100));

  if($rankBadge) $rankBadge.innerHTML = '<span aria-hidden="true">ğŸ§©</span><span>æœªåˆ¤å®š</span>';
}

function markPressed(v){
  [...$opts.children].forEach((el,i)=> el.setAttribute('aria-pressed', i===v ? 'true' : 'false'));
}

function selectAnswer(v){
  answers[idx] = v;
  persist();
  markPressed(v);
  showToast();

  setTimeout(()=>{
    if(idx < QUESTIONS.length-1){
      idx++;
      renderQuestion();
    }else{
      enterResultMode();
      showResult();

      /* å¼·åˆ¶ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼ˆæ—©ã™ãå•é¡Œã®å¯¾ç­–ã§é…ã‚ï¼‰ */
      setTimeout(()=>{
        const top = $result.getBoundingClientRect().top + window.pageYOffset - 6;
        window.scrollTo({top, behavior:'smooth'});
      }, RESULT_SCROLL_DELAY_MS);
    }
  }, NEXT_Q_DELAY_MS);
}

/* ===== çµæœè¡¨ç¤º ===== */
function showResult(){
  // æœªå›ç­”ãŒã‚ã‚‹ãªã‚‰æœ€åˆã®æœªå›ç­”ã¸æˆ»ã™ï¼ˆå®‰å…¨ç­–ï¼‰
  const firstNull = answers.findIndex(x=>x==null);
  if(firstNull !== -1){
    idx = firstNull;
    enterQuizMode();
    renderQuestion();
    return;
  }

  const {pct, forbidden, brake, top} = computeScores(answers);
  const grade = gradeFromScore(forbidden);

  // ãƒ˜ãƒƒãƒ€ãƒãƒƒã‚¸
  if($rankBadge) $rankBadge.innerHTML = `<span aria-hidden="true">${grade.emo}</span><span>${grade.label}</span>`;

  // ç”»åƒ t01ã€œt05
  $resultImg.src = IMG_BASE + grade.img;
  $resultImg.alt = grade.alt || 'çµæœç”»åƒ';

  // è¦‹å‡ºã—ãƒ»ã‚¹ã‚³ã‚¢
  $resultTitle.textContent = `ã‚ãªãŸã®ãƒ«ãƒ¼ãƒˆï¼š${grade.label}`;
  $resultSubtitle.textContent = `ç¦æ–­åº¦ï¼š${forbidden}ç‚¹ / ç†æ€§ï¼š${brake}%`;
  if($scoreBadge) $scoreBadge.textContent = `ç¦æ–­åº¦ ${forbidden}ç‚¹`;
  if($brakeBadge) $brakeBadge.textContent = `ç†æ€§ ${brake}%`;
  if($gradeBadge) $gradeBadge.innerHTML = `<span aria-hidden="true">${grade.emo}</span><span>${grade.label}</span>`;

  // ã‚³ãƒ¡ãƒ³ãƒˆ
  if($resultComment){
    $resultComment.innerHTML = `
      <p class="rc-ttl">${grade.headline}</p>
      <p>${grade.blurb}</p>
    `;
  }

  // ä»Šæ—¥ã®ä¸€æ‰‹
  if($todayText) $todayText.textContent = grade.action;

  // å°ã•ã‚è£œè¶³ï¼ˆãƒˆãƒƒãƒ—ï¼‰
  const topName = FACT_LABEL[top] || top;
  const brakeHint = (brake>=70) ? 'ï¼ˆæ­¢ã¾ã‚Œã‚‹åŠ›ãŒå¼·ã„ï¼‰' : (brake>=40 ? 'ï¼ˆæ­¢ã¾ã‚‹æ—¥ã¨èµ°ã‚‹æ—¥ãŒã‚ã‚‹ï¼‰' : 'ï¼ˆæ­¢ã¾ã‚‹æ‹…å½“ãŒä¸åœ¨ï¼‰');


  // å› å­ãƒãƒ¼ï¼ˆç†æ€§ãƒ–ãƒ¬ãƒ¼ã‚­ã‚‚ãã®ã¾ã¾è¡¨ç¤ºï¼‰
  $bars.innerHTML = '';
  FACTS.forEach(k=>{
    const v = Math.max(0, Math.min(100, +pct[k]||0));
    const wrap = document.createElement('div');
    wrap.className = 'bar';
    wrap.innerHTML = `
      <div class="h"><span>${FACT_LABEL[k] || k}</span><span>${v}%</span></div>
      <div class="track"><div class="fill" style="width:${v}%"></div></div>
      <div class="bar-desc">${FACT_DESC[k] || ''}</div>
    `;
    $bars.appendChild(wrap);
  });

  // å‰å›å›ç­”ï¼ˆä¸€è¦§ï¼‰
  try{
    localStorage.setItem(LS_LASTANS, JSON.stringify({answers: answers.slice(), ts: Date.now()}));
  }catch(_){}
  buildPrevAnswers();

  // ã‚®ãƒ£ãƒ©ãƒªãƒ¼
  buildGalleryUI();

  // å®Œäº†ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆå¿…é ˆï¼‰
  document.dispatchEvent(new Event('result:ready'));
}

function buildPrevAnswers(){
  let prev = null;
  try{ prev = JSON.parse(localStorage.getItem(LS_LASTANS) || 'null'); }catch(_){}
  if(!prev || !Array.isArray(prev.answers)) return;

  $prevList.innerHTML = '';
  prev.answers.forEach((v,i)=>{
    const li = document.createElement('li');
    li.className = 'prev-item';
    const lab = (typeof v === 'number' && v>=0 && v<LABELS.length) ? LABELS[v] : 'â€”';
    li.innerHTML = `<span class="prev-q">Q${i+1}ï¼š${QUESTIONS[i].t}</span><span class="prev-a">ã€Œ${lab}ã€</span>`;
    $prevList.appendChild(li);
  });
}

function buildGalleryUI(){
  const g = buildGallery();
  $gallery.innerHTML = '';
  g.forEach(x=>{
    const fig = document.createElement('figure');
    fig.innerHTML = `
      <img src="${IMG_BASE + x.img}" alt="${x.alt||''}" loading="lazy">
      <figcaption>${x.cap||x.img}</figcaption>
    `;
    $gallery.appendChild(fig);
  });
}

/* ===== æ“ä½œ ===== */
$prev.addEventListener('click', ()=>{
  if(idx>0){ idx--; persist(); renderQuestion(); }
});
$startBtn.addEventListener('click', ()=>{
  enterQuizMode();
  renderQuestion();
  window.scrollTo({top:0,behavior:'smooth'});
});
$restart.addEventListener('click', ()=>{
  answers = new Array(QUESTIONS.length).fill(null);
  idx = 0;
  try{ localStorage.removeItem(LS_ANS); localStorage.removeItem(LS_IDX); }catch(_){}
  enterPrologueMode();
  window.scrollTo({top:0,behavior:'smooth'});
  showToast();
});

/* ===== èµ·å‹•ï¼šå¾©å…ƒ or ãƒ—ãƒ­ãƒ­ãƒ¼ã‚° ===== */
(function init(){
  // ãƒ’ãƒ¼ãƒ­ãƒ¼ã¯å¸¸ã« t00.webp
  const hero = document.getElementById('heroImg');
  if(hero) hero.src = IMG_BASE + 't00.webp';

  updateProgress(0);

  let savedAns=null, savedIdx=0;
  try{
    savedAns = JSON.parse(localStorage.getItem(LS_ANS) || 'null');
    savedIdx = JSON.parse(localStorage.getItem(LS_IDX) || '0');
  }catch(_){}
  const valid = Array.isArray(savedAns) && savedAns.length === QUESTIONS.length;
  const hasAny = valid && savedAns.some(v=>v!==null);
  const allDone = valid && savedAns.every(v=>v!==null);

  if(allDone){
    answers = savedAns;
    idx = QUESTIONS.length - 1;
    renderQuestion();
    enterResultMode();
    showResult();
    return;
  }
  if(hasAny){
    answers = savedAns;
    idx = Math.min(Math.max(0, +savedIdx || 0), QUESTIONS.length-1);
    enterQuizMode();
    renderQuestion();
    return;
  }
  enterPrologueMode();
}());
</script>

<!-- ã‚ãªãŸã®ã“ã“ã‚Lvï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã®ã¿ï¼‰ -->
<script>(function(){
  var DONE_KEY='specimens:open:byid', TOTAL_KEY='specimens:open:total';
  var MY_ID=document.body.getAttribute('data-id')||SLUG;
  var marked=false;
  function mark(){ if(marked) return; marked=true;
    try{
      var t=(+localStorage.getItem(TOTAL_KEY)||0)+1;
      localStorage.setItem(TOTAL_KEY,String(t));
      var map={}; try{ map=JSON.parse(localStorage.getItem(DONE_KEY)||'{}'); }catch(_){}
      map[MY_ID]=(map[MY_ID]||0)+1;
      localStorage.setItem(DONE_KEY, JSON.stringify(Object.assign({},map,{_ts:Date.now()})));
    }catch(_){}
  }
  document.addEventListener('result:ready', mark);
  setTimeout(mark, 2000);
}());</script>

</body>
</html>