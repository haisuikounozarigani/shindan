<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>宝石タイプ恋愛診断</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{ --brand:#b86b77; --card:#fff; --bg:#fdf6f0; }
    body{ font-family: system-ui,-apple-system,"Segoe UI",Roboto,"Hiragino Kaku Gothic ProN","Noto Sans JP",sans-serif;
          background: var(--bg); color:#333; margin:0; padding:22px; }
    .wrap{ max-width:880px; margin:0 auto; }
    h1{ text-align:center; color:var(--brand); margin:4px 0 14px; font-size:clamp(20px,4vw,30px); }
    .card{ background:var(--card); padding:20px; border-radius:12px; box-shadow:0 6px 18px rgba(0,0,0,.08); }
    .meta{ display:flex; justify-content:space-between; gap:12px; color:#666; font-size:12px; margin:0 2px 12px; }
    .question{ margin:22px 0; }
    .question p{ margin:0 0 10px; font-weight:600; }
    .scale{ display:grid; gap:8px; }
    .scale label{ display:flex; align-items:center; gap:10px; background:#f4f4f4; padding:10px; border-radius:10px; cursor:pointer; }
    .scale input{ accent-color:var(--brand); }
    .actions{ display:flex; justify-content:center; gap:10px; flex-wrap:wrap; margin-top:18px; }
    .btn{ background:var(--brand); color:#fff; border:none; border-radius:10px; padding:12px 18px; font-size:16px; cursor:pointer; }
    .btn.secondary{ background:#8a8a8a; }
    #result{ text-align:center; color:var(--brand); margin-top:22px; white-space:pre-line; }
    #link{ text-align:center; margin-top:12px; }
    #link a{ display:inline-block; background:var(--brand); color:#fff; text-decoration:none; padding:10px 16px; border-radius:10px; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>💎 宝石タイプ 恋愛診断 💎</h1>

    <div class="card">
      <div class="meta">
        <span id="progress">未回答 32 / 32</span>
        <span>5件法：1（まったく当てはまらない）〜5（とても当てはまる）</span>
      </div>

      <form id="quizForm"></form>

      <div class="actions">
        <button type="button" class="btn" onclick="calculate()">診断する</button>
        <button type="button" class="btn secondary" onclick="resetForm()">リセット</button>
      </div>

      <h2 id="result"></h2>
      <div id="link"></div>
    </div>
  </div>

  <script>
    // 質問（32問）
    const questions = [
      // Eros（情熱）
      "恋愛は運命のようなものであると感じる",
      "一目惚れすることが多い",
      "恋愛中は理想を追い求めがち",
      "恋愛は感情がすべてだと思う",
      // Ludus（遊戯）
      "恋愛はゲームのような楽しさが大事",
      "複数の人に同時に好意を持つことがある",
      "恋愛に自由が必要だと思う",
      "深刻すぎる恋愛は苦手",
      // Storge（友愛）
      "恋愛は友情から始まるのが理想",
      "信頼関係を大事にしたい",
      "恋人とは長い時間をかけて関係を築きたい",
      "恋人と親友のような関係が理想",
      // Mania（熱狂）
      "相手が自分をどう思っているか常に気になる",
      "恋人に不安を感じることが多い",
      "恋愛中は相手に依存しやすい",
      "少しの変化で不安になる",
      // Pragma（実利）
      "相手の条件（仕事・性格など）を重視する",
      "恋愛において損得を考えることがある",
      "安定した将来を想像できる相手を選ぶ",
      "恋人選びは計画的にしたい",
      // Agape（無償）
      "相手の幸せを自分のことのように思う",
      "恋愛では自分を犠牲にしても構わない",
      "相手の成長を支えたいと思う",
      "恋人に無条件の愛を注ぐべきだと思う",
      // 不安（Anxious）
      "恋人が離れていくのではと不安になる",
      "些細なことで嫌われたと感じてしまう",
      "恋人の返信が遅いと気になってしまう",
      "恋愛関係が壊れるのが怖い",
      // 回避（Avoidant）
      "人に頼ることが苦手",
      "恋愛に踏み込みすぎると不安になる",
      "親密になると逃げたくなる",
      "距離感を保った関係の方が落ち着く"
    ];

    const scaleLabels = [
      "1（まったく当てはまらない）",
      "2（あまり当てはまらない）",
      "3（どちらともいえない）",
      "4（やや当てはまる）",
      "5（とても当てはまる）"
    ];

    const form = document.getElementById("quizForm");
    const progressEl = document.getElementById("progress");

    // 設問レンダリング
    questions.forEach((q, i) => {
      const div = document.createElement("div");
      div.className = "question";
      div.innerHTML = `<p>Q${i + 1}. ${q}</p>
        <div class="scale">
          ${scaleLabels.map((label, n) => `
            <label><input type="radio" name="q${i + 1}" value="${n + 1}"> ${label}</label>
          `).join("")}
        </div>`;
      form.appendChild(div);
    });

    // 進捗表示
    function updateProgress(){
      const answered = Array.from({length: questions.length})
        .filter((_,i)=>document.querySelector(`input[name="q${i+1}"]:checked`)).length;
      progressEl.textContent = `未回答 ${questions.length - answered} / ${questions.length}`;
    }
    form.addEventListener("change", updateProgress);
    updateProgress();

    // 計算
    function calculate() {
      let scores = {
        eros: 0, ludus: 0, storge: 0, mania: 0, pragma: 0, agape: 0,
        anxiety: 0, avoidance: 0
      };

      for (let i = 1; i <= questions.length; i++) {
        const val = parseInt(document.querySelector(`input[name='q${i}']:checked`)?.value);
        if (!val) { alert(`全ての質問に答えてください。\n未回答の設問があります（Q${i}）。`); return; }
        if (i <= 4) scores.eros += val;
        else if (i <= 8) scores.ludus += val;
        else if (i <= 12) scores.storge += val;
        else if (i <= 16) scores.mania += val;
        else if (i <= 20) scores.pragma += val;
        else if (i <= 24) scores.agape += val;
        else if (i <= 28) scores.anxiety += val;
        else scores.avoidance += val;
      }

      // 恋愛スタイルの最大スコア
      const loveType = Object.entries(scores).slice(0,6).sort((a,b)=>b[1]-a[1])[0][0];

      // 愛着タイプ判定
      let attachType = "secure";
      if (scores.anxiety >= 11 && scores.avoidance >= 11) attachType = "fearful";
      else if (scores.anxiety >= 11) attachType = "anxious";
      else if (scores.avoidance >= 11) attachType = "avoidant";

      // 表示用ラベル
      const loveJP = { eros:"情熱", ludus:"遊戯", storge:"友愛", mania:"熱狂", pragma:"実利", agape:"無償" };
      const attachJP = { secure:"安定", anxious:"不安", avoidant:"回避", fearful:"恐れ回避" };

      // スタイル×愛着 → 宝石
      const gemMap = {
        eros:   { anxious:"ファイアオパール", secure:"ガーネット",      avoidant:"スピネル",        fearful:"ルビー" },
        ludus:  { anxious:"タンザナイト",     secure:"シトリン",        avoidant:"ターコイズ",      fearful:"アパタイト" },
        storge: { anxious:"ムーンストーン",   secure:"アクアマリン",    avoidant:"ペリドット",      fearful:"ラブラドライト" },
        pragma: { anxious:"ブルートパーズ",   secure:"サファイア",      avoidant:"ブラックオニキス", fearful:"スモーキークォーツ" },
        mania:  { anxious:"エメラルド",       secure:"アレキサンドライト", avoidant:"オブシディアン", fearful:"オパール" },
        agape:  { anxious:"ピンクトルマリン", secure:"ダイヤモンド",    avoidant:"モルガナイト",    fearful:"ローズクォーツ" }
      };

      const gem = gemMap[loveType]?.[attachType] || "不明";

      // 結果表示
      const result = document.getElementById("result");
      result.textContent =
        `あなたの宝石タイプは「${gem}」\n（恋愛スタイル：${loveJP[loveType]} × 愛着：${attachJP[attachType]}）`;

      // スタイル別解説ページへのリンク
      const styleToUrl = {
        eros:   "https://seikaku.my.canva.site/houseki-eros",
        ludus:  "https://seikaku.my.canva.site/houseki-ludus",
        storge: "https://seikaku.my.canva.site/houseki-storge",
        pragma: "https://seikaku.my.canva.site/houseki-pragma",
        mania:  "https://seikaku.my.canva.site/houseki-mania",
        agape:  "https://seikaku.my.canva.site/houseki-agape"
      };
      document.getElementById("link").innerHTML =
        `<a href="${styleToUrl[loveType] || '#'}" target="_blank" rel="noopener">▶ あなたのタイプの解説を見る</a>`;

      updateProgress();
      window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
    }

    function resetForm(){
      document.getElementById("quizForm").reset();
      document.getElementById("result").textContent = "";
      document.getElementById("link").innerHTML = "";
      updateProgress();
      window.scrollTo({top:0, behavior:"smooth"});
    }
  </script>
</body>
</html>
