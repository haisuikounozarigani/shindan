<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>æƒ‘æ˜Ÿé­…åŠ›è¨ºæ–­</title>
<meta name="description" content="11æƒ‘æ˜ŸÃ—å„3å•=å…¨33å•ï¼ˆ0ã€œ4ã®5ä»¶æ³•ï¼‰ã€‚ä¸»æƒ‘æ˜Ÿã‚¿ã‚¤ãƒ—ã¨å› å­ãƒãƒ¼ã€å…‰åº¦ãƒ©ãƒ³ã‚¯ã€ã‚„ã•ã—ã„ç ”ç©¶ãƒ¡ãƒ¢ã‚’è¡¨ç¤ºã—ã¾ã™ï¼ˆç‹¬è‡ªé …ç›®ï¼ã‚¨ãƒ³ã‚¿ãƒ¡ç”¨ï¼‰ã€‚">
<meta name="theme-color" content="#f7f9ff">
<!-- OG -->
<meta property="og:type" content="website">
<meta property="og:title" content="æƒ‘æ˜Ÿé­…åŠ›è¨ºæ–­">
<meta property="og:description" content="33å•ã§â€œé­…åŠ›ã®å‡ºæ–¹â€ã‚’æƒ‘æ˜Ÿãƒ¢ãƒãƒ¼ãƒ•ã§å¯è¦–åŒ–ã€‚ä¸»æƒ‘æ˜Ÿã‚¿ã‚¤ãƒ—ã¨å› å­ãƒãƒ¼ã€å…‰åº¦ãƒ©ãƒ³ã‚¯ã‚’è¡¨ç¤ºã€‚">
<meta property="og:url" content="https://haisuikounozarigani.github.io/shindan/charm-planets.html">
<meta property="og:image" content="/shindan/assets/results/charm-planets/01.png">
<style>
:root{
  --accent:#ffb84d; --accent2:#6aa9ff;
  --ink:#1f2732; --muted:#667087; --paper:#fff;
  --bg1:#f7f9ff; --bg2:#f6f3ff; --line:#e6ecf7;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; color:var(--ink);
  background:linear-gradient(180deg,var(--bg1),var(--bg2));
  font-family:"Noto Sans JP",system-ui,-apple-system,"Segoe UI",Roboto,"Hiragino Kaku Gothic ProN",sans-serif;
  -webkit-font-smoothing:antialiased;
}
a{color:inherit}
.wrap{max-width:980px;margin:18px auto;padding:0 14px}
header.hd{display:grid;grid-template-columns:56px 1fr;gap:12px;align-items:center;margin:8px 0}
.logo{width:56px;height:56px;border-radius:14px;background:linear-gradient(135deg,#fff2dd,#e1f2ff);display:grid;place-items:center;font-size:28px}
h1{margin:0;font-size:clamp(22px,4.6vw,34px);letter-spacing:.02em}
.sub{margin:4px 0 0;color:var(--muted);font-size:.96em}
.card{background:var(--paper);border:1px solid var(--line);border-radius:16px;padding:14px}
.section{margin:14px 0}
.pill{display:inline-block;padding:4px 8px;border:1px solid var(--line);border-radius:999px;background:#fff;color:#6b6a77;font-size:.88em}
.meta{display:flex;gap:8px;flex-wrap:wrap}

.sticky{position:sticky;top:0;z-index:10;margin:-6px -14px 12px;padding:8px 14px;background:rgba(255,255,255,.86);backdrop-filter:blur(6px) saturate(1.05);border-bottom:1px solid #e9edf7;display:flex;align-items:center;gap:10px}
.progress{height:8px;background:#edf2fb;border-radius:999px;flex:1;overflow:hidden}
.progress>span{display:block;height:100%;width:0;background:linear-gradient(90deg,var(--accent),var(--accent2))}
.btn{padding:10px 14px;border:1px solid var(--line);border-radius:12px;background:#fff;cursor:pointer}
.btn.primary{background:linear-gradient(90deg,var(--accent),var(--accent2));border-color:transparent;color:#fff;font-weight:700}

fieldset.q{border:1px solid var(--line);border-radius:12px;padding:10px;margin:10px 0;background:#fff}
legend{font-weight:700}
.scale{display:grid;grid-template-columns:repeat(5,minmax(66px,1fr));gap:8px;margin-top:8px}
.scale input{position:absolute;opacity:0;pointer-events:none}
.scale label{display:grid;place-items:center;border:1px solid #e5e9f3;border-radius:10px;padding:8px;cursor:pointer;user-select:none;background:#fff}
.scale input:checked+label{outline:2px solid var(--accent);border-color:transparent}
mark.need{animation:need 1.6s ease}
@keyframes need{0%{box-shadow:0 0 0 0 rgba(74,168,255,.45)}100%{box-shadow:0 0 0 0 rgba(74,168,255,0)}}

.result-head{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
.badge{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;background:linear-gradient(90deg,var(--accent),var(--accent2));color:#fff;font-weight:700}
.total{font-size:26px;font-weight:800}
.small{color:var(--muted);font-size:.92em}

.hero-square{display:grid;place-items:center;border:1px solid var(--line);border-radius:16px;background:#fff;overflow:hidden}
.hero-square figure{margin:0;width:min(560px,100%);max-width:100%;aspect-ratio:1/1;border-bottom:1px solid var(--line);background:#f7f9ff}
.hero-square img{width:100%;height:100%;object-fit:contain;display:block}
.hero-square figcaption{padding:10px;width:100%}
.hero-square .capline{font-weight:800;line-height:1.55;overflow-wrap:anywhere;word-break:break-word}
.hero-square .poem{font-style:italic;letter-spacing:.02em;margin-top:4px;color:#445;opacity:.9}
.hero-square .capmini{font-size:1em;line-height:1.85;color:var(--muted);overflow-wrap:anywhere;word-break:break-word}

.grid2{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px}
.stat{border:1px solid var(--line);border-radius:12px;padding:10px;background:#fff}
.stat .big{font-size:22px;font-weight:800}
.hr{height:1px;background:var(--line);margin:10px 0}

.factor-mini{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:10px}
.guard{display:flex;align-items:center;gap:8px;border:1px solid var(--line);border-radius:12px;background:#fff;padding:8px 10px}
.guard .g-emo{font-size:18px}

.bar{border:1px solid var(--line);border-radius:12px;padding:10px;background:#fff}
.bar .row{height:10px;background:#edf2fb;border-radius:999px;overflow:hidden;margin-top:6px}
.bar .row>span{display:block;height:100%;width:0;background:linear-gradient(90deg,var(--accent),var(--accent2))}

.note{border:1px solid var(--line);border-radius:12px;background:#fff;padding:10px}
.note h4{margin:0 0 6px;font-size:16px}
.note .mini{display:inline-block;margin-left:6px;font-size:.82em;color:#6b6a77}
.note p{margin:6px 0;line-height:1.75}

.footer{color:var(--muted);font-size:.92em}
.warn{background:#f8fbff;border:1px solid #e1ebf7;border-radius:12px;padding:10px;margin:12px 0}
.back-area{display:flex;justify-content:center;margin-top:10px}
a.back{display:inline-flex;align-items:center;gap:6px;padding:10px 14px;border:1px solid var(--line);border-radius:12px;background:#fff;text-decoration:none}

.badge-size{display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border-radius:999px;background:#fff;border:1px solid var(--line);font-size:.85em;margin-left:6px}
.title-row{display:flex;align-items:center;gap:6px;flex-wrap:wrap}
.tags{display:flex;flex-wrap:wrap;gap:8px;margin-top:6px}
.tag{padding:3px 8px;border:1px solid var(--line);border-radius:999px;background:#fff;font-size:.84em}

@media (max-width: 560px){
  .wrap{padding:0 10px}
  .sticky{top:calc(env(safe-area-inset-top) + 0px); padding:8px 10px}
  .scale{grid-template-columns:repeat(2,1fr)}
  .scale label{padding:12px 8px;font-size:14px}
  .hero-square figure{width:100%}
  .grid2{grid-template-columns:1fr}
  .badge-size{font-size:.8em}
  .card{padding:12px}
  .hero-square .capline{font-size:clamp(16px,5.2vw,20px);line-height:1.65}
  .hero-square .capmini{font-size:clamp(14px,4.6vw,16px);line-height:1.95}
  .note h4{font-size:15px}
}
</style>
</head>
<body data-id="charm-planets">
<main class="wrap" id="app">
  <header class="hd">
    <div class="logo">ğŸª</div>
    <div>
      <h1>æƒ‘æ˜Ÿé­…åŠ›è¨ºæ–­</h1>
      <p class="sub">11æƒ‘æ˜ŸÃ—å„3å•ï¼å…¨33å•ï¼ˆ0ã€œ4ï¼‰ã€‚ä¸»æƒ‘æ˜Ÿã‚¿ã‚¤ãƒ—ã¨å› å­ãƒãƒ¼ã€å…‰åº¦ãƒ©ãƒ³ã‚¯ï¼ˆLv1ã€œLv5ï¼‰ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚â€»ç‹¬è‡ªé …ç›®ã®ã‚¨ãƒ³ã‚¿ãƒ¡è‡ªå·±ç†è§£ç”¨ã€‚</p>
    </div>
  </header>

  <div class="sticky" aria-live="polite">
    <span>ğŸ“Š</span>
    <div class="progress" aria-label="å›ç­”é€²æ—"><span id="prog"></span></div>
    <button class="btn primary" id="doScore">è¨ºæ–­ã™ã‚‹</button>
  </div>

  <section class="card section" id="desc">
    <h2 style="margin:4px 0 8px">èª¬æ˜</h2>
    <div class="meta" style="margin-bottom:8px">
      <span class="pill">è³ªå•æ•°ï¼š33</span>
      <span class="pill">å½¢å¼ï¼š0â€“4ï¼ˆ0=ã¾ã£ãŸããªã„ / 4=ã¨ã¦ã‚‚ï¼‰</span>
      <span class="pill">ç·åˆï¼š0â€“4ï¼ˆ11å› å­å¹³å‡ï¼‰</span>
    </div>
    <p class="small">ã“ã‚Œã¯<b>é­…åŠ›ã®å‡ºæ–¹ã‚’æ¯”å–©ã§å¯è¦–åŒ–</b>ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã§ã™ã€‚å¤©ä½“åã¯è±¡å¾´ã€‚å…‰ã‚Šæ–¹ã«ã¯äººãã‚Œãã‚Œã®ãƒªã‚ºãƒ ãŒã‚ã‚Šã¾ã™ã€‚</p>
  </section>

  <!-- è¨­å• -->
  <section class="card section" id="questions">
    <h2 style="margin:4px 0 8px">è¨­å•ï¼ˆ0=ã¾ã£ãŸããªã„ï¼1=ã‚ã¾ã‚Šãªã„ï¼2=åŠã€…ï¼3=ã ã„ãŸã„ï¼4=ã¨ã¦ã‚‚ï¼‰</h2>
    <div id="qWrap"></div>
    <div class="tags">
      <span class="tag">å› å­ï¼šå…‰åº¦ï¼å±…å¿ƒåœ°ï¼ä¼šè©±ï¼ç¾æ„è­˜ï¼æ¨é€²ï¼ä½™è£•ï¼ä¿¡é ¼ï¼æ„å¤–æ€§ï¼é¦™ã‚Šãƒ»ä½™éŸ»ï¼æ·±åº¦ï¼å¿ƒã®å®‰å®š</span>
    </div>
    <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:10px">
      <button class="btn" id="clearAns">å›ç­”ã‚’ã‚¯ãƒªã‚¢</button>
      <button class="btn primary" id="doScore2">è¨ºæ–­ã™ã‚‹</button>
    </div>
  </section>

  <!-- çµæœ -->
  <section class="card section" id="result" aria-live="polite">
    <div id="resEmpty">
      <span class="badge">ã¾ã çµæœã¯ã‚ã‚Šã¾ã›ã‚“</span>
      <p class="small">å…¨33å•ã«å›ç­”ã—ã¦ã€Œè¨ºæ–­ã™ã‚‹ã€ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚</p>
    </div>

    <div id="resArea" style="display:none">
      <div class="result-head">
        <span class="badge">çµæœ</span>
        <div class="total" id="typeLine">â€”</div>
      </div>

      <!-- ãƒ¡ã‚¤ãƒ³çµæœï¼ˆ1:1 æ­£æ–¹å½¢ï¼‰ -->
      <div class="hero-square section" role="region" aria-label="ä¸»æƒ‘æ˜Ÿã‚¿ã‚¤ãƒ—">
        <figure>
          <img id="heroImg" src="/shindan/assets/results/charm-planets/01.png" alt="å¤ªé™½ã®å††ç’°ã¨å…‰æ¡" loading="lazy" width="600" height="600">
        </figure>
        <figcaption>
          <div class="title-row">
            <div class="capline" id="heroTitle">â€”</div>
            <span class="badge-size" id="sizeBadge" aria-label="ç·åˆå…‰åº¦">â€”</span>
          </div>
          <div class="poem" id="heroPoem">â€”</div>
          <div class="capmini" id="heroCopy">â€”</div>
        </figcaption>
      </div>

      <!-- æ•°å€¤ãªã© -->
      <div class="grid2">
        <article class="stat" aria-label="ç·åˆã‚¹ã‚³ã‚¢">
          <div><strong>ç·åˆå…‰åº¦ï¼ˆ0â€“4ï¼‰</strong></div>
          <div class="big"><span id="sumAvg">0.00</span> / 4.00</div>
          <div class="small" id="sumNote">â€”</div>
        </article>
        <article class="stat" aria-label="æƒ‘æ˜Ÿãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«">
          <div><strong>æƒ‘æ˜Ÿãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«</strong></div>
          <div class="factor-mini" id="guardArea"><!-- JS --></div>
        </article>
      </div>

      <div class="hr"></div>
      <!-- å› å­ãƒãƒ¼ -->
      <div class="section">
        <h3 style="margin:8px 0">å› å­åˆ¥ã‚¹ã‚³ã‚¢</h3>
        <div id="bars" class="factor-mini"><!-- JS --></div>
      </div>

      <div class="hr"></div>
      <!-- å› å­ã”ã¨ã®èª¬æ˜ -->
      <section class="section" id="factorNotesSec">
        <h3 style="margin:8px 0">å› å­ã”ã¨ã®èª¬æ˜</h3>
        <div id="factorNotes" class="factor-mini"><!-- JS --></div>
      </section>

      <div class="hr"></div>
      <div id="longCopy" class="small"><!-- JS é•·æ–‡ã‚³ãƒ¡ãƒ³ãƒˆ --></div>

      <div class="hr"></div>
      <!-- ç ”ç©¶ãƒ¡ãƒ¢ï¼ˆé–‹ã„ãŸçŠ¶æ…‹ã§è¡¨ç¤ºï¼‰ -->
      <details class="section" open>
        <summary><strong>ç ”ç©¶ãƒ¡ãƒ¢ï¼ˆå‚¾å‘ã®ä¸€èˆ¬è«–ï¼‰</strong></summary>
        <ul class="small" id="resMemo" style="margin:6px 0 0 18px;line-height:1.8"><!-- JS --></ul>
        <p class="small" style="margin-top:6px">â€»ã“ã“ã§è¿°ã¹ã‚‹ã®ã¯å¹³å‡çš„ãªå‚¾å‘ã§ã™ã€‚ç›¸é–¢ãŒä¸­å¿ƒã§å› æœã¯æ–­å®šã§ãã¾ã›ã‚“ã€‚å€‹äººå·®ãŒå¤§ãã„ç‚¹ã‚’ã”ç†è§£ãã ã•ã„ã€‚</p>
      </details>

      <div class="back-area" style="margin-top:12px">
        <a class="back" href="/shindan/" id="backLink" aria-label="è¨ºæ–­ä¸€è¦§ã«æˆ»ã‚‹">è¨ºæ–­ä¸€è¦§ã«æˆ»ã‚‹</a>
      </div>
    </div>
  </section>

  <section class="footer card">
    <h2 style="margin:4px 0 8px">ã”åˆ©ç”¨ã«ã‚ãŸã£ã¦</h2>
    <p class="warn"><strong>æ³¨æ„ï¼š</strong>ã“ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯<b>ã‚¨ãƒ³ã‚¿ãƒ¡ç”¨ã®ã‚»ãƒ«ãƒ•ãƒã‚§ãƒƒã‚¯</b>ã§ã™ã€‚åŒ»ç™‚ãƒ»è¨ºæ–­ãƒ»æ²»ç™‚ãƒ»ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°ç­‰ã®ç›®çš„ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚çµæœã®è§£é‡ˆãƒ»åˆ©ç”¨ã¯ã”è‡ªèº«ã®åˆ¤æ–­ã¨è²¬ä»»ã«ã¦ãŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚<br>
è¦‹ãŸç›®ã‚„ä½“ã®ç‰¹å¾´ã‚’è©•ä¾¡ã™ã‚‹æ„å›³ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚<b>æ¸…æ½”æ„Ÿãƒ»æ‰€ä½œãƒ»è¨€è‘‰</b>ãªã©è¡Œå‹•ã§å¤‰ãˆã‚‰ã‚Œã‚‹å´é¢ã«ç„¦ç‚¹ã‚’å½“ã¦ã„ã¾ã™ã€‚<br>
å›ç­”ã¯ç«¯æœ«å†…ã§å‡¦ç†ãƒ»ä¿å­˜ã•ã‚Œã€å›ç­”å†…å®¹ã‚„å€‹äººã‚’ç‰¹å®šã§ãã‚‹æƒ…å ±ã¯ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã•ã‚Œã¾ã›ã‚“ã€‚çµæœè¡¨ç¤ºæ™‚ã«åŒ¿åã®ä»¶æ•°ã‚«ã‚¦ãƒ³ãƒˆã®ã¿é€ä¿¡ã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚</p>
  </section>
</main>

<script>
(function(){
  // ====== ãƒšãƒ¼ã‚¸æƒ…å ± ======
  var SLUG = "charm-planets";
  var TITLE = "æƒ‘æ˜Ÿé­…åŠ›è¨ºæ–­";
  var IMG_BASE = "/shindan/assets/results/charm-planets/"; // æœ«å°¾/
  var ANS_KEY = "specimens:"+SLUG+":answers"; // å›ç­”ä¿å­˜ã‚­ãƒ¼
  var HYBRID_DELTA = 0.12;

  // ====== å…‰åº¦ãƒ©ãƒ³ã‚¯ï¼ˆç·åˆå¹³å‡0â€“4â†’Lv1ã€œLv5ï¼‰ ======
  var GLOW = [
    {lv:1,min:0.00,max:0.79,note:"æ§ãˆã‚ã§ã‚„ã‚ã‚‰ã‹ãªå…‰ã€‚é¦™ã‚Šã¨æ‰€ä½œã‚’æ•´ãˆã‚‹ã ã‘ã§å°è±¡ãŒå®‰å®šã—ã¾ã™ã€‚"},
    {lv:2,min:0.80,max:1.59,note:"ç©ã‚„ã‹ãªå…‰ãŒå¸¸ã«ç‚¹ç¯ã€‚çŸ­ã„â€œé¡Œåã²ã¨è¨€â€ã§è¼ªéƒ­ãŒå‡ºã¦ãã¾ã™ã€‚"},
    {lv:3,min:1.60,max:2.39,note:"å ´é¢ã«å¿œã˜ã¦å…‰ãŒå¢—å¹…ã€‚çµè«–â†’ç†ç”±â†’ä¾‹ã®ä¸‰æ‹å­ã§èª¬å¾—åŠ›UPã€‚"},
    {lv:4,min:2.40,max:3.19,note:"é­…åŠ›ã®æ“ä½œãŒè‡ªç„¶ä½“ã§æ©Ÿèƒ½ã€‚éœ²å‡ºã¯â€œè–„ãé•·ãâ€ãŒåŠ¹æœçš„ã€‚"},
    {lv:5,min:3.20,max:4.00,note:"å­˜åœ¨è‡ªä½“ãŒãƒãƒ­ãƒ¼ã«ãªã‚‹å¸¯ã€‚åˆ¶ç´„ã‚’èª²ã™ã¨ç‹¬è‡ªè‰²ãŒã•ã‚‰ã«éš›ç«‹ã¡ã¾ã™ã€‚"}
  ];
  function glowOf(avg){
    for(var i=0;i<GLOW.length;i++){
      var d=GLOW[i]; if(avg>=d.min && avg<=d.max) return d;
    } return GLOW[2];
  }

  // ====== å› å­ï¼šæƒ‘æ˜Ÿâ†’è¨­å•ID ======
  var FACTORS = {
    SUN:   {name:"å…‰åº¦ï¼ˆå¤ªé™½ï¼‰",   items:[1,2,3]},
    MOON:  {name:"å±…å¿ƒåœ°ï¼ˆæœˆï¼‰",   items:[4,5,6]},
    MERC:  {name:"ä¼šè©±ï¼ˆæ°´æ˜Ÿï¼‰",   items:[7,8,9]},
    VENUS: {name:"ç¾æ„è­˜ï¼ˆé‡‘æ˜Ÿï¼‰", items:[10,11,12]},
    MARS:  {name:"æ¨é€²ï¼ˆç«æ˜Ÿï¼‰",   items:[13,14,15]},
    JUPI:  {name:"ä½™è£•ï¼ˆæœ¨æ˜Ÿï¼‰",   items:[16,17,18]},
    SATURN:{name:"ä¿¡é ¼ï¼ˆåœŸæ˜Ÿï¼‰",   items:[19,20,21]},
    URAN:  {name:"æ„å¤–æ€§ï¼ˆå¤©ç‹æ˜Ÿï¼‰",items:[22,23,24]},
    NEPT:  {name:"é¦™ã‚Š/ä½™éŸ»ï¼ˆæµ·ç‹æ˜Ÿï¼‰",items:[25,26,27]},
    PLUTO: {name:"æ·±åº¦ï¼ˆå†¥ç‹æ˜Ÿï¼‰", items:[28,29,30]},
    EARTH: {name:"å¿ƒã®å®‰å®šï¼ˆåœ°çƒï¼‰", items:[31,32,33]}
  };

  // ====== ç”»åƒãƒ»ãƒ©ãƒ™ãƒ«ãƒ»çŸ­è©•ï¼ˆå°‘ã—é•·ã‚ã«èª¿æ•´ï¼‰ ======
  var PLANETS = {
    SUN:{label:"å¤ªé™½",   img:"01.png", alt:"å¤ªé™½ã®å††ç’°ã¨å…‰æ¡",
         poem:"ä¸­å¿ƒã«æ®ãˆã‚‹æ˜ã‚‹ã•ã€‚ã‚ãªãŸãŒã„ã‚‹ã¨å ´ãŒèµ·å‹•ã™ã‚‹ã€‚",
         copy:"ç¬‘é¡”ã¨ç¬¬ä¸€å£°ã®â€œé¡Œåã²ã¨è¨€â€ã§è¼ªéƒ­ã‚’ä½œã‚‹ã¨ã€å…‰ãŒä¸€æ®µã‚¯ãƒªã‚¢ã«ã€‚å­˜åœ¨æ„Ÿã¯ã€çŸ­ãâ†’é–“â†’å±•é–‹ã€ã®é †ã§ç£¨ã‹ã‚Œã¾ã™ã€‚ãƒ©ã‚¹ãƒˆã¯ç›¸æ‰‹ã®ä¸€èªã‚’æ˜ ã—ã¦ã€å…‰ã‚’æ¸¡ã—ã¦çµ‚ãˆã‚‹ã¨ä½™éŸ»ãŒä¼¸ã³ã¾ã™ã€‚"},
    MOON:{label:"æœˆ",    img:"02.png", alt:"ä¸‰æ—¥æœˆã®ç´‹",
         poem:"æŸ”ã‚‰ã‹ã„è†œã®å®‰å¿ƒã€‚äººã¯ã‚ãªãŸã®ãã°ã§æ·±å‘¼å¸ã§ãã‚‹ã€‚",
         copy:"10ç§’ã®æ²ˆé»™ã‚’å‘³æ–¹ã«ã€æœ€å¾Œã®åè©ã‚’ä¸€èªã§è¿”ã™ã¨â€œå±…å¿ƒåœ°ã®è¨˜æ†¶â€ãŒæ®‹ã‚Šã¾ã™ã€‚éœ²å‡ºã¯å°‘ãªãã¦ã‚‚å°è±¡ã¯é•·æŒã¡ã€‚å¢ƒç•Œã®è¨€è‘‰ï¼ˆä»Šæ—¥ã¯ã“ã“ã¾ã§ï¼‰ã‚’æ·»ãˆã‚‹ã¨ã€å®‰å¿ƒã¯ã•ã‚‰ã«åšãã€‚"},
    MERC:{label:"æ°´æ˜Ÿ",  img:"03.png", alt:"ç¿¼ã¤ãæ–ã®ç´‹",
         poem:"å£°ã¨ç‰©èªã®ç£åŠ›ã€‚è¦ç‚¹ã¨ä½™ç™½ã®é…åˆ†ãŒå·§ã¿ã€‚",
         copy:"â€œçµè«–ãƒ©ãƒ™ãƒ«â†’ç†ç”±â†’ä¸€ä¾‹â€ã®ä¸‰æ‹å­ã§ã€ç‰©èªãŒèµ°ã‚Šã¾ã™ã€‚æåˆ†ã‹ã‚Œã—ãã†ãªã‚‰åè©ã§ç· ã‚ã¦ã‹ã‚‰æ¬¡ã®ç« ã¸ã€‚è¨€ã„æ›ãˆé¡ã‚’ä¸€åº¦ã ã‘ä½¿ã†ã¨ã€ç†è§£ã¨å…±æ„ŸãŒåŒæ™‚ã«ä¸ŠãŒã‚Šã¾ã™ã€‚"},
    VENUS:{label:"é‡‘æ˜Ÿ", img:"04.png", alt:"é‡‘æ˜Ÿã®èŠ±ç´‹",
         poem:"ç¾ã¨æ¸…æ½”æ„Ÿã®èª¬å¾—åŠ›ã€‚æ‰€ä½œãŒé™ã‹ã«æƒ¹ãã¤ã‘ã‚‹ã€‚",
         copy:"é¦™ã‚Šã¯è–„ãé•·ãã€å‹•ãã¯é™ã‹ã«å¤§ããã€‚ç”»è§’ãƒ»å…‰ãƒ»ä¸€ç‚¹ã‚¢ã‚¯ã‚»ãƒ³ãƒˆã®ä¸‰ç‚¹ã§ã€è¦‹ãˆæ–¹ã®å“è³ªã€ã‚’æ•´ãˆã¾ã—ã‚‡ã†ã€‚è³ªæ„Ÿã‚’æ•´ãˆã‚‹â€œæœ€ä½é™ãƒ«ãƒ¼ãƒãƒ³â€ï¼ˆé«ªãƒ»æ‰‹ãƒ»é´ï¼‰ã‚’æ±ºã‚ã‚‹ã¨å®‰å®šã€‚"},
    MARS:{label:"ç«æ˜Ÿ",  img:"05.png", alt:"ç«æ˜Ÿã®æ§ç´‹",
         poem:"é€²ã‚ã‚‹å‹‡æ°—ãŒä¼æŸ“ã™ã‚‹ã€‚æ±ºæ–­ãŒå‘¨ã‚Šã®èƒŒä¸­ã‚’æŠ¼ã™ã€‚",
         copy:"â€œä»Šâ†’æ¬¡ã®ä¸€æ‰‹â†’ç· åˆ‡â€ã®é †ã§æ²ã’ã‚‹ã¨æ¨é€²ãŒä¼æ’­ã€‚å…ˆå»¶ã°ã—ã®ç½ ã«ã¯30åˆ†ã®ç€æ‰‹ã‚¿ã‚¤ãƒãƒ¼ãŒåŠ¹ãã¾ã™ã€‚åˆå›³ã®è¨€è‘‰ï¼ˆã“ã“ã¾ã§ã§OKï¼‰ã‚’ç½®ãã¨ã€å¼·ã•ãŒå„ªã—ã•ã«å¤‰æ›ã•ã‚Œã¾ã™ã€‚"},
    JUPI:{label:"æœ¨æ˜Ÿ",  img:"06.png", alt:"ç‹å† ã¨æ¥¯ã®æœ¨æ˜Ÿç´‹",
         poem:"ä½™è£•ã¨ç¥ç¦ã€‚å¤§ããªæ‡ã§äººãŒä¼¸ã³ã‚‹ã€‚",
         copy:"éç¨‹ã®ç§°è³›ã‚’è¨€èªåŒ–ã—ã€å ´ã®ç©ºæ°—ã‚’ã€ç¥ã†å´ã€ã«èª¿å¾‹ã€‚æ¯”ã¹è¨€è‘‰ã‚ˆã‚Šã‚‚â€œæ˜¨æ—¥æ¯”ã®1æ­©â€ãŒåŠ¹ãã¾ã™ã€‚å¤§ããè¦‹ã›ãšã€é™ã‹ã«å ´ã‚’åºƒã’ã‚‹ã¨ã€å‘¨å›²ã®å®‰å…¨åŸºåœ°ã«ãªã‚Šã¾ã™ã€‚"},
    SATURN:{label:"åœŸæ˜Ÿ",img:"07.png", alt:"ç’°ã®åœŸæ˜Ÿç´‹",
         poem:"ä¿¡é ¼ã®åŸºç›¤ã€‚é ã‘ã‚‰ã‚Œã‚‹å®‰å¿ƒãŒæ¼‚ã†ã€‚",
         copy:"ç· åˆ‡ãƒ»ç´„æŸãƒ»æ—¢èª­è¿”ç­”åŸºæº–ã®â€œä¸‰åŸºæº–â€ã‚’å…ˆã«å®£è¨€ã€‚é€£çµ¡ãŒåˆ‡ã‚Œã‚„ã™ã„æ—¥ã¯ãƒ†ãƒ³ãƒ—ãƒ¬æ–‡ã‚’ç”¨æ„ã™ã‚‹ã¨å®‰å¿ƒã€‚è¦å¾‹ã®è¨€ã„éãã¯ã‚„ã‚ã‚‰ã‹ã•ã§åŒ…ã¿ã€èŠ¯ã‚’è¦‹ã›ã‚‹ã¨å¥½å¾ªç’°ã€‚"},
    URAN:{label:"å¤©ç‹æ˜Ÿ",img:"08.png", alt:"ç¨²å¦»ã®å¤©ç‹æ˜Ÿç´‹",
         poem:"æ–°ã—ã•ã®ç«èŠ±ã€‚æ„å¤–æ€§ã§è¦–ç·šã‚’ã•ã‚‰ã†ã€‚",
         copy:"æ™®æ®µã¯æ•´ç„¶ã€ã“ã“ãã§â€œä¸€ç‚¹ã‚¢ã‚¯ã‚»ãƒ³ãƒˆâ€ã€‚ãƒ¦ãƒ¼ãƒ¢ã‚¢ã§é›°å›²æ°—ã‚’åè»¢ã—ã€ä½™éŸ»ã®è¬ã‚’ä¸€ç²’ã ã‘æ®‹ã—ã¦ã€‚æ—¥å¸¸ã®åœŸå°ã‚’æ•´ãˆã‚‹ã»ã©ã€é–ƒãã®ä¸€æ’ƒã¯ç¾ã—ãæ±ºã¾ã‚Šã¾ã™ã€‚"},
    NEPT:{label:"æµ·ç‹æ˜Ÿ",img:"09.png", alt:"æ³¢ã¨éœ§ã®æµ·ç‹æ˜Ÿç´‹",
         poem:"é¦™ã‚Šã¨ä½™éŸ»ã®é­”æ³•ã€‚å°‘ãªã„éœ²å‡ºã§ã‚‚è¨˜æ†¶ã«æ®‹ã‚‹ã€‚",
         copy:"çµ‚ã‚ã‚Šéš›ã«è§£åƒåº¦ã‚’è½ã¨ã—ã¦ã€ç¶šãã¯æ¬¡å›ã€ã€‚éœ²å‡ºã¯æ§ãˆã‚ã§ã‚‚ã€æ°—é…ã®è¨­è¨ˆã§é•·ãé¦™ã‚Šã¾ã™ã€‚æŠ½è±¡ã¨å…·ä½“ã‚’ä¸€å¾€å¾©ã•ã›ã‚‹ã¨ã€å¤¢è¦‹å¿ƒåœ°ãŒå“ã‚ˆãæŒç¶šã—ã¾ã™ã€‚"},
    PLUTO:{label:"å†¥ç‹æ˜Ÿ",img:"10.png", alt:"æ·±ã„ç’°ã®å†¥ç‹æ˜Ÿç´‹",
         poem:"æ·±ã•ã®å¼•åŠ›ã€‚é™ã‹ã«ç›¸æ‰‹ã®æ ¸å¿ƒã«è§¦ã‚Œã‚‹ã€‚",
         copy:"ä¸€å¯¾ä¸€ã®é™ã‹ãªå ´æ‰€ã§çœŸä¾¡ã€‚è¦–ç·šãƒ»é–“ãƒ»ä½ã„å£°é‡ãŒç£åŠ›ã‚’å¢—ã‚„ã—ã¾ã™ã€‚æ·±æ˜ã‚Šå‰ã«ã€ã“ã“ã¾ã§èã„ã¦ã„ã„ï¼Ÿã€ã¨åˆæ„ã‚’ç½®ãã¨ã€å®‰å¿ƒã¨æ·±åº¦ãŒä¸¡ç«‹ã—ã¾ã™ã€‚"},
    EARTH:{label:"åœ°çƒ", img:"11.png", alt:"é’ã„åœ°çƒã®ç’°",
         poem:"ç²¾ç¥ã®åœ°é¢ãŒå¹³ã‚‰ã€‚æºã‚Œã¦ã‚‚æˆ»ã‚Šã€å‘¨å›²ã«è½ã¡ç€ãã‚’é…ã‚‹ã€‚",
         copy:"åãæ¯ã‚’1æ‹é•·ãã€è©±ã™å‰ã«1ç§’ã®é–“ã€‚æ„Ÿæƒ…ã®æ³¢ãŒç«‹ã£ã¦ã‚‚åŸºæº–ç·šã¸æˆ»ã™â€œå‘¼å¸ã®éŒ˜â€ãŒé­…åŠ›ã®åœŸå°ã§ã™ã€‚å ´ã®æ¸©åº¦ã‚’ä¸€å®šã«ä¿ã¤ã¨ã€ä»–ã®æƒ‘æ˜Ÿã®å…‰ã‚Šæ–¹ã‚‚å®‰å®šã—ã¦æ˜ ãˆã¾ã™ã€‚"}
  };

  // ====== å› å­ã®èª¬æ˜ï¼ˆæ´»ã‹ã—æ–¹/ã‚±ã‚¢ï¼‰ ======
  var FACTOR_DESC = {
    SUN:{title:"å…‰åº¦ï¼ˆå¤ªé™½ï¼‰", use:"æœ€åˆã®ä¸€è¨€ã‚’â€œé¡Œåâ€ã«ç½®ãã€‚", care:"æ³¨ç›®ãŒå¼·ã„æ—¥ã¯ã€è³ªå•â†’ç›¸æ‰‹ã®ä¸€èªè¦ç´„ã€ã§é–“ã‚’ä½œã‚‹ã€‚"},
    MOON:{title:"å±…å¿ƒåœ°ï¼ˆæœˆï¼‰", use:"10ç§’æ²ˆé»™ï¼‹åè©ä¸€èªã§è¿”ã™ã€‚", care:"åŸ‹ã‚ã¦ã—ã¾ã†ç™–ã«ã¯æ·±å‘¼å¸â†’ç›¸æ‰‹ã®æ„Ÿæƒ…èªã‚’ä¸€è¨€ã€‚"},
    MERC:{title:"ä¼šè©±ï¼ˆæ°´æ˜Ÿï¼‰", use:"çµè«–â†’ç†ç”±â†’ä¾‹ã®ä¸‰æ‹å­ã€‚", care:"æåˆ†ã‹ã‚Œã—ãŸã‚‰åè©ã§ç· ã‚ã‚‹ã€‚"},
    VENUS:{title:"ç¾æ„è­˜ï¼ˆé‡‘æ˜Ÿï¼‰", use:"é¦™ã‚Šã¯è–„ãé•·ãï¼æ‰€ä½œã‚’ã‚†ã£ãã‚Šã€‚", care:"â€œé›‘â€ãªæ—¥ç”¨ã®æœ€å°ãƒ«ãƒ¼ãƒãƒ³ï¼ˆé«ªãƒ»æ‰‹ãƒ»é´ï¼‰ã‚’æ±ºã‚ã‚‹ã€‚"},
    MARS:{title:"æ¨é€²ï¼ˆç«æ˜Ÿï¼‰", use:"ä»Šâ†’æ¬¡ã®ä¸€æ‰‹â†’ç· åˆ‡ã‚’æ²ç¤ºã€‚", care:"å…ˆå»¶ã°ã—ã«ã¯â€œ30åˆ†ã ã‘ç€æ‰‹â€ã‚’äºˆç´„ã€‚"},
    JUPI:{title:"ä½™è£•ï¼ˆæœ¨æ˜Ÿï¼‰", use:"éç¨‹ã®ç§°è³›ã‚’è¨€èªåŒ–ã€‚", care:"æ¯”ã¹è¨€è‘‰ã¯å°å°ã—â€œæ˜¨æ—¥æ¯”ã®1æ­©â€ã«ç½®æ›ã€‚"},
    SATURN:{title:"ä¿¡é ¼ï¼ˆåœŸæ˜Ÿï¼‰", use:"ä¸‰åŸºæº–ï¼ˆç· åˆ‡/ç´„æŸ/æ—¢èª­è¿”ç­”ï¼‰ã‚’å®£è¨€ã€‚", care:"å¿™ã—ã„æ—¥ã¯å®šå‹ã®ä¸€æ¬¡è¿”ä¿¡ã§åˆ‡ã‚‰ã•ãªã„ã€‚"},
    URAN:{title:"æ„å¤–æ€§ï¼ˆå¤©ç‹æ˜Ÿï¼‰", use:"ä¸€ç‚¹ã‚¢ã‚¯ã‚»ãƒ³ãƒˆã®æ³•å‰‡ã€‚", care:"å¸¸ç”¨ã¯æ•´ç„¶ã€é–ƒãã¯â€œã“ã“ãâ€ã«é™å®šã€‚"},
    NEPT:{title:"é¦™ã‚Š/ä½™éŸ»ï¼ˆæµ·ç‹æ˜Ÿï¼‰", use:"çµ‚ã‚ã‚Šéš›ã«è¬ã‚’ä¸€ç²’ã€‚", care:"ã•ã‚‰ã‘å‡ºã—éãã¯æ§ãˆã€æŠ½è±¡åº¦ã‚’ä¸Šã’ã‚‹ã€‚"},
    PLUTO:{title:"æ·±åº¦ï¼ˆå†¥ç‹æ˜Ÿï¼‰", use:"é™ã‹ãªå ´æ‰€ï¼‹ä½ãƒœãƒªãƒ¥ãƒ¼ãƒ ã€‚", care:"æ·±æ˜ã‚Šå‰ã«åˆæ„ã¨å¢ƒç•Œç·šã‚’è¨€è‘‰ã«ã€‚"},
    EARTH:{title:"å¿ƒã®å®‰å®šï¼ˆåœ°çƒï¼‰", use:"åãæ¯ã‚’1æ‹é•·ãï¼è©±ã™å‰ã«1ç§’ã®é–“ã€‚", care:"æ„Ÿæƒ…ã®æ³¢ã‚’â€œè¦³ã‚‹â†’åã¥ã‘ã‚‹â†’æˆ»ã‚‹â€ã®3æ‰‹é †ã§æ•´ãˆã‚‹ã€‚"}
  };

  // ====== è¨­å•ï¼ˆ33å•ãƒ»â˜…ã¯rev:trueã§å†…éƒ¨åè»¢ï¼‰ ======
  var ITEMS = [
    // å¤ªé™½ï¼ˆå…‰åº¦ï¼‰
    {id:1,  text:"ç¬‘é¡”ã‚„å£°ã ã‘ã§ã€å ´ã®ç©ºæ°—ãŒæ˜ã‚‹ããªã‚‹."},
    {id:2,  text:"åˆå¯¾é¢ã§ã‚‚ã€è¦–ç·šãŒé›†ã¾ã‚‹ã®ã‚’æ„Ÿã˜ã‚‹ã€‚"},
    {id:3,  text:"æ³¨ç›®ã‚’æµ´ã³ã‚‹ã¨ã™ãèç¸®ã—ã¦ã—ã¾ã†ã€‚", rev:true},

    // æœˆï¼ˆå±…å¿ƒåœ°ï¼‰
    {id:4,  text:"ç›¸æ‰‹ãŒå®‰å¿ƒã—ã¦è©±ã—ç¶šã‘ã‚‹é›°å›²æ°—ãŒå‡ºã‚‹ã€‚"},
    {id:5,  text:"ã¤ã‚‰ã•ã«çŸ­ã„ä¸€è¨€ã§å¯„ã‚Šæ·»ãˆã‚‹ã€‚"},
    {id:6,  text:"æ²ˆé»™ãŒæ€–ãã¦ã™ãåŸ‹ã‚ã¦ã—ã¾ã†ã€‚", rev:true},

    // æ°´æ˜Ÿï¼ˆä¼šè©±ï¼‰
    {id:7,  text:"ç›¸æ‰‹ã®â€œæœ€å¾Œã®åè©â€ã‚’æ‹¾ã£ã¦è¿”ã›ã‚‹ã€‚"},
    {id:8,  text:"å£°ã®æŠ‘æšã‚„ãƒ†ãƒ³ãƒã§æ³¨æ„ã‚’å¼•ãå¯„ã›ã‚‰ã‚Œã‚‹ã€‚"},
    {id:9,  text:"è©±ãŒæåˆ†ã‹ã‚Œã—ã¦çµè«–ãŒè¦‹ãˆã«ãããªã‚‹ã€‚", rev:true},

    // é‡‘æ˜Ÿï¼ˆç¾æ„è­˜ï¼‰
    {id:10, text:"æœãƒ»é«ªãƒ»è‚ŒãŒæ¸…æ½”ã«æ•´ã£ã¦ã„ã‚‹ã¨è¨€ã‚ã‚Œã‚‹ã€‚"},
    {id:11, text:"æ‰€ä½œã‚„ç«‹ã¡å±…æŒ¯ã‚‹èˆã„ãŒç¾ã—ã„ã€‚"},
    {id:12, text:"é¦™ã‚Šã‚„è£…ã„ãŒé›‘ã«ãªã‚‹æ—¥ãŒå¤šã„ã€‚", rev:true},

    // ç«æ˜Ÿï¼ˆæ¨é€²ï¼‰
    {id:13, text:"è¿·ã„ãŒã¡ãªå ´é¢ã§æ–¹å‘ã‚’ç¤ºã›ã‚‹ã€‚"},
    {id:14, text:"æ±ºã‚ãŸã“ã¨ã‚’ã™ãå‹•ãã«å¤‰ãˆã‚‰ã‚Œã‚‹ã€‚"},
    {id:15, text:"äººå‰ã§ã®æ±ºæ–­ã‚’å…ˆå»¶ã°ã—ã«ã—ãŒã¡ã ã€‚", rev:true},

    // æœ¨æ˜Ÿï¼ˆä½™è£•ï¼‰
    {id:16, text:"å°ã•ãªé€²æ­©ã‚’è¦‹ã¤ã‘ã¦ç§°ãˆã‚‰ã‚Œã‚‹ã€‚"},
    {id:17, text:"åˆå¯¾é¢ã§ã‚‚å±…å ´æ‰€ã‚’ä½œã‚‹ãµã‚‹ã¾ã„ãŒã§ãã‚‹ã€‚"},
    {id:18, text:"æ¯”ã¹è¨€è‘‰ï¼ˆã€Œèª°ã‚ˆã‚Šã€ï¼‰ã‚’ä½¿ã„ãŒã¡ã ã€‚", rev:true},

    // åœŸæ˜Ÿï¼ˆä¿¡é ¼ï¼‰
    {id:19, text:"ç´„æŸã‚„æ™‚é–“ã‚’ãã£ã¡ã‚Šå®ˆã‚Œã‚‹ã€‚"},
    {id:20, text:"ä¸€åº¦æ±ºã‚ãŸæ–¹é‡ã‚’ã¶ã‚‰ã•ãšç¶šã‘ã‚‰ã‚Œã‚‹ã€‚"},
    {id:21, text:"å¿™ã—ã„ã¨é€£çµ¡ãŒé€”åˆ‡ã‚Œã‚„ã™ã„ã€‚", rev:true},

    // å¤©ç‹æ˜Ÿï¼ˆæ„å¤–æ€§ï¼‰
    {id:22, text:"ãµã ã‚“ã¨é•ã†â€œä¸€ç‚¹ã®ã‚¢ã‚¯ã‚»ãƒ³ãƒˆâ€ã§å°è±¡ã‚’æ®‹ã›ã‚‹ã€‚"},
    {id:23, text:"ãƒ¦ãƒ¼ãƒ¢ã‚¢ã‚„æ¯”å–©ã§é›°å›²æ°—ã‚’åè»¢ã§ãã‚‹ã€‚"},
    {id:24, text:"ã„ã¤ã‚‚åŒã˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ãªã£ã¦ã—ã¾ã†ã€‚", rev:true},

    // æµ·ç‹æ˜Ÿï¼ˆé¦™ã‚Š/ä½™éŸ»ï¼‰
    {id:25, text:"ãµã¨è¿‘ã¥ã„ãŸæ™‚ã®é¦™ã‚Šã‚„æ°—é…ã§å°è±¡ãŒæ®‹ã‚‹ã€‚"},
    {id:26, text:"å†™çœŸã‚„æŠ•ç¨¿ãŒå°‘ãªãã¦ã‚‚è¨˜æ†¶ã«æ®‹ã‚‹ã€‚"},
    {id:27, text:"æ€ã„ã¤ãã¾ã¾å…¨éƒ¨ã•ã‚‰ã™ã“ã¨ãŒå¤šã„ã€‚", rev:true},

    // å†¥ç‹æ˜Ÿï¼ˆæ·±åº¦ï¼‰
    {id:28, text:"ç›®ç·šã‚„é–“ã§å¼•ãè¾¼ã‚€åŠ›ãŒã‚ã‚‹ã¨è¨€ã‚ã‚Œã‚‹ã€‚"},
    {id:29, text:"ä¸€å¯¾ä¸€ã§ã¯è©±ãŒæ·±ããªã‚‹ã“ã¨ãŒå¤šã„ã€‚"},
    {id:30, text:"æ ¸å¿ƒã«è§¦ã‚Œã‚‹å‰ã«æµ…ãçµ‚ã‚ã‚ŠãŒã¡ã ã€‚", rev:true},

    // åœ°çƒï¼ˆå¿ƒã®å®‰å®šï¼‰
    {id:31, text:"ç·Šå¼µã®å ´ã§ã‚‚å‘¼å¸ã¨å£°ãŒè½ã¡ç€ã„ã¦ã„ã‚‹ã¨è¨€ã‚ã‚Œã‚‹ã€‚"},
    {id:32, text:"å¿ƒãŒæºã‚Œã¦ã‚‚ã€çŸ­æ™‚é–“ã§åŸºæº–ç·šã«æˆ»ã‚Œã‚‹ã€‚"},
    {id:33, text:"æ°—åˆ†ã®æ³¢ãŒå¼·ãã€å‘¨ã‚Šã®ç©ºæ°—ã‚’å·»ãè¾¼ã¿ãŒã¡ã ã€‚", rev:true}
  ];
  var LABELS = ["ã¾ã£ãŸããªã„","ã‚ã¾ã‚Šãªã„","åŠã€…","ã ã„ãŸã„","ã¨ã¦ã‚‚"];

  // ====== è¦ç´ å‚ç…§ ======
  var qWrap   = document.getElementById("qWrap");
  var prog    = document.getElementById("prog");
  var resEmpty= document.getElementById("resEmpty");
  var resArea = document.getElementById("resArea");
  var typeLine= document.getElementById("typeLine");
  var heroImg = document.getElementById("heroImg");
  var heroTitle= document.getElementById("heroTitle");
  var heroPoem = document.getElementById("heroPoem");
  var heroCopy = document.getElementById("heroCopy");
  var sizeBadgeEl= document.getElementById("sizeBadge");
  var sumAvg  = document.getElementById("sumAvg");
  var sumNote = document.getElementById("sumNote");
  var guardArea = document.getElementById("guardArea");
  var bars    = document.getElementById("bars");
  var longCopy= document.getElementById("longCopy");
  var resMemo = document.getElementById("resMemo");

  // ====== ä¿å­˜ ======
  function saveAnswers(){
    try{
      var out = {};
      for(var i=0;i<ITEMS.length;i++){
        var id = ITEMS[i].id;
        var chk = qWrap.querySelector('#fs-'+id+' input[type="radio"]:checked');
        if(chk){ out[id] = parseInt(chk.value,10); }
      }
      localStorage.setItem(ANS_KEY, JSON.stringify({ts:Date.now(), ans:out}));
    }catch(e){}
  }
  function restoreAnswers(){
    try{
      var raw = localStorage.getItem(ANS_KEY);
      if(!raw) return;
      var data = JSON.parse(raw);
      var ans = (data && data.ans) || {};
      Object.keys(ans).forEach(function(id){
        var v = ans[id];
        var input = qWrap.querySelector('#q'+id+'-'+v);
        if(input){ input.checked = true; }
      });
      updateProgress();
    }catch(e){}
  }
  function wipeAnswers(){
    try{ localStorage.removeItem(ANS_KEY); }catch(e){}
  }

  // ====== è¨­å•ç”Ÿæˆï¼ˆç•ªå·ã¯UIã«å‡ºã•ãªã„ï¼é€†è»¢ãƒ•ãƒ©ã‚°ã¯UIéè¡¨ç¤ºï¼‰ ======
  function buildQuestions(){
    var html = "";
    for(var i=0;i<ITEMS.length;i++){
      var q = ITEMS[i];
      html += '<fieldset class="q" id="fs-'+q.id+'">'+
        '<legend>'+q.text+'</legend>'+
        '<div class="scale" role="radiogroup" aria-label="'+q.text+'">';
      for(var v=0;v<=4;v++){
        html += '<div style="position:relative">'+
          '<input id="q'+q.id+'-'+v+'" type="radio" name="q'+q.id+'" value="'+v+'">'+
          '<label for="q'+q.id+'-'+v+'" title="'+LABELS[v]+'">'+LABELS[v]+'</label>'+
        '</div>';
      }
      html += '</div></fieldset>';
    }
    qWrap.innerHTML = html;

    var radios = qWrap.querySelectorAll('input[type="radio"]');
    for(var r=0;r<radios.length;r++){
      radios[r].addEventListener('change', function(){
        saveAnswers();
        updateProgress();
      }, false);
    }
    restoreAnswers();
  }

  function updateProgress(){
    var total = ITEMS.length;
    var answered = qWrap.querySelectorAll('input[type="radio"]:checked').length;
    prog.style.width = Math.round(100*answered/total) + "%";
  }

  // ====== ã‚¹ã‚³ã‚¢è¨ˆç®— ======
  function score(){
    var missing = [];
    var ans = {};
    for(var i=0;i<ITEMS.length;i++){
      var def = ITEMS[i];
      var id = def.id;
      var chk = qWrap.querySelector('#fs-'+id+' input[type="radio"]:checked');
      if(!chk){ missing.push(id); continue; }
      var raw = parseInt(chk.value,10);
      var val = def.rev ? (4 - raw) : raw; // å†…éƒ¨ã§åè»¢
      ans[id] = val;
    }
    if(missing.length){
      alert("æœªå›ç­”ãŒã‚ã‚Šã¾ã™ã€‚å…¨33å•ã«ãŠç­”ãˆãã ã•ã„ã€‚");
      var fs = document.getElementById('fs-'+missing[0]);
      if(fs){ fs.scrollIntoView({behavior:"smooth", block:"center"}); fs.classList.add("need"); setTimeout(function(){ fs.classList.remove("need"); },1600); }
      return;
    }

    // å› å­ã”ã¨ã®å¹³å‡(0-4)ã¨%ã«æ›ç®—ï¼ˆ11å› å­ï¼‰
    var fScore = {};
    Object.keys(FACTORS).forEach(function(key){
      var ids = FACTORS[key].items;
      var sum = ids.reduce(function(s,id){ return s + (ans[id]||0); },0);
      var avg = sum / ids.length; // 0-4
      var pct = Math.round((avg/4)*100);
      fScore[key] = {avg:avg, pct:pct};
    });

    // ç·åˆå¹³å‡ï¼ˆ11å› å­å¹³å‡ï¼‰
    var avgTotal = Object.values(fScore).reduce(function(s,o){ return s+o.avg; },0) / Object.keys(FACTORS).length;
    avgTotal = Math.round(avgTotal*100)/100;

    render({avg:avgTotal, fScore:fScore});
  }

  // ====== è¡¨ç¤º ======
  function render(o){
    // ä¸»æƒ‘æ˜Ÿï¼†ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰
    var sorted = Object.keys(FACTORS).map(function(k){
      return {key:k, name:FACTORS[k].name, avg:o.fScore[k].avg};
    }).sort(function(a,b){ return b.avg - a.avg; });

    var top1 = sorted[0], top2 = sorted[1];
    var isHybrid = Math.abs(top1.avg - top2.avg) <= HYBRID_DELTA;

    var p1 = PLANETS[top1.key], p2 = PLANETS[top2.key];

    // ç”»åƒãƒ»ã‚¿ã‚¤ãƒˆãƒ«
    heroImg.src = IMG_BASE + p1.img;
    heroImg.alt = p1.alt;
    heroTitle.textContent = isHybrid
      ? "ä¸»æƒ‘æ˜Ÿã‚¿ã‚¤ãƒ—ï¼š"+p1.label+" Ã— "+p2.label+"ï¼ˆäºŒé‡æƒ‘æ˜Ÿï¼‰"
      : "ä¸»æƒ‘æ˜Ÿã‚¿ã‚¤ãƒ—ï¼š"+p1.label;

    // è©©ãƒ»çŸ­è©•ï¼ˆå°‘ã—é•·ã‚ï¼‰
    if(isHybrid){
      heroPoem.textContent = p1.poem.replace(/ã€‚$/,"") + "ï¼" + p2.poem;
      heroCopy.textContent = p1.copy + " ã¾ãŸã€" + p2.copy;
    }else{
      heroPoem.textContent = p1.poem;
      heroCopy.textContent = p1.copy;
    }

    // ç·åˆå…‰åº¦ï¼†ãƒ©ãƒ³ã‚¯
    var glow = glowOf(o.avg);
    sizeBadgeEl.textContent = "ç·åˆå…‰åº¦ " + o.avg.toFixed(2) + " / 4.00ï¼ˆLv"+glow.lv+"ï¼‰";
    sumAvg.textContent = o.avg.toFixed(2);
    sumNote.textContent = glow.note;

    // æƒ‘æ˜Ÿãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ï¼ˆä¸€è¦§ï¼‰
    var gHtml = "";
    Object.keys(PLANETS).forEach(function(k){
      var lab = PLANETS[k].label;
      var nm  = FACTORS[k].name;
      gHtml += '<div class="guard"><div class="g-emo" aria-hidden="true">ğŸª</div>'+
               '<div><div><strong>'+lab+'</strong> <span class="small">ï¼ˆ'+nm+'ï¼‰</span></div>'+
               '<div class="small" style="opacity:.9">'+PLANETS[k].poem+'</div></div></div>';
    });
    guardArea.innerHTML = gHtml;

    // å› å­ãƒãƒ¼
    var bHtml = "";
    Object.keys(FACTORS).forEach(function(k){
      var nm = FACTORS[k].name, sc = o.fScore[k];
      bHtml += '<article class="bar" aria-label="'+nm+'">'+
        '<div><strong>'+nm+'</strong>'+
        '<span class="pill" style="margin-left:6px">'+sc.avg.toFixed(2)+' / 4</span>'+
        '<span class="pill" style="margin-left:6px">'+sc.pct+'%</span></div>'+
        '<div class="row" aria-hidden="true"><span style="width:'+sc.pct+'%"></span></div>'+
      '</article>';
    });
    bars.innerHTML = bHtml;

    // å› å­èª¬æ˜
    var notes = "";
    Object.keys(FACTORS).forEach(function(k){
      var nm = FACTORS[k].name, sc = o.fScore[k], d = FACTOR_DESC[k];
      notes += '<article class="note" aria-label="'+nm+'ã®èª¬æ˜">'+
        '<h4>'+d.title+'<span class="mini">å¹³å‡ '+sc.avg.toFixed(2)+' / 4ï½œ'+sc.pct+'%</span></h4>'+
        '<p>'+PLANETS[k].poem+'</p>'+
        '<p><strong>æ´»ã‹ã—æ–¹ï¼š</strong>'+d.use+'</p>'+
        '<p><strong>ã‚±ã‚¢ï¼š</strong>'+d.care+'</p>'+
      '</article>';
    });
    document.getElementById("factorNotes").innerHTML = notes;

    // é•·æ–‡ï¼ˆä¸»æƒ‘æ˜Ÿä¸­å¿ƒï¼‰
    var long = (isHybrid
      ? "ã€äºŒé‡æƒ‘æ˜Ÿã€‘"+p1.label+"Ã—"+p2.label+"ã€‚äºŒã¤ã®å…‰ã‚Šæ–¹ãŒé‡ãªã‚‹å¸¯ã§ã™ã€‚å ´é¢ã«å¿œã˜ã¦â€œã©ã¡ã‚‰ã‚’å…ˆã«ç«‹ã¦ã‚‹ã‹â€ã‚’é¸ã¶ã¨ã€é­…åŠ›ãŒéä¸è¶³ãªãä¼ã‚ã‚Šã¾ã™ã€‚ã¨ãã«é–‹å§‹ã®åˆå›³ã¨çµ‚ã‚ã‚Šéš›ã®ä½™éŸ»ã‚’æ„å›³ã—ã¦åˆ‡ã‚Šæ›¿ãˆã‚‹ã¨ã€å°è±¡ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆãŒç¾ã—ãæ®‹ã‚Šã¾ã™ã€‚"
      : "ã€ä¸»æƒ‘æ˜Ÿï¼š"+p1.label+"ã€‘ãã®ã¾ã¾ã§ã‚‚é­…åŠ›ã¯å‡ºã¦ã„ã¾ã™ã€‚æ„è­˜ã—ã¦ã€å§‹ã¾ã‚Šã®åˆå›³â†’ä¸»å½¹ã®è¦ç´ â†’çµ‚ã‚ã‚Šéš›ã®ä½™éŸ»ã€ã®ä¸‰æ®µã§è¨­è¨ˆã™ã‚‹ã¨ã€å…‰ãŒå®‰å®šã—ã¦å±Šãã¾ã™ã€‚å¼±ç‚¹è£œå¼·ã¯â€œå®‰å…¨ç­–ã®ãƒ†ãƒ³ãƒ—ãƒ¬â€ã«ç•™ã‚ã€ä¸»æ­¦å™¨ã®ç£¨ãè¾¼ã¿ã«æŠ•è³‡ã™ã‚‹ã¨å›åãŒæ—©ã„å¸¯ã§ã™ã€‚"
    );
    longCopy.textContent = long;

    // ç ”ç©¶ãƒ¡ãƒ¢
    var memo = [
      "ãƒ»â€œé­…åŠ›â€ã¯å¤šé¢çš„ãªçŸ¥è¦šï¼ˆæ¸…æ½”æ„Ÿãƒ»æ‰€ä½œãƒ»è¨€è‘‰ãƒ»é–“ãƒ»é¦™ã‚Šãƒ»è¦–ç·šãƒ»å ´ã®è¨­è¨ˆãªã©ï¼‰ã®é‡ã­åˆã‚ã›ã¨ã—ã¦æ‰±ãˆã¾ã™ã€‚",
      "ãƒ»éœ²å‡ºé‡ã‚ˆã‚Šâ€œè³ªâ€ãŒå°è±¡ã®æŒç¶šã«å¯„ä¸ã™ã‚‹å ´é¢ãŒã‚ã‚Šã€å°‘ãªã„ç™ºä¿¡ã§ã‚‚ä½™éŸ»ã‚„ç‰©èªè¨­è¨ˆã§è¨˜æ†¶ã«æ®‹ã‚Šã‚„ã™ã„ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚",
      "ãƒ»éè¨€èªï¼ˆå§¿å‹¢ãƒ»å£°ã®æŠ‘æšãƒ»æ²ˆé»™ï¼‰ã¨çŸ­ã„ãƒ©ãƒ™ãƒ«è¨€èªã®ä½µç”¨ãŒã€å­˜åœ¨æ„Ÿã‚„ç†è§£åº¦ã®å‘ä¸Šã«é–¢é€£ã™ã‚‹ç¤ºå”†ãŒè¤‡æ•°ã‚ã‚Šã¾ã™ã€‚",
      "ãƒ»æ•´ãˆã‚„ã™ã„é †ã§è¨€ãˆã°ã€é«ªãƒ»æ‰‹ãƒ»é´â†’ç”»è§’ã¨å…‰â†’é¦™ã‚Šã¯è–„ãé•·ãâ†’è©±ã®ä¸‰æ‹å­ï¼ˆçµè«–â†’ç†ç”±â†’ä¾‹ï¼‰ã€ã€‚",
      "ãƒ»å¼·ã¿å¢—å¹…ã¨åŒæ™‚ã«â€œæ­¢ã¾ã‚‹ä»•çµ„ã¿â€ï¼ˆè¿”ä¿¡ãƒ†ãƒ³ãƒ—ãƒ¬ã€å…¬é–‹å‰ãƒã‚§ãƒƒã‚¯ï¼‰ã‚’ç½®ãã¨ã€æš´èµ°ã‚„éå‰°éœ²å‡ºã‚’æŠ‘åˆ¶ã§ãã¾ã™ã€‚",
      "ãƒ»ã“ã“ã§ã®åˆ†é¡ã¯æ¯”å–©ãƒ¢ãƒ‡ãƒ«ã§ã™ã€‚æ€§åˆ¥ãƒ»å¹´é½¢ãƒ»å®¹å§¿ã¨ã„ã£ãŸå…ˆå¤©çš„è¦å› ã‚ˆã‚Šã€â€œè¡Œå‹•ã§å¤‰ãˆã‚‰ã‚Œã‚‹å´é¢â€ã‚’é‡è¦–ã—ã¦ã„ã¾ã™ã€‚"
    ];
    resMemo.innerHTML = memo.map(function(s){ return "<li>"+s+"</li>"; }).join("");

    // è¡¨ç¤ºåˆ‡æ›¿
    resEmpty.style.display = "none";
    resArea.style.display = "block";
    document.getElementById("result").scrollIntoView({behavior:"smooth", block:"start"});

    // ä¸€è¦§ã€Œã¤ã¥ãã‹ã‚‰å†é–‹ã€
    try{
      document.dispatchEvent(new Event('result:ready'));
      localStorage.setItem("specimens:last", JSON.stringify({ id: SLUG, title: TITLE, href: location.pathname }));
    }catch(e){}
  }

  function clearAnswers(){
    var radios = qWrap.querySelectorAll('input[type="radio"]');
    for(var i=0;i<radios.length;i++){ radios[i].checked=false; }
    wipeAnswers();
    prog.style.width = "0%";
    resEmpty.style.display = "";
    resArea.style.display = "none";
    var app = document.getElementById("app");
    if(app){ app.scrollIntoView({behavior:"smooth", block:"start"}); }
  }

  // ====== åˆæœŸåŒ– ======
  if(document.readyState === "loading"){
    document.addEventListener("DOMContentLoaded", function(){ buildQuestions(); });
  }else{
    buildQuestions();
  }
  document.getElementById("doScore").addEventListener("click", score, false);
  document.getElementById("doScore2").addEventListener("click", score, false);
  document.getElementById("clearAns").addEventListener("click", clearAnswers, false);
  var back = document.getElementById("backLink");
  if(back){
    back.addEventListener("click", function(){
      try{
        document.dispatchEvent(new Event('result:ready'));
      localStorage.setItem("specimens:last", JSON.stringify({ id: SLUG, title: TITLE, href: location.pathname }));
      }catch(e){}
    }, false);
  }
})();
</script>
<script>
/* ã“ã“ã‚Lv/æ¸ˆã‚«ã‚¦ãƒ³ãƒˆï¼ˆçµæœæç”»ã®åˆå›³ã§ä¸€åº¦ã ã‘ï¼‰ */
(function(){
  'use strict';
  var DONE_KEY    = 'specimens:open:byid';         // æ¸ˆãƒãƒƒãƒ—
  var TOTAL_KEY   = 'specimens:open:total';        // ã‚ãªãŸã®ã“ã“ã‚Lvï¼ˆåˆè¨ˆï¼‰
  var GLOBAL_LAST = 'specimens:open:global:last';  // ä¸€è¦§ã®åˆæœŸè¡¨ç¤ºã‚­ãƒ£ãƒƒã‚·ãƒ¥
  var MY_ID = (document.body && document.body.getAttribute('data-id')) || 'unknown';

  // ã¿ã‚“ãªã®Lvï¼ˆCountAPIï¼‰
  var COUNTAPI_NS  = 'haisuikounozarigani_shindan';
  var COUNTAPI_KEY = 'specimens_open_total';
  function hitEveryone(){
    var url = 'https://api.countapi.xyz/hit/'+COUNTAPI_NS+'/'+COUNTAPI_KEY;
    if(navigator.sendBeacon){ try{ navigator.sendBeacon(url); }catch(_){ } }
    else{ fetch(url, {mode:'cors', cache:'no-store', keepalive:true}).catch(function(){}); }
  }

  var marked = false;
  function markOnce(){
    if(marked) return; marked = true;
    try{
      // ã‚ãªãŸã®Lv +1
      localStorage.setItem(TOTAL_KEY, String((+localStorage.getItem(TOTAL_KEY) || 0) + 1));
      // æ¸ˆãƒãƒƒãƒ— +1
      var map={}; try{ map = JSON.parse(localStorage.getItem(DONE_KEY) || '{}'); }catch(_){}
      map[MY_ID] = (map[MY_ID] || 0) + 1;
      localStorage.setItem(DONE_KEY, JSON.stringify(Object.assign({}, map, {_ts: Date.now()})));
      // ã¿ã‚“ãªã®Lv +1 ã¨è¦‹æ „ãˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ +1
      hitEveryone();
      try{ localStorage.setItem(GLOBAL_LAST, String((+localStorage.getItem(GLOBAL_LAST) || 0) + 1)); }catch(_){}
    }catch(_){}
  }

  // çµæœæç”»ã®åˆå›³ã§åŠ ç®—ã€ä¿é™ºã§2ç§’å¾Œã«ã‚‚ä¸€åº¦ã ã‘
  document.addEventListener('result:ready', markOnce);
  setTimeout(markOnce, 2000);
})();
</script>
</body>
</html>