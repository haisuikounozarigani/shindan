<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ãƒŠãƒ«ã‚·ã‚¹ãƒˆ6ã‚¿ã‚¤ãƒ—è¨ºæ–­ï½œ6ç¾½ã®é³¥ã§è¦‹ã‚‹â€œå‰ã«å‡ºã‚‹é¡”â€</title>
<meta name="description" content="ã‚¹ã‚ºãƒ¡ãƒ»ãƒãƒˆãƒ»ã‚¯ã‚¸ãƒ£ã‚¯ãƒ»ã‚ªã‚¦ãƒ ãƒ»ãƒ¯ã‚·ãƒ»ãƒ•ã‚¯ãƒ­ã‚¦ã®6ç¾½ã®é³¥ã‚’ãƒ¢ãƒãƒ¼ãƒ•ã«ã€24å•ã§ã‚ãªãŸã®â€œå‰ã«å‡ºã‚‹é¡”ï¼ˆãƒŠãƒ«ã‚·ã‚¹ãƒˆ6ã‚¿ã‚¤ãƒ—ï¼‰â€ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚">
<meta name="theme-color" content="#fff7fd">
<!-- OG -->
<meta property="og:type" content="website">
<meta property="og:title" content="ãƒŠãƒ«ã‚·ã‚¹ãƒˆ6ã‚¿ã‚¤ãƒ—è¨ºæ–­">
<meta property="og:description" content="6ç¾½ã®é³¥ãƒ¢ãƒãƒ¼ãƒ•ï¼ˆã‚¹ã‚ºãƒ¡ï¼ãƒãƒˆï¼ã‚¯ã‚¸ãƒ£ã‚¯ï¼ã‚ªã‚¦ãƒ ï¼ãƒ¯ã‚·ï¼ãƒ•ã‚¯ãƒ­ã‚¦ï¼‰ã‹ã‚‰ã€ä»Šæ—¥ã„ã¡ã°ã‚“å¼·ã„ãƒŠãƒ«ã‚·ã‚¹ãƒˆé¡”ã‚’åˆ¤å®šã€‚å› å­ãƒãƒ¼ã¨ãƒŸãƒ‹ä¸€æ­©ã¤ãã€‚">
<meta property="og:url" content="https://haisuikounozarigani.github.io/shindan/narcissist-six.html">
<meta property="og:image" content="https://haisuikounozarigani.github.io/shindan/assets/results/narcissist-six/t00.webp">
<style>
  :root{
    --bg:#fdf7ff; --paper:#fff; --ink:#201322; --muted:#6a5b70; --line:#ece3f5;
    --accent:#8c6bff; /* hot */ --accent2:#ff8fc7; /* duo */
  }
  html,body{
    margin:0;padding:0;
    background:var(--bg);
    color:var(--ink);
    font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Noto Sans JP","Hiragino Sans","Hiragino Kaku Gothic ProN","Yu Gothic",Meiryo,sans-serif;
  }
  a{color:#5b2ea8;text-decoration:none}
  .wrap{max-width:980px;margin:0 auto;padding:16px}
  header.hd{
    background:linear-gradient(160deg,#fff7fd,#f3ecff);
    border-bottom:1px solid var(--line);
  }
  header.hd .wrap{padding:20px 16px 10px}
  .ttl{font-weight:800;font-size:1.35rem;letter-spacing:.02em}
  .sub{color:var(--muted);font-size:.95rem}

  /* å›ºå®šé€²æ—ï¼ˆnohæº–æ‹ ï¼‰ */
  .progress-fixed{position:sticky;top:0;z-index:20;height:8px;background:var(--line)}
  .progress-bar{height:100%;border-radius:6px;background:linear-gradient(90deg,var(--accent),var(--accent2));transition:width .2s ease}
  [role="progressbar"]{width:100%}

  figure.hero{
    margin:12px 0;
    border:1px solid var(--line);
    border-radius:16px;
    overflow:hidden;
    background:#fff;
  }
  figure.hero img{display:block;width:100%;height:auto}

  .paper{
    background:var(--paper);
    border:1px solid var(--line);
    border-radius:16px;
    padding:16px;
    margin:14px 0;
  }

  /* ãƒ—ãƒ­ãƒ­ãƒ¼ã‚° */
  #prologue h2{
    margin-top:0;
    font-size:1.1rem;
  }
  #prologue p{
    margin:.4rem 0;
  }
  .start-btn{
    margin-top:12px;
    width:100%;
    padding:12px 16px;
    border-radius:999px;
    border:1px solid var(--accent);
    background:linear-gradient(135deg,var(--accent),var(--accent2));
    color:#fff;
    font-weight:700;
    letter-spacing:.03em;
    cursor:pointer;
    box-shadow:0 4px 10px rgba(0,0,0,.08);
    display:inline-flex;
    align-items:center;
    justify-content:center;
    gap:6px;
  }
  .start-btn span.emo{font-size:1.2rem}

  .qnum{font-weight:700;color:#4c2b5f}
  .qtext{margin:.4rem 0 1rem}
  .opts{display:grid;grid-template-columns:1fr;gap:8px}
  .btn{
    display:flex;align-items:center;justify-content:space-between;
    gap:12px;
    padding:12px 14px;
    border:1px solid var(--line);
    border-radius:12px;
    background:#fff;
    cursor:pointer;
    transition:.12s;
  }
  .btn[aria-pressed="true"]{outline:2px solid var(--accent2);background:#fff4fa}
  .btn:hover{transform:translateY(-1px)}
  .opt-note{color:#8b7b93;font-size:.9rem}
  .ctrls{display:flex;gap:8px;margin-top:12px}
  .ctrls button{
    padding:10px 14px;
    border-radius:10px;
    border:1px solid var(--line);
    background:#faf5ff;
    cursor:pointer;
  }
  .ctrls button.primary{
    background:#4c2b5f;
    color:#fff;
    border-color:#4c2b5f;
  }

  .result{display:none}
  .rank{
    display:inline-block;
    padding:.2em .6em;
    border-radius:999px;
    background:#f3e9ff;
    color:#4b266e;
    font-weight:700;
    margin-left:.4em;
  }
  .flex{display:flex;gap:16px;flex-wrap:wrap}
  .result .imgbox{flex:1 1 280px;min-width:260px}
  .result .imgbox img{
    width:100%;height:auto;
    border-radius:14px;
    border:1px solid var(--line);
    display:block;
  }
  .result .text{flex:2 1 360px;min-width:300px}
  .bars{display:grid;grid-template-columns:1fr;gap:10px;margin-top:10px}
  .bar{
    background:#f9f2ff;
    border:1px solid var(--line);
    border-radius:10px;
    overflow:hidden;
  }
  .bar .h{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:6px 10px;
    font-size:.92rem;
  }
  .bar .b{
    height:10px;
    background:linear-gradient(90deg,var(--accent),var(--accent2));
    width:0%;
  }
  .meta{color:#7a6c86;font-size:.92rem}
  .back{
    display:inline-block;
    margin:10px 0 20px;
    padding:10px 14px;
    border-radius:10px;
    border:1px solid var(--line);
    background:#faf5ff;
  }

  .mini-toast{
    position:fixed;
    left:50%;bottom:24px;
    transform:translateX(-50%) translateY(20px);
    opacity:0;
    background:#4c2b5f;
    color:#fff;
    padding:8px 12px;
    border-radius:999px;
    font-size:.9rem;
    transition:.25s;
    z-index:40;
  }
  .mini-toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

  /* å‰å›å›ç­”ï¼šã‚¹ãƒãƒ›è¦–èªæ€§UP */
  .prev-list{list-style:none;padding-left:0;margin:.4rem 0 .2rem .9rem}
  .prev-item{
    display:flex;
    gap:8px;
    align-items:flex-start;
    padding:6px 0;
    border-bottom:1px solid var(--line);
  }
  .prev-q{
    flex:1;min-width:0;
    display:-webkit-box;
    -webkit-box-orient:vertical;
    -webkit-line-clamp:2;
    overflow:hidden;
    overflow-wrap:anywhere;
  }
  .prev-a{
    flex:0 0 auto;
    white-space:nowrap;
    border:1px solid var(--line);
    border-radius:999px;
    padding:2px 8px;
    font-size:.9rem;
    background:#faf5ff;
  }
</style>
</head>

<body data-id="narcissist-six">
<header class="hd" role="banner">
  <div class="wrap">
    <div class="ttl">ãƒŠãƒ«ã‚·ã‚¹ãƒˆ6ã‚¿ã‚¤ãƒ—è¨ºæ–­ <span class="rank" aria-label="ã‚¿ã‚¤ãƒ—">â€”</span></div>
    <div class="sub">
      6ç¾½ã®é³¥ã«ãªãã‚‰ãˆã¦ã€ã€Œã¤ã„å‰ã«å‡ºã¡ã‚ƒã†é¡”ã€ã‚’ã“ã£ãã‚Šç¢ºèªã™ã‚‹ãƒ†ã‚¹ãƒˆã§ã™ã€‚
    </div>
  </div>
</header>

<!-- å›ºå®šé€²æ—ãƒãƒ¼ -->
<div class="progress-fixed" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
  <div class="progress-bar" style="width:0%"></div>
</div>

<main class="wrap" id="app" role="main" aria-live="polite">
  <!-- ãƒ’ãƒ¼ãƒ­ãƒ¼ï¼šAviary of mirrors -->
  <figure class="hero">
    <img src="/shindan/assets/results/narcissist-six/t00.webp" alt="é³¥ã®ç¾½ç¯ã‚‹å›å»Š" loading="lazy">
  </figure>

  <!-- ãƒ—ãƒ­ãƒ­ãƒ¼ã‚° -->
  <section id="prologue" class="paper" aria-label="ãƒ—ãƒ­ãƒ­ãƒ¼ã‚°">
    <h2>ãƒ—ãƒ­ãƒ­ãƒ¼ã‚°ï¼šå…­ç¾½ãŒä½ã‚€é¡ã®é³¥å°å±‹</h2>
    <p>
      è‡ªæ’®ã‚ŠãŒã†ã¾ãæ±ºã¾ã£ãŸã¨ãã€æ­¦å‹‡ä¼ã‚’è©±ã—ãŸããªã£ãŸã¨ãã€
      ã€Œãã‚Œã¯è‰¯ããªã„ã€ã¨ã¤ã„èª¬æ•™ãƒ¢ãƒ¼ãƒ‰ã«ãªã‚‹ã¨ãã€‚
      ãã®ãŸã³ã«ã€å¿ƒã®é³¥å°å±‹ã§ã¯å…­ç¾½ã®é³¥ãŒãƒã‚¿ãƒã‚¿ã¨é¨’ã„ã§ã„ã‚‹ã€‚
    </p>
    <p>
      ç›®ç«‹ã¡ãŸãŒã‚Šã®ã‚ªã‚¦ãƒ ã€å®ˆã‚‰ã‚ŒãŸã„ã‚¹ã‚ºãƒ¡ã€è‰²æ°—æ‹…å½“ã®ã‚¯ã‚¸ãƒ£ã‚¯ã€
      æ­£ã—ã•å¤§å¥½ããªãƒãƒˆã€ä»•åˆ‡ã‚ŠãŸãŒã‚Šã®ãƒ¯ã‚·ã€è·é›¢æ„Ÿãƒ—ãƒ­ã®ãƒ•ã‚¯ãƒ­ã‚¦ã€‚
      ã©ã®é³¥ã‚‚ã€ã¡ã‚‡ã£ã¨éå‰°ã§ã€ã¡ã‚‡ã£ã¨æ„›ãŠã—ã„ã€ŒãƒŠãƒ«ã‚·ã‚¹ãƒˆã®é¡”ã€ã ã€‚
    </p>
    <p>
      ã“ã®è¨ºæ–­ã¯ã€24å•ã®è³ªå•ã§ã€ã€Œã„ã¾ä¸€ç•ªå‰ã«å‡ºã¦ã„ã‚‹é³¥ã€ã‚’ãã£ã¨æŒ‡ã•ã—ã¦ãã‚Œã‚‹ã€
      å°ã•ãªè¦‹ä¸–ç‰©å°å±‹ã€‚è¦—ã„ã¦ã¿ã‚‹å‹‡æ°—ãŒã‚ã‚‹ãªã‚‰ã€ã•ã‚ã€æ‰‰ã‚’ã‚ã‘ã¦ã¿ã‚ˆã†ã€‚
    </p>
    <p style="color:var(--muted);font-size:.9rem;margin-top:.6rem">
      â€»æ·±åˆ»ãªæ€§æ ¼è¨ºæ–­ã§ã¯ãªãã€ã€Œè‡ªå·±æ¼”å‡ºã®ã‚¯ã‚»ã€ã‚’ã‚†ã‚‹ãçœºã‚ã‚‹ãŸã‚ã®ãƒ†ã‚¹ãƒˆã§ã™ã€‚
    </p>
    <button type="button" id="startBtn" class="start-btn" aria-label="è¨ºæ–­ã‚’å§‹ã‚ã‚‹">
      <span class="emo">ğŸ¦</span><span>é³¥ãŸã¡ã®æ¥½å±‹ã‚’ã®ãã</span>
    </button>
  </section>

  <!-- è³ªå•ã‚«ãƒ¼ãƒ‰ -->
  <section id="quiz" class="paper" aria-label="è³ªå•ã‚»ã‚¯ã‚·ãƒ§ãƒ³" style="display:none">
    <div class="qnum" id="qnum">Q1/24</div>
    <div class="qtext" id="qtext">â€¦</div>
    <div class="opts" id="opts" role="group" aria-label="å›ç­”ã‚’é¸æŠ"></div>
    <div class="ctrls">
      <button type="button" id="prevBtn">ã‚‚ã©ã‚‹</button>
      <button type="button" id="nextBtn" class="primary">æ¬¡ã¸</button>
    </div>
  </section>

  <!-- çµæœ -->
  <section id="result" class="paper result" aria-label="çµæœã‚»ã‚¯ã‚·ãƒ§ãƒ³">
    <h2 style="margin-top:0">çµæœ</h2>
    <div class="flex">
      <div class="imgbox">
        <img id="resultImg" src="" alt="" loading="lazy">
      </div>
      <div class="text">
        <h3 id="resultTitle" style="margin:.2rem 0 0;"></h3>
        <p id="resultLines" style="white-space:pre-line;margin:.4rem 0 1rem"></p>

        <!-- å› å­ãƒãƒ¼ï¼ˆ6æœ¬ï¼‰ -->
        <div class="bars" id="bars"></div>

        
      </div>
    </div>

    <!-- å‰å›ã®å›ç­”ï¼ˆãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‰ -->
    <details id="prevBlock" style="margin-top:10px">
      <summary>å‰å›ã®å›ç­”ï¼ˆä¸€è¦§ï¼‰</summary>
      <ul id="prevList" class="prev-list"></ul>
   </details>
    <!-- ç ”ç©¶ãƒ¡ãƒ¢ -->
<div class="meta" style="margin:.8rem 0 0">
      <strong>ç ”ç©¶ãƒ¡ãƒ¢ï¼š</strong>
      å¿ƒç†å­¦ã®ç ”ç©¶ã§ã¯ã€è‡ªå·±æ„›ã¯ã€Œå ‚ã€…ã¨ã—ãŸè‡ªå·±æ„›ï¼ˆgrandioseï¼‰ã€ã¨
      ã€Œå‚·ã¤ãã‚„ã™ã„è‡ªå·±æ„›ï¼ˆvulnerableï¼‰ã€ã¨ã„ã†äºŒã¤ã®é¡”ã‚’æŒã¤ã¨ã‚ˆãè¨€ã‚ã‚Œã¾ã™ã€‚
      å‰è€…ã¯ã‚«ãƒªã‚¹ãƒæ€§ã‚„è‡ªä¿¡ã¨çµã³ã¤ãã‚„ã™ã„ä¸€æ–¹ã§ã€èª‡ç¤ºã‚„æ”¯é…ãŒå¼·ã„ã»ã©
      å‘¨å›²ã¨ã®è¡çªã‚„çŸ­å‘½ãªå¯¾äººé–¢ä¿‚ã¨é–¢é€£ã—ã‚„ã™ã„ã“ã¨ãŒå ±å‘Šã•ã‚Œã¦ã„ã¾ã™ã€‚
      å¾Œè€…ã¯ã€Œè©•ä¾¡ã«æ•æ„Ÿã§ã€ã™ããƒ˜ã‚³ã‚€ã€ç‰¹å¾´ã¨ã‚»ãƒƒãƒˆã§ç¾ã‚Œã‚„ã™ãã€
      è»½ã„ãƒ¬ãƒ™ãƒ«ã§ã¯è‡ªå·±é˜²è¡›ã‚„ã‚¹ãƒˆãƒ¬ã‚¹å¯¾å‡¦ã®ã‚¯ãƒƒã‚·ãƒ§ãƒ³ã«ã‚‚ãªã‚Šã†ã‚‹ã¨ã•ã‚Œã¦ã„ã¾ã™ã€‚
    </div>
    <p class="meta" style="margin:.8rem 0 0">â€»æœ¬ãƒšãƒ¼ã‚¸ã¯å¨¯æ¥½ï¼‹è‡ªå·±ç†è§£ã®è£œåŠ©ã‚’ç›®çš„ã¨ã—ãŸç°¡æ˜“ãƒ†ã‚¹ãƒˆã§ã™ã€‚ä½“èª¿ã‚„ä¸èª¿ãŒç¶šãå ´åˆã¯å°‚é–€æ©Ÿé–¢ã¸ã”ç›¸è«‡ãã ã•ã„ã€‚</p>
    <button type="button" class="back" id="restartBtn" aria-label="æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™">æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™</button>
    <a class="back" href="https://haisuikounozarigani.github.io/shindan/">è¨ºæ–­ä¸€è¦§ã«æˆ»ã‚‹</a>
  </section>
</main>

<div class="mini-toast" id="toast" role="status" aria-live="polite"> âœ…</div>

<script>
/* ===== å›ºå®šé€²æ—ãƒãƒ¼ ===== */
function updateProgress(p){
  var bar = document.querySelector('.progress-bar');
  var wrap = document.querySelector('.progress-fixed');
  var val = Math.max(0,Math.min(100,p));
  bar.style.width = val + '%';
  wrap.setAttribute('aria-valuenow', String(val));
}

/* ===== å®šç¾© ===== */
const SLUG = 'narcissist-six';
const LS_ANS = `shindan:${SLUG}:answers`;
const LS_IDX = `shindan:${SLUG}:index`;
const LS_DONE = `shindan:${SLUG}:done`;
const LS_LASTANS = `shindan:${SLUG}:lastAnswers`;

/* å› å­ï¼ˆ6ï¼‰ */
const FACTS = ['SHOW','VULN','SEXY','MORAL','DOM','BOUND'];
const FACT_LABEL = {
  SHOW:'èª‡ç¤ºï¼ˆã‚ªã‚¦ãƒ ï¼‰',
  VULN:'è„†å¼±ï¼ˆã‚¹ã‚ºãƒ¡ï¼‰',
  SEXY:'æ€§çš„æ¼”å‡ºï¼ˆã‚¯ã‚¸ãƒ£ã‚¯ï¼‰',
  MORAL:'é“å¾³èª‡ç¤ºï¼ˆãƒãƒˆï¼‰',
  DOM:'æ”¯é…åœ§ï¼ˆãƒ¯ã‚·ï¼‰',
  BOUND:'å¢ƒç•Œç·šï¼ˆãƒ•ã‚¯ãƒ­ã‚¦ï¼‰'
};

/* ã‚¿ã‚¤ãƒ—ã¨ç”»åƒï¼ˆt01ã€œt06ã‚¿ã‚¤ãƒ—å›ºå®šï¼‰ */
const TYPE_INFO = {
  // sparrow
  VULN:{
    name:'ã‚¹ã‚ºãƒ¡ç³»ãƒ»è„†å¼±ã‚¢ãƒ”å‹',
    file:'t01.webp',
    alt:'ã‚¹ã‚ºãƒ¡ç³»ã®äºŒäºº',
    short:'å®ˆã‚‰ã‚ŒãŸã„ã‚µã‚¤ãƒ³ãŒä¸Šæ‰‹ã€‚ã‚¹ã‚ºãƒ¡ã¿ãŸã„ã«å°ã•ãéœ‡ãˆã¤ã¤ã€ã¡ã‚ƒã‚“ã¨æ°—ã‚’å¼•ã‘ã‚‹ã‚¿ã‚¤ãƒ—ã§ã™ã€‚',
    step:'äº‹å®Ÿï¼‹æ„Ÿæƒ…1èªã§é€ã‚‹'
  },
  // dove
  MORAL:{
    name:'ãƒãƒˆç³»ãƒ»é“å¾³ã‚¢ãƒ”å‹',
    file:'t02.webp',
    alt:'ãƒãƒˆç³»ã®äºŒäºº',
    short:'è‰¯å¿ƒã®ã‚¢ãƒŠã‚¦ãƒ³ã‚¹ä¿‚ã€‚ãƒãƒˆã®ã‚ˆã†ã«é™ã‹ã«ã€ã§ã‚‚ç¢ºå®Ÿã«ã€Œãã‚Œæ­£ã—ããªã„ã‹ã‚‚â€¦ã€ã‚’åºƒå ±ã—ã¾ã™ã€‚',
    step:'ç›¸æ‰‹ã®è‰¯ç‚¹ã‚’1ã¤æ›¸ã'
  },
  // peacock
  SEXY:{
    name:'ã‚¯ã‚¸ãƒ£ã‚¯ç³»ãƒ»æ€§çš„ã‚¢ãƒ”å‹',
    file:'t03.webp',
    alt:'ã‚¯ã‚¸ãƒ£ã‚¯ç³»ã®äºŒäºº',
    short:'é­…ã›æ–¹ã®æ¼”å‡ºå®¶ã€‚ã‚¯ã‚¸ãƒ£ã‚¯ã®ç¾½ã¿ãŸã„ã«ã€ã€Œã“ã“ãã€ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã ã‘è‰²ã‚’å¢—ã‚„ã—ãŸããªã‚‹äººã§ã™ã€‚',
    step:'æŠ•ç¨¿ã¯ä¸‹æ›¸ã30åˆ†'
  },
  // parrot
  SHOW:{
    name:'ã‚ªã‚¦ãƒ ç³»ãƒ»èª‡ç¤ºã‚¢ãƒ”å‹',
    file:'t04.webp',
    alt:'ã‚ªã‚¦ãƒ ç³»ã®äºŒäºº',
    short:'ã‚¹ãƒãƒƒãƒˆãƒ©ã‚¤ãƒˆã®æ‰±ã„äººã€‚ã‚ªã‚¦ãƒ ã®å£°é‡ã¨ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã§å ´ã‚’å‹•ã‹ã—ã€ã€Œèã„ã¦èã„ã¦ï¼ã€ãŒå¾—æ„ã§ã™ã€‚',
    step:'æˆæœã‚’æ•°å­—ã§ä¸€è¨€'
  },
  // eagle
  DOM:{
    name:'ãƒ¯ã‚·ç³»ãƒ»æ”¯é…ãƒ»å¼·ã•å‹',
    file:'t05.webp',
    alt:'ãƒ¯ã‚·ç³»ã®äºŒäºº',
    short:'èˆ¹é•·ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚’å–ã‚ŠãŒã¡ã€‚ãƒ¯ã‚·ã®ç›®ã§å…¨ä½“ã‚’è¦‹æ¸¡ã—ã€ã€Œã¨ã‚Šã‚ãˆãšã“ã†ã—ã‚ˆã†ã€ã‚’æ±ºã‚ã¦ã„ãã¾ã™ã€‚',
    step:'è¦æœ›ã‚’ã€ŒãŠé¡˜ã„ã€ã«'
  },
  // owl
  BOUND:{
    name:'ãƒ•ã‚¯ãƒ­ã‚¦ç³»ãƒ»å¢ƒç•Œãƒ»é…æ…®å‹',
    file:'t06.webp',
    alt:'ãƒ•ã‚¯ãƒ­ã‚¦ç³»ã®äºŒäºº',
    short:'ç·¨é›†è€…æ°—è³ªã®ãƒ•ã‚¯ãƒ­ã‚¦ã‚¿ã‚¤ãƒ—ã€‚é™ã‹ã«å…¨ä½“ã‚’è¦‹å®ˆã‚Šã¤ã¤ã€ä½™ç™½ã¨è·é›¢æ„Ÿã‚’ãã‚Œã„ã«æ•´ãˆã¾ã™ã€‚',
    step:'æ–­ã‚Šæ–‡ãƒ†ãƒ³ãƒ—ãƒ¬ä½œã‚‹'
  }
};

const LABELS = ['ãœã‚“ãœã‚“','ã‚ã¾ã‚Š','ã©ã¡ã‚‰ã¨ã‚‚','ã‚ã‚Šã¨','ã¨ã¦ã‚‚'];

/* è¨­å• 24å•ï¼ˆ6å› å­Ã—4ï½œ0â€“4ï¼‰ */
const QUESTIONS = [
  // èª‡ç¤ºï¼ˆç›®ç«‹ã¡ãƒ»è¦‹ã›å ´ï¼‰ SHOWï¼ˆã‚ªã‚¦ãƒ ï¼‰
  {t:'æ³¨ç›®ãŒé›†ã¾ã‚‹ã¨å…ƒæ°—ãŒå‡ºã‚‹ã€‚', key:'SHOW'},
  {t:'æˆæœã¯æ•°å­—ã§ç¤ºã—ãŸã„ã€‚', key:'SHOW'},
  {t:'å¤§ããªãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã§å ´ã‚’å‹•ã‹ã™ã“ã¨ãŒã‚ã‚‹ã€‚', key:'SHOW'},
  {t:'é™ã‹ãªå½¹å›ã‚Šã ã¨ç‰©è¶³ã‚Šãªã„ã€‚', key:'SHOW'},

  // è„†å¼±ï¼ˆå¼±ã¿ãƒ»å®ˆã‚‰ã‚ŒãŸã„ï¼‰ VULNï¼ˆã‚¹ã‚ºãƒ¡ï¼‰
  {t:'å¼±éŸ³ã‚’å‡ºã™ã¨è·é›¢ãŒè¿‘ããªã‚‹ã¨æ„Ÿã˜ã‚‹ã€‚', key:'VULN'},
  {t:'ã€Œã¤ã‚‰ã‹ã£ãŸè©±ã€ã¯åå¿œãŒã‚ˆã„ã€‚', key:'VULN'},
  {t:'å®ˆã£ã¦ã»ã—ã„æ°—æŒã¡ã‚’åŒ‚ã‚ã›ã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚', key:'VULN'},
  {t:'åŠ±ã¾ã—ã®è¨€è‘‰ã‚’å¾…ã£ã¦ã‹ã‚‰è©±ã‚’ç¶šã‘ã‚‹ã€‚', key:'VULN'},

  // æ€§çš„æ¼”å‡ºï¼ˆè‰²æ°—ãƒ»é­…ã›ï¼‰ SEXYï¼ˆã‚¯ã‚¸ãƒ£ã‚¯ï¼‰
  {t:'è¦‹ãŸç›®ã‚„é›°å›²æ°—ã‚’â€œã¡ã‚‡ã£ã¨ã ã‘â€ç››ã‚‹ã€‚', key:'SEXY'},
  {t:'ã•ã‚Šã’ãªã„ä»•è‰ã§å°è±¡ã‚’å¤‰ãˆã‚‹ã€‚', key:'SEXY'},
  {t:'å¤–è¦‹ã‚’è¤’ã‚ã‚‰ã‚Œã‚‹ã¨ç‰¹ã«ã†ã‚Œã—ã„ã€‚', key:'SEXY'},
  {t:'è¦–ç·šã‚„é–“ã§â€œè‰²æ°—â€ã‚’ä½œã‚Œã‚‹æ°—ãŒã™ã‚‹ã€‚', key:'SEXY'},

  // é“å¾³èª‡ç¤ºï¼ˆæ­£ã—ã•ãƒ»å–„ï¼‰ MORALï¼ˆãƒãƒˆï¼‰
  {t:'æ­£ã—ã•ã‚’ç¤ºã™ã¨å®‰å¿ƒã™ã‚‹ã€‚', key:'MORAL'},
  {t:'å–„ã„è¡Œå‹•ã¯å…±æœ‰ã—ãŸã„ã€‚', key:'MORAL'},
  {t:'ã€Œãã‚Œã¯è‰¯ããªã„ã€ã¨æŒ‡æ‘˜ã—ãŸããªã‚‹ã€‚', key:'MORAL'},
  {t:'å¯„ä»˜ã‚„ãƒãƒŠãƒ¼ã®è©±é¡Œã‚’é¸ã³ãŒã¡ã€‚', key:'MORAL'},

  // æ”¯é…åœ§ï¼ˆä¸»å°ãƒ»æ±ºå®šï¼‰ DOMï¼ˆãƒ¯ã‚·ï¼‰
  {t:'è­°è«–ã®ä¸»å°æ¨©ã‚’å–ã‚ŠãŸããªã‚‹ã€‚', key:'DOM'},
  {t:'æŒ‡ç¤ºãŒæ›–æ˜§ã ã¨ã‚¤ãƒ©ã¤ãã€‚', key:'DOM'},
  {t:'çµè«–ã‚’æ€¥ã„ã§â€œæ±ºã‚ã‚‹â€ã“ã¨ãŒå¤šã„ã€‚', key:'DOM'},
  {t:'ç›¸æ‰‹ã®ãƒšãƒ¼ã‚¹ã‚ˆã‚Šè‡ªåˆ†ã®ãƒšãƒ¼ã‚¹ã‚’å„ªå…ˆã—ãŒã¡ã€‚', key:'DOM'},

  // å¢ƒç•Œç·šï¼ˆé…æ…®ãƒ»è·é›¢æ„Ÿï¼‰ BOUNDï¼ˆãƒ•ã‚¯ãƒ­ã‚¦ï¼‰
  {t:'ã€Œä»Šã¯è©±ã›ãªã„ã€ã¨è¨€ãˆã‚‹ã€‚', key:'BOUND'},
  {t:'ç›¸æ‰‹ã®é ˜åŸŸã«è¸ã¿è¾¼ã¿ã™ããªã„ã€‚', key:'BOUND'},
  {t:'é ¼ã¿ã”ã¨ã¯æ–­ã‚‹ç·´ç¿’ã‚’ã—ã¦ã„ã‚‹ã€‚', key:'BOUND'},
  {t:'æ„è¦‹ãŒé•ã£ã¦ã‚‚å°Šé‡ã—ã¦çµ‚ã‚ã‚Œã‚‹ã€‚', key:'BOUND'}
];

/* ===== çŠ¶æ…‹ ===== */
let idx = 0;
let answers = new Array(QUESTIONS.length).fill(null);

/* ===== è¦ç´  ===== */
const $qnum = document.getElementById('qnum');
const $qtext = document.getElementById('qtext');
const $opts = document.getElementById('opts');
const $prev = document.getElementById('prevBtn');
const $next = document.getElementById('nextBtn');
const $quiz = document.getElementById('quiz');
const $result = document.getElementById('result');
const $resultImg = document.getElementById('resultImg');
const $resultTitle = document.getElementById('resultTitle');
const $resultLines = document.getElementById('resultLines');
const $bars = document.getElementById('bars');
const $restart = document.getElementById('restartBtn');
const $toast = document.getElementById('toast');
const $prologue = document.getElementById('prologue');
const $startBtn = document.getElementById('startBtn');

/* ===== åˆæœŸè¡¨ç¤ºï¼šå¾©å…ƒ or ãƒ—ãƒ­ãƒ­ãƒ¼ã‚° ===== */
(function init(){
  updateProgress(0);
  let savedAns = null;
  let savedIdx = 0;
  try{
    savedAns = JSON.parse(localStorage.getItem(LS_ANS) || 'null');
    savedIdx = JSON.parse(localStorage.getItem(LS_IDX) || '0');
  }catch(_){}
  const validArray = Array.isArray(savedAns) && savedAns.length === QUESTIONS.length;
  const hasAny = validArray && savedAns.some(v => v !== null);
  const allDone = validArray && savedAns.every(v => v !== null);

  if(allDone){
    answers = savedAns;
    idx = QUESTIONS.length - 1;
    renderQuestion(); // å†…éƒ¨çŠ¶æ…‹ã ã‘æ•´ãˆã‚‹
    enterResultMode();
    showResult();
    return;
  }
  if(hasAny){
    answers = savedAns;
    idx = Math.min(Math.max(0, +savedIdx || 0), QUESTIONS.length-1);
    renderQuestion();
    enterQuizMode();
    return;
  }
  // å®Œå…¨æ–°è¦ï¼šãƒ—ãƒ­ãƒ­ãƒ¼ã‚°è¡¨ç¤ºã®ã¾ã¾
  enterPrologueMode();
})();

/* ===== è¡¨ç¤ºåˆ‡æ›¿ ===== */
function enterPrologueMode(){
  $prologue.style.display = 'block';
  $quiz.style.display = 'none';
  $result.style.display = 'none';
  document.querySelector('.rank').textContent = 'â€”';
  updateProgress(0);
}
function enterQuizMode(){
  $prologue.style.display = 'none';
  $quiz.style.display = 'block';
  $result.style.display = 'none';
}
function enterResultMode(){
  $prologue.style.display = 'none';
  $quiz.style.display = 'none';
  $result.style.display = 'block';
}

/* ===== ç”»é¢æç”» ===== */
function renderQuestion(){
  const q = QUESTIONS[idx];
  $qnum.textContent = `Q${idx+1}/${QUESTIONS.length}`;
  $qtext.textContent = q.t;
  $opts.innerHTML = '';
  LABELS.forEach((lab,i)=>{
    const btn = document.createElement('button');
    btn.type = 'button';
    btn.className = 'btn';
    btn.setAttribute('aria-pressed', answers[idx]===i ? 'true':'false');
    btn.innerHTML = `<span>${lab}</span><span class="opt-note">${descFor(i)}</span>`;
    btn.addEventListener('click',()=> selectAnswer(i));
    $opts.appendChild(btn);
  });
  $prev.disabled = (idx===0);
  $next.textContent = (idx===QUESTIONS.length-1)? 'çµæœã‚’è¦‹ã‚‹':'æ¬¡ã¸';
  const done = answers.filter(v=>v!==null).length;
  updateProgress(Math.round(done/QUESTIONS.length*100));
  document.querySelector('.rank').textContent = 'â€”';
}
function descFor(i){
  return ['ã»ã¼ãªã„','ã™ã“ã—','åŠã€…','ã‚ˆãã‚ã‚‹','ã¨ã¦ã‚‚ã‚ã‚‹'][i] || '';
}

/* ===== å›ç­”å‡¦ç† ===== */
function selectAnswer(v){
  answers[idx] = v; // 0â€“4
  persist();
  showToast(' âœ…');
  markPressed(v);
  setTimeout(()=>{
    if(idx < QUESTIONS.length-1){
      idx++;
      renderQuestion();
    }else{
      enterResultMode();
      showResult();
    }
  }, 140);
}
function markPressed(v){
  [...$opts.children].forEach((el,i)=> el.setAttribute('aria-pressed', i===v ? 'true' : 'false'));
}
$prev.addEventListener('click', ()=>{
  if(idx>0){
    idx--;
    persist();
    renderQuestion();
  }
});
$next.addEventListener('click', ()=>{
  if(idx<QUESTIONS.length-1){
    idx++;
    persist();
    renderQuestion();
    enterQuizMode();
  }else{
    enterResultMode();
    showResult();
  }
});

/* ãƒ—ãƒ­ãƒ­ãƒ¼ã‚° â†’ ã‚¹ã‚¿ãƒ¼ãƒˆ */
$startBtn.addEventListener('click', ()=>{
  if(!answers.some(v=>v!==null)){
    idx = 0;
    renderQuestion();
  }
  enterQuizMode();
  window.scrollTo({top:0,behavior:'smooth'});
});

/* ===== ä¿å­˜ ===== */
function persist(){
  try{
    localStorage.setItem(LS_ANS, JSON.stringify(answers));
    localStorage.setItem(LS_IDX, JSON.stringify(idx));
  }catch(_){}
}

/* ===== ã‚¹ã‚³ã‚¢è¨ˆç®—ï¼ˆavgâ†’pctï¼‰ ===== */
function computeScores(){
  const sums = {SHOW:0,VULN:0,SEXY:0,MORAL:0,DOM:0,BOUND:0};
  const counts = {SHOW:0,VULN:0,SEXY:0,MORAL:0,DOM:0,BOUND:0};
  QUESTIONS.forEach((q,i)=>{
    let v = answers[i];
    if(v == null) v = 0; // æœªå›ç­”ã¯0æ‰±ã„
    sums[q.key] += v; counts[q.key] += 1;
  });
  const avg = {}; const pct = {};
  FACTS.forEach(k=>{
    const a0 = (sums[k]/(counts[k]||1)); // 0â€“4
    const a15 = a0 + 1;                  // 1â€“5 ã¸ã‚·ãƒ•ãƒˆ
    avg[k] = a15;
    pct[k] = Math.round((a15-1)/4*100);  // 0â€“100
  });

  // ãƒˆãƒƒãƒ—å› å­ï¼ã‚¿ã‚¤ãƒ—ã€‚åŒç‚¹æ™‚ã¯å¢ƒç•Œç·šãŒé«˜ã„æ–¹ã‚’å„ªå…ˆ
  let bestVal = -Infinity;
  FACTS.forEach(k=>{
    if(avg[k] > bestVal) bestVal = avg[k];
  });
  let top = null;
  FACTS.forEach(k=>{
    if(top === null || avg[k] > avg[top]) top = k;
  });
  if(Math.abs(avg.BOUND - bestVal) < 1e-6){
    top = 'BOUND';
  }

  return {avg,pct,top};
}

/* ===== çµæœè¡¨ç¤º ===== */
function showResult(){
  const {pct, top} = computeScores();
  const typeInfo = TYPE_INFO[top] || TYPE_INFO.VULN;

  // ç”»åƒ
  const IMG_BASE = '/shindan/assets/results/narcissist-six/';
  const file = typeInfo.file;
  $resultImg.src = IMG_BASE + file;
  $resultImg.alt = typeInfo.alt || 'é³¥ãƒ¢ãƒãƒ¼ãƒ•ã®ã‚¿ã‚¤ãƒ—';

  // ã‚¿ã‚¤ãƒˆãƒ«ãƒ»ãƒãƒƒã‚¸
  const label = typeInfo.name;
  document.querySelector('.rank').textContent = label;
  $resultTitle.textContent = `ã‚ãªãŸã®ã‚¿ã‚¤ãƒ—ï¼š${label}`;

  // æœ¬æ–‡ï¼ˆçŸ­è©•ï¼‹ã‚¹ãƒ‘ã‚¤ã‚¹ï¼‹ãƒŸãƒ‹ä¸€æ­©ï¼‰
  const flavor = typeInfo.short;
  const spice = (top === 'VULN')  ? 'æ·±ã„ç›¸æ‰‹ã¯ã„ã‚‹ã®ã«ã€è‡ªåˆ†ã‹ã‚‰ã¯é³´ãå§‹ã‚ã«ãã„ã¨ã“ã‚ã‚‚ã€‚ç¾½ã®ä¼‘ã‚ã©ã“ã‚ã‚’1ã‚«æ‰€ã ã‘æ±ºã‚ã¦ãŠãã¨æ¥½ã«ãªã‚Šã¾ã™ã€‚' :
                 (top === 'MORAL') ? 'æ­£ã—ã•ã®ç‰©å·®ã—ã‚’ã„ã¤ã‚‚æŒã£ã¦ã„ã‚‹äººã€‚ã¨ãã©ãè‡ªåˆ†ã«ã‚‚ã€ãƒãƒˆä¸¦ã¿ã®ã‚„ã•ã—ã„åˆ¤å®šã‚’ã‚ã’ã¦ã¿ã‚‹ã¨å¿ƒãŒè»½ããªã‚Šã¾ã™ã€‚' :
                 (top === 'SEXY')  ? 'ç©ºæ°—ã‚’èª­ã‚“ã§é›°å›²æ°—ã‚’è¶³ã›ã‚‹è£…é£¾æ‹…å½“ã€‚ç››ã‚Šã™ããã†ãªæ—¥ã¯ã€ã€Œä»Šæ—¥ã¯ä¸€è‰²ã ã‘æ´¾æ‰‹ã«ã™ã‚‹ã€ãã‚‰ã„ã«çµã‚‹ã¨ã¡ã‚‡ã†ã©ã„ã„ã‹ã‚‚ã€‚' :
                 (top === 'SHOW')  ? 'å ´ã‚’å‹•ã‹ã™ã€Œèµ·çˆ†å½¹ã€ã‚’è²·ã£ã¦å‡ºãŒã¡ã€‚é³´ãå£°ã®ãƒœãƒªãƒ¥ãƒ¼ãƒ ã ã‘ä¸€æ®µéšä¸‹ã’ã¦ã‚‚ã€ã‚ãªãŸãŒä¸»å½¹ãªã®ã¯ã¡ã‚ƒã‚“ã¨ä¼ã‚ã£ã¦ã„ã¾ã™ã€‚' :
                 (top === 'DOM')   ? 'æ±ºæ–­ã¨èˆµå–ã‚Šã‚’ä»»ã•ã‚Œã‚„ã™ã„ãƒã‚¸ã‚·ãƒ§ãƒ³ã€‚ã€Œä»Šæ—¥ã¯ã“ã®ç©ºã ã‘è¦‹ã‚‹æ—¥ã€ã¨æ±ºã‚ã¦ã€è²¬ä»»ç¯„å›²ã‚’å°‘ã—ã ã‘ç‹­ã‚ã¦ã‚‚å¤§ä¸ˆå¤«ã€‚' :
                 /* BOUND */        'è‡ªåˆ†ã¨ç›¸æ‰‹ã®ä½™ç™½ã‚’å®ˆã‚Œã‚‹ã‚¯ãƒƒã‚·ãƒ§ãƒ³å½¹ã€‚ã€Œã“ã“ã¾ã§ã€ãŒè¨€ãˆã‚‹ã»ã©ã€ãƒ•ã‚¯ãƒ­ã‚¦ã®ç¾½æ ¹ã‚‚æ•´ã£ã¦ã„ãã¾ã™ã€‚ã‚„ã•ã—ã„ç·šå¼•ãã¯æ‰èƒ½ã§ã™ã€‚';
  const line = `${flavor}\n${spice}\nãƒŸãƒ‹ä¸€æ­©ï¼š${typeInfo.step}`;
  $resultLines.textContent = line;

  // å› å­ãƒãƒ¼ï¼ˆ6æœ¬ï¼‰ 0â€“100%
  $bars.innerHTML = '';
  FACTS.forEach(k=>{
    const v = pct[k];
    const wrap = document.createElement('div');
    wrap.className = 'bar';
    wrap.innerHTML = `
      <div class="h"><span>${FACT_LABEL[k]}</span><span>${v}%</span></div>
      <div class="b" style="width:${v}%"></div>
    `;
    $bars.appendChild(wrap);
  });

  

  // å®Œäº†ãƒ»å‰å›å›ç­”ä¿å­˜
  try{ localStorage.setItem(LS_DONE, String(Date.now())); }catch(_){}
  try{
    localStorage.setItem(LS_LASTANS, JSON.stringify({answers: answers.slice(), ts: Date.now()}));
  }catch(_){}

  // å‰å›å›ç­”ä¸€è¦§ã‚’æ›´æ–°
  buildPrevAnswers();

  document.dispatchEvent(new Event('result:ready'));
}

/* ===== ãƒªã‚¹ã‚¿ãƒ¼ãƒˆ ===== */
function restartQuiz(){
  answers = new Array(QUESTIONS.length).fill(null);
  idx = 0;
  try{
    localStorage.removeItem(LS_ANS);
    localStorage.removeItem(LS_IDX);
  }catch(_){}
  enterPrologueMode();
  window.scrollTo({top:0, behavior:'smooth'});
  showToast('æœ€åˆã‹ã‚‰ã¯ã˜ã‚ã‚‹ã‚ˆ');
}
$restart.addEventListener('click', restartQuiz);

/* ===== ãƒˆãƒ¼ã‚¹ãƒˆ ===== */
let toastTimer = null;
function showToast(msg){
  $toast.textContent = msg || 'OK';
  $toast.classList.add('show');
  clearTimeout(toastTimer);
  toastTimer = setTimeout(()=> $toast.classList.remove('show'), 850);
}

/* ===== å‰å›å›ç­”ä¸€è¦§ã‚’æ§‹ç¯‰ ===== */
function buildPrevAnswers(){
  const $block = document.getElementById('prevBlock');
  const $list  = document.getElementById('prevList');
  if(!$block || !$list) return;

  let prev = null;
  try{
    prev = JSON.parse(localStorage.getItem(LS_LASTANS) || 'null');
  }catch(_){}

  if(!prev || !Array.isArray(prev.answers)) return;

  $list.innerHTML = '';
  prev.answers.forEach((v,i)=>{
    const li = document.createElement('li');
    li.className = 'prev-item';
    const lab = (typeof v === 'number' && v>=0 && v<LABELS.length) ? LABELS[v] : 'â€”';
    li.innerHTML = `<span class="prev-q">Q${i+1}ï¼š${QUESTIONS[i].t}</span><span class="prev-a">ã€Œ${lab}ã€</span>`;
    $list.appendChild(li);
  });

  // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯é–‰ã˜ã¦ãŠã
  $block.open = false;
}
</script>

<!-- ã‚ãªãŸã®ã“ã“ã‚Lvï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã®ã¿ï¼‰ -->
<script>(function(){
  var DONE_KEY='specimens:open:byid', TOTAL_KEY='specimens:open:total';
  var MY_ID=document.body.getAttribute('data-id')||'narcissist-six';
  var marked=false;
  function mark(){ if(marked) return; marked=true;
    try{
      // ã‚ãªãŸã®ã“ã“ã‚Lvï¼ˆå…¨è¨ºæ–­åˆè¨ˆï¼‰
      var t=(+localStorage.getItem(TOTAL_KEY)||0)+1;
      localStorage.setItem(TOTAL_KEY,String(t));
      // è¨ºæ–­ã”ã¨ã®ã‚«ã‚¦ãƒ³ãƒˆ
      var map={}; try{ map=JSON.parse(localStorage.getItem(DONE_KEY)||'{}'); }catch(_){}
      map[MY_ID]=(map[MY_ID]||0)+1;
      localStorage.setItem(DONE_KEY, JSON.stringify(Object.assign({},map,{_ts:Date.now()})));
    }catch(_){}
  }
  document.addEventListener('result:ready', mark);
  setTimeout(mark, 2000); // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
}());</script>

</body>
</html>