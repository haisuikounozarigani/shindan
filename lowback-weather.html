<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<!-- =========================
  æ¤œç´¢ç½®æ›ãƒã‚¤ãƒ³ãƒˆï¼ˆæœ€ä½é™ã“ã“ã ã‘ï¼‰
  1) TITLE / description
  2) og:title / og:description
  3) og:url
  4) og:image ã® slug
  5) body data-id / SLUG
========================= -->
<title>è…°ã®å¤©æ°—è¨ºæ–­ï½œé»„ä¿¡å·ãƒã‚§ãƒƒã‚¯ï¼ˆå¿ƒç†ãƒ»ç”Ÿæ´»ç·¨ï¼‰</title>
<meta name="description" content="è…°ã®ç—›ã¿ãã®ã‚‚ã®ã§ã¯ãªãã€æ…¢æ€§åŒ–ã®â€œç‡ƒæ–™â€ã«ãªã‚Šã‚„ã™ã„å¿ƒç†ãƒ»ç”Ÿæ´»ã‚µã‚¤ãƒ³ã‚’å¤©æ°—ã«ãŸã¨ãˆã¦ç‚¹æ¤œã—ã¾ã™ï¼ˆãƒ¬ãƒƒãƒ‰ãƒ•ãƒ©ãƒƒã‚°ã¯åˆ¥æ ã§ä¸­æ–­ï¼‰ã€‚">
<meta name="theme-color" content="#fff7fd">

<!-- OG -->
<meta property="og:type" content="website">
<meta property="og:title" content="è…°ã®å¤©æ°—è¨ºæ–­ï½œé»„ä¿¡å·ãƒã‚§ãƒƒã‚¯ï¼ˆå¿ƒç†ãƒ»ç”Ÿæ´»ç·¨ï¼‰">
<meta property="og:description" content="æ…¢æ€§åŒ–ã®â€œç‡ƒæ–™â€ã«ãªã‚Šã‚„ã™ã„ã‚µã‚¤ãƒ³ã‚’å¤©æ°—ã«ã—ã¦è¦‹ãˆã‚‹åŒ–ï¼ˆãƒ¬ãƒƒãƒ‰ãƒ•ãƒ©ãƒƒã‚°ã¯ä¸­æ–­ï¼‰ã€‚">
<meta property="og:url" content="https://haisuikounozarigani.github.io/shindan/lowback-weather.html">
<meta property="og:image" content="https://haisuikounozarigani.github.io/shindan/assets/results/lowback-weather/t00.webp">

<style>
:root{
  --bg:#fdf7ff;
  --paper:#fff;
  --ink:#201322;
  --muted:#6a5b70;
  --line:#ece3f5;
  --accent:#8c6bff;
  --accent2:#ff8fc7;
  --good:#1d8f6e;
  --warn:#b04a2f;
}
html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);
  font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Noto Sans JP","Hiragino Sans","Yu Gothic",Meiryo,sans-serif;
  -webkit-text-size-adjust:100%;
  text-size-adjust:100%;
}
a{color:#5b2ea8;text-decoration:none}
.wrap{max-width:980px;margin:0 auto;padding:16px}
header.hd{
  background:linear-gradient(160deg,#fff7fd,#f3ecff);
  border-bottom:1px solid var(--line);
}
header.hd .wrap{padding:20px 16px 10px}
.ttl{
  font-weight:900;font-size:1.35rem;letter-spacing:.02em;
  display:flex;gap:10px;align-items:center;flex-wrap:wrap;
}
.sub{color:var(--muted);font-size:.95rem}

/* ãƒ©ãƒ³ã‚¯ãƒãƒƒã‚¸ï¼ˆãƒ˜ãƒƒãƒ€ï¼‰ */
.rank{
  display:inline-flex;align-items:center;gap:6px;
  padding:.2em .75em;border-radius:999px;
  background:#f3e9ff;color:#4b266e;font-weight:850;font-size:.85rem;
}

/* å›ºå®šé€²æ—ãƒãƒ¼ */
.progress-fixed{
  position:sticky;top:0;z-index:20;
  height:8px;background:var(--line)
}
.progress-bar{
  height:100%;border-radius:6px;
  background:linear-gradient(90deg,var(--accent),var(--accent2));
  transition:width .2s ease
}
[role="progressbar"]{width:100%}

/* ãƒ’ãƒ¼ãƒ­ãƒ¼ï¼ˆæ­£æ–¹å½¢å›ºå®šï¼‰ */
figure.hero{
  margin:12px 0;border:1px solid var(--line);
  border-radius:16px;overflow:hidden;background:#fff;
}
figure.hero img{
  display:block;width:100%;
  aspect-ratio:1/1;object-fit:cover;
}

/* å…±é€šã‚«ãƒ¼ãƒ‰ */
.paper{
  background:var(--paper);
  border:1px solid var(--line);
  border-radius:16px;
  padding:16px;
  margin:14px 0;
}

/* ãƒ—ãƒ­ãƒ­ãƒ¼ã‚° */
#prologue h2{margin-top:0;font-size:1.1rem}
#prologue p{margin:.45rem 0;color:var(--muted)}
#prologue .note{color:var(--muted);font-size:.9rem}
.start-btn{
  margin-top:12px;width:100%;
  padding:12px 16px;border-radius:999px;border:0;
  background:linear-gradient(135deg,var(--accent),var(--accent2));
  color:#1b0f1c;font-weight:900;letter-spacing:.03em;
  cursor:pointer;box-shadow:0 10px 20px rgba(140,107,255,.18);
  display:inline-flex;align-items:center;justify-content:center;gap:8px;
}
.start-btn span.emo{font-size:1.2rem}

/* ã‚²ãƒ¼ãƒˆï¼ˆãƒ¬ãƒƒãƒ‰ãƒ•ãƒ©ãƒƒã‚°ï¼‰ */
.gate h2{margin:0 0 6px;font-size:1.05rem}
.gate p{margin:.35rem 0;color:var(--muted)}
.gate .warnbox{
  margin:.6rem 0 .2rem;
  padding:10px 12px;border-radius:14px;
  border:1px solid rgba(176,74,47,.25);
  background:linear-gradient(180deg,#fff,#fff5f2);
}
.gate .warnbox b{color:#5c2d21}
.chklist{display:grid;gap:8px;margin:.7rem 0 0}
.chk{
  display:flex;gap:10px;align-items:flex-start;
  padding:10px 12px;border-radius:12px;
  border:1px solid var(--line);background:#fff;
}
.chk input{margin-top:3px}
.chk .t{font-weight:850}
.chk .d{color:var(--muted);font-size:.92rem}
.gate-actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
.gate-actions button{
  flex:1 1 240px;
  padding:12px 14px;border-radius:999px;border:1px solid var(--line);
  background:#faf5ff;cursor:pointer;font-weight:900;
}
.gate-actions .go{
  border:0;background:linear-gradient(135deg,var(--accent),var(--accent2));
  color:#1b0f1c;box-shadow:0 14px 28px rgba(140,107,255,.18);
}
.stop{
  display:none;margin-top:12px;
  padding:12px 12px 10px;border-radius:16px;
  border:1px solid rgba(176,74,47,.25);
  background:linear-gradient(135deg, rgba(176,74,47,.08), rgba(255,143,199,.08));
}
.stop .h{font-weight:950}
.stop ul{margin:.45rem 0 0 1.1rem}
.stop li{margin:.2rem 0;color:#5c2d21}
.stop .small{margin-top:.5rem;color:var(--muted);font-size:.9rem}

/* è³ªå• */
.qhead{display:flex;justify-content:space-between;align-items:center;gap:8px}
.qnum{font-weight:900;color:#4c2b5f}
.qtag{
  font-size:.8rem;color:#7a6c86;
  padding:2px 8px;border-radius:999px;
  border:1px solid var(--line);
  background:#f9f3ff;
  display:inline-flex;align-items:center;gap:4px;
}
.qtext{margin:.65rem 0 1rem;font-weight:850}
.opts{display:grid;grid-template-columns:1fr;gap:8px}
.btn{
  display:flex;align-items:center;justify-content:space-between;gap:12px;
  padding:12px 14px;border:1px solid var(--line);
  border-radius:12px;background:#fff;cursor:pointer;transition:.12s;
}
.btn[aria-pressed="true"]{outline:2px solid var(--accent2);background:#fff4fa}
.btn:hover{transform:translateY(-1px)}
.btn-label{font-weight:850}
.opt-note{color:#8b7b93;font-size:.9rem;white-space:nowrap}
.ctrls{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap}
.ctrls button{
  padding:10px 14px;border-radius:10px;border:1px solid var(--line);
  background:#faf5ff;cursor:pointer;font-weight:800;
}
.ctrls button:disabled{opacity:.55;cursor:not-allowed}

/* çµæœ */
.result{display:none}
.flex{display:flex;gap:16px;flex-wrap:wrap}
.result .imgbox{flex:1 1 280px;min-width:260px}
.result .imgbox img{
  width:100%;aspect-ratio:1/1;object-fit:cover;
  border-radius:14px;border:1px solid var(--line);display:block;
}
.result .text{flex:2 1 360px;min-width:300px}
.badge-line{display:flex;flex-wrap:wrap;gap:6px;align-items:center;margin:.2rem 0 .55rem}
.badge-pill{
  display:inline-flex;align-items:center;gap:6px;
  padding:3px 10px;border-radius:999px;background:#fff1fb;font-size:.85rem;
  border:1px solid rgba(236,227,245,.9);
}
.result-title-main{margin:.1rem 0 0}
.result-title-sub{margin:.15rem 0 .8rem;font-size:.9rem;color:var(--muted)}
.result-comment{
  margin:.35rem 0 .9rem;
  padding:10px 12px;
  border-radius:14px;
  border:1px solid var(--line);
  background:linear-gradient(180deg,#fff,#fff6fb);
}
.result-comment p{margin:.25rem 0;color:#5a3a4f}
.result-comment .rc-ttl{font-weight:950;color:#3a2433}
.result-small{margin:.2rem 0 0;color:var(--muted);font-size:.88rem}

/* âœ… ä»Šæ—¥ã®ä¸€æ‰‹ï¼šå›²ã„ */
.today-box{
  margin:.9rem 0 .2rem;
  padding:12px 12px 10px;
  border-radius:16px;
  border:1px solid rgba(140,107,255,.35);
  background:linear-gradient(135deg, rgba(140,107,255,.14), rgba(255,143,199,.12));
  box-shadow:0 10px 22px rgba(140,107,255,.12);
}
.today-head{
  display:inline-flex;align-items:center;gap:8px;
  font-weight:950;color:#2b1830;
  padding:2px 10px;border-radius:999px;
  background:rgba(255,255,255,.75);
  border:1px solid rgba(236,227,245,.9);
}
.today-text{margin:.55rem 0 0;font-weight:850;color:#2b1830}

/* å› å­ãƒãƒ¼ */
.bars{display:grid;grid-template-columns:1fr;gap:10px;margin-top:10px}
.bar{background:transparent;border-radius:10px;padding:4px 0 6px}
.bar .h{
  display:flex;justify-content:space-between;align-items:center;
  padding:2px 10px 4px;font-size:.9rem
}
.bar .h span:first-child{font-weight:850}
.bar .track{
  margin:0 10px 4px;height:10px;border-radius:999px;background:#f3e9ff;overflow:hidden;
  border:1px solid var(--line);
}
.bar .fill{
  height:100%;width:0%;
  background:linear-gradient(90deg,var(--accent),var(--accent2));
  border-radius:inherit;transition:width .25s ease-out;
}
.bar-desc{padding:0 10px 2px;font-size:.8rem;color:var(--muted)}

/* å‰å›å›ç­” */
.prev-list{list-style:none;padding-left:0;margin:.4rem 0 .2rem .9rem}
.prev-item{
  display:flex;gap:8px;align-items:flex-start;
  padding:6px 0;border-bottom:1px solid var(--line);
}
.prev-q{
  flex:1;min-width:0;
  display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;
  overflow:hidden;overflow-wrap:anywhere;
}
.prev-a{
  flex:0 0 auto;white-space:nowrap;
  border:1px solid var(--line);border-radius:999px;padding:2px 8px;
  font-size:.9rem;background:#faf5ff;
}

/* ã‚®ãƒ£ãƒ©ãƒªãƒ¼ */
.gallery{margin-top:2px;display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:10px;}
.gallery figure{
  margin:0;border:1px solid var(--line);border-radius:12px;background:#fff;
  padding:6px;text-align:center;font-size:.85rem;color:var(--muted);
  display:flex;flex-direction:column;gap:4px;
}
.gallery img{width:100%;aspect-ratio:1/1;object-fit:cover;border-radius:8px;display:block}

/* æŠ˜ã‚ŠãŸãŸã¿ */
.fold-card{
  margin:10px 0 8px;padding:8px 10px;border-radius:12px;
  border:1px solid var(--line);background:#fff;color:var(--muted);font-size:.9rem;
}
.fold-card summary{
  cursor:pointer;list-style:none;font-weight:850;
  display:flex;align-items:center;justify-content:space-between;
}
.fold-card[open]{background:#fdf7ff;box-shadow:0 3px 8px rgba(0,0,0,.03)}
.fold-card[open] summary{margin-bottom:6px}

/* ç ”ç©¶ãƒ¡ãƒ¢ */
.meta-note{
  margin-top:8px;padding:8px 10px;border-radius:12px;
  border:1px solid var(--line);background:#fdf7ff;color:var(--muted);font-size:.9rem;
}
.meta-note summary{
  cursor:pointer;list-style:none;font-weight:850;
  display:flex;align-items:center;justify-content:space-between;
}
.meta-note[open]{background:#fff}

/* ç ”ç©¶ãƒ¡ãƒ¢ï¼šæ®µè½åŒ–ï¼ˆä»Šå›è¿½åŠ ï¼‰ */
.meta-note #researchList{
  list-style:none;
  margin:.6rem 0 0;
  padding:0;
}
.meta-note .rm-group{
  margin:.6rem 0 .3rem;
  padding:6px 10px;
  border-radius:999px;
  background:#faf5ff;
  border:1px solid var(--line);
  font-weight:950;
  color:#4c2b5f;
}
.meta-note .rm-item{
  margin:.35rem 0;
  padding:10px 10px 9px;
  border-radius:12px;
  border:1px dashed var(--line);
  background:#fff;
}
.meta-note .rm-head{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  align-items:baseline;
}
.meta-note .rm-head strong{color:var(--ink)}
.meta-note .rm-tag{
  font-size:.78rem;
  padding:2px 8px;
  border-radius:999px;
  border:1px solid var(--line);
  background:#fff6fb;
  color:#6a5b70;
  font-weight:850;
}
.meta-note .rm-body{
  margin:.45rem 0 .35rem;
  line-height:1.65;
  color:#5b4b62;
}
.meta-note .rm-num{
  margin:.25rem 0 0;
  color:#7a6c86;
  font-size:.88rem;
}

/* ãƒ•ãƒƒã‚¿ */
.meta{color:#7a6c86;font-size:.92rem;clear:both;margin-top:.6rem}
.back-row{display:flex;gap:10px;flex-wrap:wrap;margin:12px 0 6px;}
.back{
  flex:1 1 220px;
  display:inline-flex;align-items:center;justify-content:center;gap:8px;
  padding:12px 16px;border-radius:999px;
  border:1px solid var(--line);background:#fff;color:var(--ink);
  font-weight:900;letter-spacing:.02em;cursor:pointer;
  font-size:1rem;
  box-shadow:0 12px 24px rgba(140,107,255,.14);
  transition:transform .12s ease, box-shadow .12s ease, border-color .12s ease;
}
.back:hover{transform:translateY(-1px);box-shadow:0 16px 30px rgba(140,107,255,.18);border-color:#ead9f2}
.back:active{transform:translateY(0);box-shadow:0 10px 20px rgba(140,107,255,.14)}
.back:focus-visible{outline:3px solid rgba(182,156,255,.35);outline-offset:3px}
.back-primary{
  border:0;background:linear-gradient(135deg,var(--accent),var(--accent2));
  color:#1b0f1c;box-shadow:0 14px 28px rgba(140,107,255,.22);
}
.back-ghost{background:linear-gradient(180deg,#fff,#fff6fb)}
.back .chev{
  display:inline-grid;place-items:center;width:22px;height:22px;border-radius:999px;
  background:rgba(182,156,255,.18);color:rgba(32,19,34,.75);
  font-size:1.15rem;line-height:1;
}

/* âœ…ã ã‘ã®ãƒˆãƒ¼ã‚¹ãƒˆ */
.mini-toast{
  position:fixed;left:50%;bottom:24px;
  transform:translateX(-50%) translateY(20px);
  opacity:0;background:#4c2b5f;color:#fff;
  padding:8px 12px;border-radius:999px;
  font-size:1.1rem;transition:.25s;z-index:40;
}
.mini-toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

/* å°ç”»é¢ */
@media (max-width:600px){
  header.hd .wrap{padding:16px 12px 8px}
  .paper{padding:14px 12px}
}
</style>
</head>

<!-- â˜… data-id ã¯ SLUG ã¨ä¸€è‡´ã•ã›ã‚‹ -->
<body data-id="lowback-weather">
<header class="hd" role="banner">
  <div class="wrap">
    <div class="ttl">
      <span aria-hidden="true">ğŸŒ¦ï¸</span>
      <span id="pageTitle">è…°ã®å¤©æ°—è¨ºæ–­</span>
      <span class="rank" aria-label="ç¾åœ¨ã®å¤©æ°—">
        <span aria-hidden="true">ğŸ§©</span><span>æœªåˆ¤å®š</span>
      </span>
    </div>
    <div class="sub" id="pageSub">
      ç—›ã¿ã®å¼·ã•ã˜ã‚ƒãªãã€æ…¢æ€§åŒ–ã®â€œç‡ƒæ–™â€ã«ãªã‚Šã‚„ã™ã„ã‚µã‚¤ãƒ³ã‚’å¤©æ°—ã«ã—ã¦ç‚¹æ¤œï¼ˆã¾ãšã¯å±é™ºã‚µã‚¤ãƒ³ã‚’åˆ¥æ ãƒã‚§ãƒƒã‚¯ï¼‰ã€‚
    </div>
  </div>
</header>

<!-- å›ºå®šé€²æ—ãƒãƒ¼ -->
<div class="progress-fixed" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
  <div class="progress-bar" style="width:0%"></div>
</div>

<main class="wrap" id="app" role="main" aria-live="polite">

  <!-- ãƒ’ãƒ¼ãƒ­ãƒ¼ï¼ˆt00.webpï¼‰ -->
  <figure class="hero">
    <img id="heroImg" src="/shindan/assets/results/lowback-weather/t00.webp" alt="è…°ã®å¤©æ°—è¨ºæ–­ ãƒ’ãƒ¼ãƒ­ãƒ¼ç”»åƒ" loading="lazy">
  </figure>

  <!-- ãƒ—ãƒ­ãƒ­ãƒ¼ã‚° -->
  <section id="prologue" class="paper" aria-label="ãƒ—ãƒ­ãƒ­ãƒ¼ã‚°">
    <h2 id="proTitle">ãƒ—ãƒ­ãƒ­ãƒ¼ã‚°ï¼šæœ¬æ—¥ã®ã€Œè…°äºˆå ±ã€</h2>
    <p id="proLine1">æœ¬æ—¥ã®è…°ã€å¹³ç©ãªæ™‚é–“å¸¯ãŒå¤šã„æ—¥ã‚‚ã‚ã‚Œã°ã€æ€¥ã«è’ã‚Œã‚‹æ—¥ã‚‚ã‚ã‚Šã¾ã™ã€‚</p>
    <p id="proLine2">ã“ã®è¨ºæ–­ã¯ç—…åå½“ã¦ã˜ã‚ƒãªãã€è’ã‚Œã‚„ã™ãã™ã‚‹<b>é»„ä¿¡å·ã®æ¡ä»¶</b>ã‚’ç‚¹æ¤œã™ã‚‹ã‚„ã¤ã§ã™ã€‚</p>
    <p id="proLine3">æœ€åˆã«å±é™ºã‚µã‚¤ãƒ³ã ã‘ç¢ºèªã—ã¦ã€OKãªã‚‰ãã®ã¾ã¾â€œäºˆå ±æœ¬ç·¨â€ã¸ã©ã†ãã€‚</p>
    <p class="note">â€»æœ¬ãƒšãƒ¼ã‚¸ã¯å¨¯æ¥½ï¼‹è‡ªå·±ç†è§£ã®è£œåŠ©ã§ã™ã€‚å¼·ã„ä¸èª¿ãŒç¶šããªã‚‰å°‚é–€æ©Ÿé–¢ã¸ã€‚</p>

    <button type="button" id="startBtn" class="start-btn" aria-label="è¨ºæ–­ã‚’å§‹ã‚ã‚‹">
      <span class="emo">âœ¨</span><span id="startLabel">è…°äºˆå ±ã‚’è¦‹ã‚‹</span>
    </button>
  </section>

  <!-- ãƒ¬ãƒƒãƒ‰ãƒ•ãƒ©ãƒƒã‚°ã‚²ãƒ¼ãƒˆ -->
  <section id="gate" class="paper gate" aria-label="å®‰å…¨ãƒã‚§ãƒƒã‚¯ï¼ˆä¸­æ–­ã‚²ãƒ¼ãƒˆï¼‰" style="display:none">
    <h2>å®‰å…¨ãƒã‚§ãƒƒã‚¯ï¼šå…ˆã«ã“ã“ã ã‘</h2>
    <p>ã“ã“ã¯ã‚¨ãƒ³ã‚¿ãƒ¡æŠœãã€‚<b>1ã¤ã§ã‚‚å½“ã¦ã¯ã¾ã‚‹</b>ãªã‚‰ã€ã“ã®è¨ºæ–­ã¯ä¸­æ–­ã—ã¦ã€Œå—è¨ºç›®å®‰ã€ã¸ã€‚</p>

    <div class="warnbox">
      <b>æ³¨æ„</b>ï¼šã“ã‚Œã¯â€œè…°ã®é»„ä¿¡å·è¨ºæ–­â€ã®å‰ææ¡ä»¶ãƒã‚§ãƒƒã‚¯ã§ã™ã€‚ç—›ã¿ãŒå¼·ã„ã»ã©å±é™ºã€ã¨ã¯é™ã‚Šã¾ã›ã‚“ã€‚
    </div>

    <div class="chklist" role="group" aria-label="å±é™ºã‚µã‚¤ãƒ³ã®ãƒã‚§ãƒƒã‚¯">
      <label class="chk">
        <input type="checkbox" class="rf" value="bladder">
        <div>
          <div class="t">æ’å°¿ãƒ»æ’ä¾¿ã®ç•°å¸¸ï¼ä¼šé™°éƒ¨ã®ã—ã³ã‚Œ</div>
          <div class="d">ã„ã¤ã‚‚ã¨é•ã†éº»ç—ºã£ã½ã•ã€æ„Ÿè¦šã®å¤‰åŒ–ãªã©</div>
        </div>
      </label>

      <label class="chk">
        <input type="checkbox" class="rf" value="weakness">
        <div>
          <div class="t">è„šã®è„±åŠ›ãŒé€²ã‚“ã§ã„ã‚‹ï¼ˆæ‚ªåŒ–ã—ã¦ã„ã‚‹ï¼‰</div>
          <div class="d">æ­©ãã¥ã‚‰ã•ãŒå¢—ãˆã‚‹ã€åŠ›ãŒå…¥ã‚‰ãªã„ ãªã©</div>
        </div>
      </label>

      <label class="chk">
        <input type="checkbox" class="rf" value="fever_loss">
        <div>
          <div class="t">ç™ºç†±ï¼åŸå› ä¸æ˜ã®ä½“é‡æ¸›å°‘ãŒã‚ã‚‹</div>
          <div class="d">è…°ç—›ã¨åŒæ™‚æœŸã«ä½“èª¿ã‚µã‚¤ãƒ³ãŒå¢—ãˆã¦ã„ã‚‹</div>
        </div>
      </label>

      <label class="chk">
        <input type="checkbox" class="rf" value="trauma">
        <div>
          <div class="t">å¼·ã„å¤–å‚·ã®ã‚ã¨ï¼éª¨ãŒå¼±ã„ãƒªã‚¹ã‚¯ãŒé«˜ã„</div>
          <div class="d">è»¢å€’ãƒ»äº‹æ•…ã®ã‚ã¨ã€ã¾ãŸã¯éª¨ç²—é¬†ãƒªã‚¹ã‚¯ãŒé«˜ã„ç­‰</div>
        </div>
      </label>

      <label class="chk">
        <input type="checkbox" class="rf" value="cancer">
        <div>
          <div class="t">ãŒã‚“æ—¢å¾€ãŒã‚ã‚Šã€æ–°ã—ãå¼·ã„ç—›ã¿ãŒå‡ºãŸ</div>
          <div class="d">æ—¢å¾€ãŒã‚ã‚‹å ´åˆã¯æ—©ã‚ã«ç›¸è«‡ãŒç„¡é›£</div>
        </div>
      </label>
    </div>

    <div class="gate-actions" aria-label="ã‚²ãƒ¼ãƒˆæ“ä½œ">
      <button type="button" id="gateCheckBtn" class="go" aria-label="å®‰å…¨ãƒã‚§ãƒƒã‚¯ã‚’ç¢ºå®šã—ã¦æ¬¡ã¸">
        âœ… ãƒã‚§ãƒƒã‚¯ã—ã¦æ¬¡ã¸
      </button>
      <button type="button" id="gateBackBtn" aria-label="ãƒ—ãƒ­ãƒ­ãƒ¼ã‚°ã¸æˆ»ã‚‹">
        â†©ï¸ ã‚‚ã©ã‚‹
      </button>
    </div>

    <div class="stop" id="stopBox" aria-label="ä¸­æ–­ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸">
      <div class="h">ä¸­æ–­ï¼šã“ã®è¨ºæ–­ã¯ã“ã“ã§æ­¢ã‚ã‚ˆã†ã€‚</div>
      <ul>
        <li>è©²å½“ã™ã‚‹ã‚µã‚¤ãƒ³ãŒã‚ã‚‹ãªã‚‰ã€ã¾ãšã¯åŒ»ç™‚æ©Ÿé–¢ãƒ»ç›¸è«‡çª“å£ã§ç¢ºèªãŒå®‰å…¨ã€‚</li>
        <li>æ€¥ãã»ã©ä¸å®‰ãŒå¢—ãˆã‚‹ãªã‚‰ã€åŒä¼´ã‚„é›»è©±ç›¸è«‡ã‚‚æ‰‹ã€‚</li>
      </ul>
      <div class="small">â€»ã“ã“ã‹ã‚‰å…ˆï¼ˆé»„ä¿¡å·ãƒã‚§ãƒƒã‚¯ï¼‰ã¯â€œå±é™ºã‚µã‚¤ãƒ³ãŒãªã„å‰æâ€ã®å†…å®¹ã§ã™ã€‚</div>
      <div class="back-row" style="margin-top:12px">
        <a class="back back-ghost" href="/shindan/" aria-label="è¨ºæ–­ä¸€è¦§ã«æˆ»ã‚‹">
          <span aria-hidden="true">ğŸ§ª</span><span>è¨ºæ–­ä¸€è¦§ã¸</span><span class="chev" aria-hidden="true">â€º</span>
        </a>
      </div>
    </div>
  </section>

  <!-- è³ªå•ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆåˆæœŸã¯éè¡¨ç¤ºï¼‰ -->
  <section id="quiz" class="paper" aria-label="è³ªå•ã‚»ã‚¯ã‚·ãƒ§ãƒ³" style="display:none">
    <div class="qhead">
      <div class="qnum" id="qnum">Q1/28</div>
      <div class="qtag" id="qtag"><span aria-hidden="true">ğŸ”–</span><span>ãƒã‚§ãƒƒã‚¯</span></div>
    </div>
    <div class="qtext" id="qtext">â€¦</div>
    <div class="opts" id="opts" role="group" aria-label="å›ç­”ã‚’é¸æŠ"></div>

    <div class="ctrls">
      <button type="button" id="prevBtn" aria-label="å‰ã®è¨­å•ã¸æˆ»ã‚‹">ã‚‚ã©ã‚‹</button>
    </div>
  </section>

  <!-- çµæœã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
  <section id="result" class="paper result" aria-label="çµæœã‚»ã‚¯ã‚·ãƒ§ãƒ³">
    <h2 style="margin-top:0">çµæœ</h2>

    <div class="flex">
      <div class="imgbox">
        <img id="resultImg" src="" alt="" loading="lazy">
      </div>
      <div class="text">
        <div class="badge-line">
          <span class="badge-pill" id="gradeBadge"><span aria-hidden="true">ğŸ§©</span><span>æœªåˆ¤å®š</span></span>
          <span class="badge-pill" id="scoreBadge">ç·åˆ â€”ç‚¹</span>
        </div>

        <h3 class="result-title-main" id="resultTitle">â€”</h3>
        <p class="result-title-sub" id="resultSubtitle">â€”</p>

        <div class="result-comment" id="resultComment" aria-label="çµæœã‚³ãƒ¡ãƒ³ãƒˆ">
          <p class="rc-ttl">â€”</p>
          <p>â€”</p>
        </div>

        <div class="today-box" aria-label="ä»Šæ—¥ã®ä¸€æ‰‹">
          <div class="today-head"><span aria-hidden="true">ğŸ§­</span><span>ä»Šæ—¥ã®ä¸€æ‰‹</span></div>
          <div class="today-text" id="todayText">â€”</div>
        </div>

        <p class="result-small" id="resultSmall" style="display:none"></p>

        <!-- å› å­ãƒãƒ¼ -->
        <div class="bars" id="bars" aria-label="å› å­ãƒãƒ¼"></div>
      </div>
    </div>

    <!-- å‰å›ã®å›ç­”ï¼ˆä¸€è¦§ï¼‰ -->
    <details id="prevBlock" class="fold-card">
      <summary>ğŸ“ å‰å›ã®å›ç­”ï¼ˆä¸€è¦§ï¼‰<span aria-hidden="true">â–¾</span></summary>
      <ul id="prevList" class="prev-list"></ul>
    </details>

    <!-- ã‚®ãƒ£ãƒ©ãƒªãƒ¼ï¼ˆt01ã€œt05ï¼‰ -->
    <details id="galleryBlock" class="fold-card">
      <summary>ğŸ–¼ å¤©æ°—ã®ã‚®ãƒ£ãƒ©ãƒªãƒ¼<span aria-hidden="true">â–¾</span></summary>
      <div class="gallery" id="gallery"></div>
    </details>

    <!-- ç ”ç©¶ãƒ¡ãƒ¢ -->
    <details class="meta-note" id="researchNotes">
      <summary>ğŸ“š ç ”ç©¶ãƒ¡ãƒ¢<span aria-hidden="true">â–¾</span></summary>
      <ul id="researchList">
  <!-- A) é»„ä¿¡å·ï¼ˆãƒªã‚¹ã‚¯å› å­ï¼‰ -->
  <li class="rm-group" aria-hidden="true"><span>é»„ä¿¡å·ï¼ˆãƒªã‚¹ã‚¯å› å­ï¼‰</span></li>

  <li class="rm-item">
    <div class="rm-head">
      <strong>ç³»çµ±çš„ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆ2002ï¼‰</strong>
      <span class="rm-tag">æ…¢æ€§åŒ–ã®äºˆæ¸¬å› å­</span>
    </div>
    <p class="rm-body">
      æ€¥æ€§â†’æ…¢æ€§ã¸ç§»ã‚‹ã¨ãã€<b>ã‚¹ãƒˆãƒ¬ã‚¹/è½ã¡è¾¼ã¿</b>ã‚„<b>èº«ä½“åŒ–ï¼ˆä¸å®‰ã§ç—‡çŠ¶ãŒå¢—å¹…ï¼‰</b>ãªã©ã®ã€Œé»„ä¿¡å·ã€ãŒç¹°ã‚Šè¿”ã—æŒ™ãŒã‚‹ã€‚
    </p>
    <p class="rm-num"><b>æ•°å€¤ï¼š</b>ï¼ˆã“ã®è¦ç´„å†…ã§ã¯å®šé‡ãªã—ï¼‰</p>
  </li>

  <li class="rm-item">
    <div class="rm-head">
      <strong>å‰å‘ãç ”ç©¶ï¼ˆ2007ï¼‰</strong>
      <span class="rm-tag">çµŒéã¨å¿ƒç†è¦å› </span>
    </div>
    <p class="rm-body">
      è…°ç—›ã®çµŒéã¯ã€Œç—›ã¿ã®å¼·ã•ã€ã ã‘ã§æ±ºã¾ã‚Šã«ããã€<b>ä¸å®‰ãƒ»æŠ‘ã†ã¤ãƒ»å¿ƒé…</b>ãŒã€ç—‡çŠ¶ã®é·å»¶ã‚„ç”Ÿæ´»ã¸ã®æ”¯éšœã¨çµã³ã¤ãã‚„ã™ã„ã€‚
    </p>
    <p class="rm-num"><b>æ•°å€¤ï¼š</b>ï¼ˆã“ã®è¦ç´„å†…ã§ã¯å®šé‡ãªã—ï¼‰</p>
  </li>

  <li class="rm-item">
    <div class="rm-head">
      <strong>ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆ2015ï¼‰</strong>
      <span class="rm-tag">ææ€–å›é¿ãƒ¢ãƒ‡ãƒ«</span>
    </div>
    <p class="rm-body">
      æ…¢æ€§ç—›ã§ã¯ã€<b>ææ€–â†’å›é¿â†’æ´»å‹•ä½ä¸‹â†’ã•ã‚‰ã«ææ€–</b>ã®ãƒ«ãƒ¼ãƒ—ãŒèµ·ãã‚„ã™ã„ã€‚ã“ã“ã‚’ã»ã©ãã¨ã€Œç”Ÿæ´»ã®è©°ã¾ã‚Šã€ã‚‚æ”¹å–„ã—ã‚„ã™ã„ã€‚
    </p>
    <p class="rm-num"><b>æ•°å€¤ï¼š</b>ï¼ˆã“ã®è¦ç´„å†…ã§ã¯å®šé‡ãªã—ï¼‰</p>
  </li>

  <li class="rm-item">
    <div class="rm-head">
      <strong>æ¨ªæ–­ç ”ç©¶ï¼ˆ2025, N=276ï¼‰</strong>
      <span class="rm-tag">ç ´å±€åŒ–ãƒ»ææ€–å›é¿</span>
    </div>
    <p class="rm-body">
      <b>ç ´å±€åŒ–</b>ã¯éšœå®³ï¼ˆç”Ÿæ´»ã®ä¸è‡ªç”±ã•ï¼‰ã¨å¼·ã‚ã«é–¢é€£ã€‚<b>ææ€–å›é¿</b>ã‚‚é–¢é€£ã¯ã‚ã‚‹ãŒå°ã•ã‚ã€‚ä¸¡è€…ã§éšœå®³ã®å·®ã®ä¸€éƒ¨ï¼ˆç´„3å‰²å°ï¼‰ã‚’èª¬æ˜ã™ã‚‹å ±å‘Šã€‚
    </p>
    <p class="rm-num"><b>æ•°å€¤ï¼š</b>ç ´å±€åŒ– râ‰ˆ0.52 / ææ€–å›é¿ râ‰ˆ0.20</p>
  </li>

  <li class="rm-item">
    <div class="rm-head">
      <strong>å‰å‘ãã‚³ãƒ›ãƒ¼ãƒˆï¼ˆ2021, N=8,601, ç´„20å¹´ä»¥ä¸Šè¿½è·¡ï¼‰</strong>
      <span class="rm-tag">ç¡çœ </span>
    </div>
    <p class="rm-body">
      <b>ç¡çœ ã®è³ªãŒé•·æœŸã«æ‚ªã„</b>äººã¯ã€å°†æ¥ã€Œè…°ç—›ç”±æ¥ã§ç”Ÿæ´»ãŒå›ã‚‰ãªã„ã€ãƒªã‚¹ã‚¯ãŒå¢—ãˆã‚„ã™ã„ã€‚
    </p>
    <p class="rm-num"><b>æ•°å€¤ï¼š</b>RRâ‰ˆ1.9ï¼ˆã ã„ãŸã„ç´„2å€ï¼‰</p>
  </li>

  <li class="rm-item">
    <div class="rm-head">
      <strong>ç³»çµ±çš„ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆ2024ï¼‰</strong>
      <span class="rm-tag">ç¤¾ä¼šçš„ã‚µãƒãƒ¼ãƒˆ</span>
    </div>
    <p class="rm-body">
      <b>ç¤¾ä¼šçš„ã‚µãƒãƒ¼ãƒˆ</b>ãŒé«˜ã„ã»ã©ã€ç—›ã¿/éšœå®³ã¯ã€Œå°‘ã—ä½ã„ã€å‚¾å‘ï¼ˆç›¸é–¢ã¯å¼±ã€œä¸­ï¼‰ã€‚
    </p>
    <p class="rm-num"><b>æ•°å€¤ï¼š</b>râ‰ˆ-0.2ã€œ-0.4</p>
  </li>

  <li class="rm-item">
    <div class="rm-head">
      <strong>è¿½è·¡ç ”ç©¶ï¼ˆ2025, N=1,772, 24ã‹æœˆï¼‰</strong>
      <span class="rm-tag">è‡ªå·±åŠ¹åŠ›æ„Ÿ</span>
    </div>
    <p class="rm-body">
      <b>è‡ªå·±åŠ¹åŠ›æ„Ÿï¼ˆè‡ªåˆ†ã§æ‰±ãˆã‚‹æ„Ÿï¼‰</b>ãŒé«˜ã„ç¾¤ã»ã©ã€ãã®å¾Œã®<b>ç—›ã¿ãŒä½ã‚</b>ã§ã€<b>éšœå®³ã‚¹ã‚³ã‚¢ã‚‚ã¯ã£ãã‚Šä½ã„</b>å ±å‘Šã€‚
    </p>
    <p class="rm-num"><b>æ•°å€¤ï¼š</b>éšœå®³ãŒç´„5ç‚¹ã¶ã‚“ä½ã„ï¼ˆä¾‹ï¼‰</p>
  </li>

  <!-- B) ã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ï¼ˆè³ªå•ç¥¨ï¼‰ -->
  <li class="rm-group" aria-hidden="true"><span>ã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ï¼ˆè³ªå•ç¥¨ï¼‰</span></li>

  <li class="rm-item">
    <div class="rm-head">
      <strong>ç³»çµ±çš„ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆ2012ï¼‰</strong>
      <span class="rm-tag">Ã–rebroç³»</span>
    </div>
    <p class="rm-body">
      æ…¢æ€§åŒ–ãƒªã‚¹ã‚¯ã®æ—©æœŸã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã¨ã—ã¦<b>Ã–rebroç³»</b>ã¯ç ”ç©¶ã§ã‚ˆãä½¿ã‚ã‚Œã‚‹ã€‚åˆ¤åˆ¥ã®å½“ãŸã‚Šå…·åˆã¯ä¸­ãã‚‰ã„ã€‚
    </p>
    <p class="rm-num"><b>æ•°å€¤ï¼š</b>æ„Ÿåº¦â‰ˆ0.59 / ç‰¹ç•°åº¦â‰ˆ0.77</p>
  </li>

  <li class="rm-item">
    <div class="rm-head">
      <strong>æ¤œè¨¼ç ”ç©¶ï¼ˆ2021ï¼‰</strong>
      <span class="rm-tag">STarT Backï¼ˆ9é …ç›®ï¼‰</span>
    </div>
    <p class="rm-body">
      ã€Œèº«ä½“ã€ã¨ã€Œå¿ƒç†ã€ã®2ã¾ã¨ã¾ã‚Šã§æ‰±ãˆã‚‹è¨­è¨ˆãŒãƒ‡ãƒ¼ã‚¿ã«åˆã„ã‚„ã™ãã€ã‚„ã‚Šç›´ã—ã§ã‚‚çµæœã¯æ¯”è¼ƒçš„å®‰å®šã€‚
    </p>
    <p class="rm-num"><b>æ•°å€¤ï¼š</b>CFIâ‰ˆ0.98 / RMSEAâ‰ˆ0.03 / ICCâ‰ˆ0.84</p>
  </li>

  <!-- C) å¿ƒç†ä»‹å…¥ï¼ˆã‚»ãƒ«ãƒ•ã‚±ã‚¢å«ã‚€ï¼‰ -->
  <li class="rm-group" aria-hidden="true"><span>å¿ƒç†ä»‹å…¥ï¼ˆã‚»ãƒ«ãƒ•ã‚±ã‚¢å«ã‚€ï¼‰</span></li>

  <li class="rm-item">
    <div class="rm-head">
      <strong>RCTï¼ˆ2016, N=342, 8é€±é–“ï¼‰</strong>
      <span class="rm-tag">MBSR / CBT</span>
    </div>
    <p class="rm-body">
      æ…¢æ€§è…°ç—›ã§ã€<b>MBSR</b>ã‚‚<b>CBT</b>ã‚‚é€šå¸¸ã‚±ã‚¢ã‚ˆã‚Šã€Œç”Ÿæ´»ã®ä¸è‡ªç”±ã•ã€ã€Œç—›ã¿ã®ã¤ã‚‰ã•ã€ãŒæ”¹å–„ã—ã‚„ã™ã„ã€‚
    </p>
    <p class="rm-num"><b>æ•°å€¤ï¼š</b>æ”¹å–„è€…å‰²åˆãŒé€šå¸¸ã‚±ã‚¢ã‚ˆã‚Šç´„1.3ã€œ1.4å€ï¼ˆè¡¨ç¾ï¼‰</p>
  </li>

  <li class="rm-item">
    <div class="rm-head">
      <strong>ãƒ¡ã‚¿åˆ†æï¼ˆ2022, RCT=6ä»¶, åˆè¨ˆN=300å°ã€œï¼‰</strong>
      <span class="rm-tag">MBSR</span>
    </div>
    <p class="rm-body">
      <b>MBSR</b>ã¯å¯¾ç…§ã‚ˆã‚Šã€æ©Ÿèƒ½ï¼ˆä¾‹ï¼šRoland-Morrisï¼‰ã‚’<b>å°‘ã—æ”¹å–„</b>ã€‚
    </p>
    <p class="rm-num"><b>æ•°å€¤ï¼š</b>å¹³å‡å·® â‰ˆ -1.3ç‚¹ï¼ˆä¾‹ï¼‰</p>
  </li>

  <li class="rm-item">
    <div class="rm-head">
      <strong>å°è¦æ¨¡RCTï¼ˆ2005, N=43, 8é€±é–“ï¼‰</strong>
      <span class="rm-tag">æ…ˆæ‚²ã®ç‘æƒ³ï¼ˆLKMï¼‰</span>
    </div>
    <p class="rm-body">
      <b>æ€’ã‚Šãƒ»å¿ƒç†çš„ã¤ã‚‰ã•</b>ã®è»½æ¸›ã¨ä¸€ç·’ã«æ”¹å–„ãŒå‡ºã‚‹å¯èƒ½æ€§ãŒå ±å‘Šï¼ˆå°è¦æ¨¡ï¼‰ã€‚
    </p>
    <p class="rm-num"><b>æ•°å€¤ï¼š</b>ï¼ˆã“ã®è¦ç´„å†…ã§ã¯åŠ¹æœé‡ã®æ˜è¨˜ãªã—ï¼‰</p>
  </li>

  <li class="rm-item">
    <div class="rm-head">
      <strong>ãƒ¡ã‚¿åˆ†æï¼ˆ2023, RCT=21ä»¶, N=1,962ï¼‰</strong>
      <span class="rm-tag">ACT</span>
    </div>
    <p class="rm-body">
      <b>ACT</b>ã¯å¯¾ç…§ã‚ˆã‚Šã€<b>æ©Ÿèƒ½éšœå®³</b>ã¨<b>ç—›ã¿</b>ãŒä¸‹ãŒã‚Šã‚„ã™ãã€ä¸å®‰ãƒ»æŠ‘ã†ã¤ã‚‚å°ã€œä¸­ç¨‹åº¦ã«ä¸‹ãŒã‚‹å ±å‘ŠãŒå¤šã„ã€‚
    </p>
    <p class="rm-num"><b>æ•°å€¤ï¼š</b>SMDâ‰ˆ-0.88ï¼ˆæ©Ÿèƒ½éšœå®³ï¼‰/ SMDâ‰ˆ-0.45ï¼ˆç—›ã¿ï¼‰</p>
  </li>

  <li class="rm-item">
    <div class="rm-head">
      <strong>RCTï¼ˆ2025, N=770, 12ã‹æœˆï¼‰</strong>
      <span class="rm-tag">ãƒã‚¤ãƒ³ãƒ‰ãƒ•ãƒ«ãƒã‚¹ç³» vs æ¨™æº–CBT</span>
    </div>
    <p class="rm-body">
      ä¸¡ç¾¤ã¨ã‚‚é•·æœŸã§ã®æ”¹å–„ãŒå ±å‘Šã•ã‚Œã€ä¸¡è€…ã®å·®ã¯å¤§ããã¯å‡ºã«ãã„ã‚¿ã‚¤ãƒ—ã®çµæœã€‚
    </p>
    <p class="rm-num"><b>æ•°å€¤ï¼š</b>ç—›ã¿ ç´„0.4ç‚¹ä½ä¸‹ï¼ˆ0ã€œ10å°ºåº¦ï¼‰</p>
  </li>

  <li class="rm-item">
    <div class="rm-head">
      <strong>ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆ2025ï¼‰</strong>
      <span class="rm-tag">ã‚ªãƒ³ãƒ©ã‚¤ãƒ³/é éš”</span>
    </div>
    <p class="rm-body">
      <b>ã‚ªãƒ³ãƒ©ã‚¤ãƒ³/é éš”</b>ã®å¿ƒç†ä»‹å…¥ï¼ˆCBTãªã©ï¼‰ã¯ã€å¯¾é¢ã«å¤§ããåŠ£ã‚‰ãšã€ç—›ã¿ã‚„QOLã®æ”¹å–„ã«å½¹ç«‹ã¤å¯èƒ½æ€§ï¼ˆã‚¢ã‚¯ã‚»ã‚¹ã®è‰¯ã•ãŒå¼·ã¿ï¼‰ã€‚
    </p>
    <p class="rm-num"><b>æ•°å€¤ï¼š</b>ï¼ˆã“ã®è¦ç´„å†…ã§ã¯å®šé‡ãªã—ï¼‰</p>
  </li>
</ul>
      <div style="margin-top:6px;color:var(--muted);font-size:.9rem;">
  ã“ã®è¨ºæ–­ã¯åŒ»ç™‚ã®ä»£æ›¿ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚è…°ç—›ãŒé•·å¼•ãã‚„ã™ã„ã€Œå¿ƒç†ç¤¾ä¼šçš„ãªè¦å› ï¼ˆã„ã‚ã‚†ã‚‹é»„ä¿¡å·ï¼‰ã€ã‚’æ•´ç†ã—ã€å¿…è¦ãªã‚‰ã‚»ãƒ«ãƒ•ã‚±ã‚¢ã‚„ç›¸è«‡å…ˆã‚’é¸ã³ã‚„ã™ãã™ã‚‹ãŸã‚ã®è£œåŠ©ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚
</div>
    </details>

    <p class="meta">â€»æœ¬ãƒšãƒ¼ã‚¸ã¯å¨¯æ¥½ï¼‹è‡ªå·±ç†è§£ã®è£œåŠ©ã‚’ç›®çš„ã¨ã—ãŸç°¡æ˜“ãƒ†ã‚¹ãƒˆã§ã™ã€‚ä½“èª¿ã‚„ä¸èª¿ãŒç¶šãå ´åˆã¯å°‚é–€æ©Ÿé–¢ã¸ã”ç›¸è«‡ãã ã•ã„ã€‚</p>

    <div class="back-row" aria-label="æ“ä½œãƒ¡ãƒ‹ãƒ¥ãƒ¼">
      <button type="button" class="back back-primary" id="restartBtn" aria-label="æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™">
        <span aria-hidden="true">ğŸ”</span><span>æœ€åˆã‹ã‚‰</span>
      </button>

      <a class="back back-ghost" href="/shindan/" aria-label="è¨ºæ–­ä¸€è¦§ã«æˆ»ã‚‹">
        <span aria-hidden="true">ğŸ§ª</span><span>è¨ºæ–­ä¸€è¦§ã¸</span><span class="chev" aria-hidden="true">â€º</span>
      </a>
    </div>
  </section>
</main>

<!-- âœ…ã ã‘ã®ãƒˆãƒ¼ã‚¹ãƒˆ -->
<div class="mini-toast" id="toast" role="status" aria-live="polite">âœ…</div>

<script>
/* ===== å›ºå®šé€²æ—ãƒãƒ¼ ===== */
function updateProgress(p){
  var bar = document.querySelector('.progress-bar');
  var wrap = document.querySelector('.progress-fixed');
  var val = Math.max(0,Math.min(100,p));
  if(bar) bar.style.width = val + '%';
  if(wrap) wrap.setAttribute('aria-valuenow', String(val));
}

/* ===== åŸºæœ¬è¨­å®š ===== */
const SLUG = 'lowback-weather';
const IMG_BASE = `/shindan/assets/results/${SLUG}/`;

/* ä¿å­˜ã‚­ãƒ¼ï¼ˆè¡çªå›é¿ï¼šSLUGã‚’å«ã‚ã‚‹ï¼‰ */
const LS_ANS     = `shindan:${SLUG}:answers`;
const LS_IDX     = `shindan:${SLUG}:index`;
const LS_LASTANS = `shindan:${SLUG}:lastAnswers`;

/* ===== å›ç­”ãƒ©ãƒ™ãƒ«ï¼ˆæ•°å­—ç¦æ­¢ï¼‰ ===== */
const LABELS = ['ãªã„','ãŸã¾ã«','åŠã€…','ã‚ã‚Šã¨','ã»ã¼ã„ã¤ã‚‚'];
function descFor(i){
  return ['ã»ã¼ãªã„','ã™ã“ã—','åŠã€…','ã‚ˆãã‚ã‚‹','ã‹ãªã‚Šã‚ã‚‹'][i] || '';
}

/* =========================================================
   å› å­ãƒ»è¨­å•ãƒ»æ¡ç‚¹ãƒ»çµæœæ–‡ï¼ˆè…°ã®å¤©æ°—è¨ºæ–­ï¼‰
========================================================= */

/* å› å­ï¼ˆ7æœ¬ï¼‰ */
const FACTS = ['F1','F2','F3','F4','F5','F6','F7'];
const FACT_LABEL = {
  F1:'ææ€–å›é¿ï¼ˆå‹•ããŒæ€–ã„ï¼‰',
  F2:'ç ´å±€åŒ–ãƒ»åã™ã†ï¼ˆæœ€æ‚ªåŒ–ï¼‰',
  F3:'æ°—åˆ†ãƒ»ã‚¹ãƒˆãƒ¬ã‚¹è² è·',
  F4:'ç¡çœ ã®ä¹±ã‚Œ',
  F5:'ç—‡çŠ¶ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°éå¤š',
  F6:'è‡ªå·±åŠ¹åŠ›æ„Ÿï¼ˆæ‰±ãˆã‚‹æ„Ÿï¼‰',
  F7:'æ”¯æ´ãƒ»å®‰å¿ƒåŸºåœ°'
};
const FACT_DESC  = {
  F1:'å‹•ãã»ã©æ‚ªåŒ–ã—ãã†ã§é¿ã‘ã‚‹ã»ã©ã€ä½“ã¯å›ºã¾ã‚Šã‚„ã™ã„ã€‚',
  F2:'ã€Œã“ã®ã¾ã¾çµ‚ã‚ã‚‹ã€æ€è€ƒã¯ã€è­¦å ±ã‚·ã‚¹ãƒ†ãƒ ã®ç‡ƒæ–™ã«ãªã‚ŠãŒã¡ã€‚',
  F3:'ç·Šå¼µãƒ»ä¸å®‰ãƒ»è½ã¡è¾¼ã¿ãŒå¼·ã„ã¨ã€ç—›ã¿ã®æ³¨æ„ãŒå›ºå®šã•ã‚Œã‚„ã™ã„ã€‚',
  F4:'ç¡çœ ã¯å›å¾©ã®å·¥å ´ã€‚å£Šã‚Œã‚‹ã¨ã€ç—›ã¿ã‚‚ç²˜ã‚Šã‚„ã™ã„ã€‚',
  F5:'å°ã•ãªé•å’Œæ„Ÿã‚’è¿½ã„ã‹ã‘ã‚‹ã»ã©ã€æ„Ÿåº¦ãŒä¸ŠãŒã£ã¦ã—ã¾ã†ã“ã¨ãŒã‚ã‚‹ã€‚',
  F6:'ã€Œè‡ªåˆ†ã§æ‰±ãˆã‚‹ã€æ„Ÿè¦šã¯ã€å›å¾©ã®åœŸå°ã«ãªã‚Šã‚„ã™ã„ã€‚',
  F7:'ç†è§£è€…ã‚„èª¿æ•´ã®ä½™åœ°ãŒã‚ã‚‹ã¨ã€å›é¿ã‚„éç·Šå¼µãŒæ¸›ã‚Šã‚„ã™ã„ã€‚'
};

/* è¨­å•ï¼š7å› å­Ã—4 = 28å•ï¼ˆå„å› å­ã«é€†è»¢1ã¤ï¼‰ */
const QUESTIONS = [
  // F1 ææ€–å›é¿
  {t:'ç—›ã¿ãŒå‡ºãã†ã§ã€å‹•ãæ–¹ã‚’â€œã‹ãªã‚Šæ§ãˆã‚â€ã«ã—ã¦ã„ã‚‹ã€‚', key:'F1'},
  {t:'è…°ã®ã“ã¨ãŒæ°—ã«ãªã£ã¦ã€å‰ã‚ˆã‚Šè¡Œå‹•ç¯„å›²ãŒç‹­ããªã£ãŸã€‚', key:'F1'},
  {t:'ã€Œç„¡ç†ã—ãªã„ã€ãŒç¶šã„ã¦ã€çµæœã¨ã—ã¦å‹•ãé‡ãŒæ¸›ã£ã¦ã„ã‚‹ã€‚', key:'F1'},
  {t:'å¤šå°‘ã®é•å’Œæ„ŸãŒã‚ã£ã¦ã‚‚ã€å·¥å¤«ã—ãªãŒã‚‰å‹•ã‘ã‚‹ã€‚', key:'F1', reverse:true},

  // F2 ç ´å±€åŒ–ãƒ»åã™ã†
  {t:'ç—›ã¿ã‚’è€ƒãˆã‚‹æ™‚é–“ãŒé•·ãã€é ­ã®ä¸­ã§ä½•åº¦ã‚‚å†ç”Ÿã•ã‚Œã‚‹ã€‚', key:'F2'},
  {t:'ã€Œã“ã‚Œã€ãšã£ã¨ç¶šãã‹ã‚‚ã€ã¨æœ€æ‚ªã®ã‚·ãƒŠãƒªã‚ªãŒæµ®ã‹ã³ã‚„ã™ã„ã€‚', key:'F2'},
  {t:'ç—›ã¿ã®æ„å‘³ï¼ˆåŸå› ï¼‰ã‚’è€ƒãˆå§‹ã‚ã‚‹ã¨æ­¢ã¾ã‚‰ãªããªã‚‹ã€‚', key:'F2'},
  {t:'ç—›ã¿ãŒã‚ã£ã¦ã‚‚ã€ã€Œã¾ã‚æ³¢ãŒã‚ã‚‹ã€ã¨å—ã‘æ­¢ã‚ã‚‰ã‚Œã‚‹ã€‚', key:'F2', reverse:true},

  // F3 æ°—åˆ†ãƒ»ã‚¹ãƒˆãƒ¬ã‚¹è² è·
  {t:'æœ€è¿‘ã€ç·Šå¼µãŒæŠœã‘ã«ããã€ä½“ãŒãšã£ã¨æ§‹ãˆã¦ã„ã‚‹æ„Ÿã˜ãŒã™ã‚‹ã€‚', key:'F3'},
  {t:'ã‚¤ãƒ©ã‚¤ãƒ©ã‚„ä¸å®‰ãŒå¢—ãˆã¦ã€ä½“ã®ä¸èª¿ã«ã‚‚æ•æ„Ÿã«ãªã£ã¦ã„ã‚‹ã€‚', key:'F3'},
  {t:'è½ã¡è¾¼ã¿æ°—å‘³ã§ã€å›å¾©ã®è¦‹é€šã—ãŒç«‹ã¡ã«ãã„ã€‚', key:'F3'},
  {t:'å«Œãªæ„Ÿæƒ…ãŒæ¥ã¦ã‚‚ã€ã„ã£ãŸã‚“è½ã¡ç€ã‹ã›ã‚‹è¡“ãŒã‚ã‚‹ã€‚', key:'F3', reverse:true},

  // F4 ç¡çœ ã®ä¹±ã‚Œ
  {t:'å¯ã¤ããŒæ‚ªã„ï¼å¤œä¸­ã«ç›®ãŒè¦šã‚ã‚‹ã“ã¨ãŒå¢—ãˆãŸã€‚', key:'F4'},
  {t:'å¯ã¦ã‚‚å›å¾©ã—ãŸæ„Ÿã˜ãŒå°‘ãªã„ã€‚', key:'F4'},
  {t:'ç¡çœ ã®è³ªãŒè½ã¡ã¦ã‹ã‚‰ã€ä½“ã®ä¸èª¿ãŒç²˜ã‚‹æ„Ÿã˜ãŒã‚ã‚‹ã€‚', key:'F4'},
  {t:'ç¡çœ ã¯ã ã„ãŸã„å®‰å®šã—ã¦ã„ã‚‹ã€‚', key:'F4', reverse:true},

  // F5 ç—‡çŠ¶ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°éå¤š
  {t:'ä½“ã®é•å’Œæ„Ÿã‚’ã€ç„¡æ„è­˜ã«ä½•åº¦ã‚‚ãƒã‚§ãƒƒã‚¯ã—ã¦ã—ã¾ã†ã€‚', key:'F5'},
  {t:'ã€Œã©ã“ã‹å£Šã‚ŒãŸæ°—ãŒã™ã‚‹ã€ãŒé ­ã«å±…åº§ã‚Šã‚„ã™ã„ã€‚', key:'F5'},
  {t:'ç—›ã¿ã®å¼·ã•ã‚„å ´æ‰€ã®å¤‰åŒ–ã«ã€ã™ãæ³¨æ„ãŒå¸ã„å¯„ã›ã‚‰ã‚Œã‚‹ã€‚', key:'F5'},
  {t:'é•å’Œæ„ŸãŒã‚ã£ã¦ã‚‚ã€æ„è­˜ã‚’åˆ¥ã®ã“ã¨ã«æˆ»ã›ã‚‹ã€‚', key:'F5', reverse:true},

  // F6 è‡ªå·±åŠ¹åŠ›æ„Ÿï¼ˆä½ã„ã»ã©é»„ä¿¡å·ï¼‰â€»é€†è»¢ã®æ‰±ã„ã«æ³¨æ„
  {t:'è‡ªåˆ†ã§è‰¯ãã—ã¦ã„ã‘ã‚‹æ„Ÿã˜ãŒã‚ã¾ã‚Šã—ãªã„ã€‚', key:'F6'},
  {t:'å¯¾å‡¦æ³•ãŒã‚ã£ã¦ã‚‚ã€Œçµå±€ã ã‚ã‹ã‚‚ã€ã¨æ€ã„ãŒã¡ã€‚', key:'F6'},
  {t:'å›å¾©ã®ä¸»å°æ¨©ãŒã€è‡ªåˆ†ã‚ˆã‚Šå¤–å´ã«ã‚ã‚‹æ„Ÿã˜ãŒã™ã‚‹ã€‚', key:'F6'},
  {t:'å·¥å¤«ã™ã‚Œã°ã€èª¿å­ã‚’ä¸Šã’ã‚‰ã‚Œã‚‹æ„Ÿè¦šãŒã‚ã‚‹ã€‚', key:'F6', reverse:true},

  // F7 ç¤¾ä¼šçš„æ”¯æ´
  {t:'ç†è§£ã—ã¦ãã‚Œã‚‹äººãŒå°‘ãªãã€èª¬æ˜ã™ã‚‹ã®ãŒã—ã‚“ã©ã„ã€‚', key:'F7'},
  {t:'è·å ´ã‚„å‘¨ã‚Šã«ç›¸è«‡ã—ã¥ã‚‰ãã€ä¸€äººã§æŠ±ãˆãŒã¡ã€‚', key:'F7'},
  {t:'é…æ…®ã‚„èª¿æ•´ã®ä½™åœ°ãŒãªãã€æ°—æŒã¡ãŒè©°ã¾ã‚Šã‚„ã™ã„ã€‚', key:'F7'},
  {t:'å®‰å¿ƒã—ã¦é ¼ã‚Œã‚‹äººï¼ˆå ´ï¼‰ãŒã‚ã‚‹ã€‚', key:'F7', reverse:true},
];

/* 5æ®µéšãƒ©ãƒ³ã‚¯ï¼ˆã‚¹ã‚³ã‚¢å¸¯â†’t01ã€œt05ï¼‰ */
const GRADE_DEF = [
  {
    min:0, max:39, emo:'â˜€ï¸', label:'æ™´ã‚Œ', img:'t01.webp', alt:'æ™´ã‚Œï¼ˆé»„ä¿¡å·ã¯è–„ã‚ï¼‰',
    headline:'æœ¬æ—¥ã®è…°ã€å¹³ç©ãªæ™‚é–“å¸¯ãŒå¤šãã†ã§ã™ã€‚',
    blurb:'ãŸã ã—å¤•æ–¹ã«ã‹ã‘ã¦ã€Œå–ã‚Šè¿”ã—ãƒ¢ãƒ¼ãƒ‰ã€ã®ç™ºç”Ÿç‡ãŒä¸ŠãŒã‚Šã¾ã™ã€‚ã¾ã¨ã‚ã¦ã‚„ã‚‹ã¨ç¿Œæ—¥ã«æ®‹ã‚Šã‚„ã™ã„ã®ã§ã€ä»Šæ—¥ã¯â€œæ¸©å­˜â€ãŒå¾—ã€‚<br><b>å¼·ã¿</b>ï¼šå›å¾©ã®åœŸå°ãŒã‚ã‚‹ã€‚<br><b>è½ã¨ã—ç©´</b>ï¼šæ™´ã‚Œã®æ—¥ã«è©°ã‚è¾¼ã¿ã™ãã¦åå‹•ã‚’å‘¼ã¶ã€‚',
    action:'å‹•ããªã‚‰30åˆ†ã§çµ‚ãˆã‚‹ï¼ˆè»½ã„æ•£æ­©ã‹ã€ã»ãã—ã‚’å°‘ã—ã ã‘ï¼‰ã€‚å‹ã¡é€ƒã’æ¨å¥¨ã€‚'
  },
  {
    min:40, max:59, emo:'â›…', label:'è–„æ›‡ã‚Š', img:'t02.webp', alt:'è–„æ›‡ã‚Šï¼ˆé»„ä¿¡å·ãŒæ··ã˜ã‚‹ï¼‰',
    headline:'æœ¬æ—¥ã®è…°ã€æ›‡ã‚ŠãŒã¡ã€‚å°ã•ãªä¸èª¿ãŒæ··ã˜ã‚Šã‚„ã™ã„ã§ã—ã‚‡ã†ã€‚',
    blurb:'ã€Œç„¡èŒ¶ã—ã¦æŠ¼ã—åˆ‡ã‚‹ã€ã‹ã€Œé‹å‹•ã›ãšå›ºã¾ã‚‹ã€ã‹ã€äºŒæŠã«å¯„ã‚‹ã¨å¤©æ°—ãŒå´©ã‚Œã‚„ã™ã„å¸¯ã§ã™ã€‚<br><b>å¼·ã¿</b>ï¼šã¾ã ä¿®æ­£ãŒåŠ¹ãã€‚<br><b>è½ã¨ã—ç©´</b>ï¼šæ¥µç«¯ãªé‹è»¢ã§è‡ªåˆ†ã‚’æºã‚‰ã—ã‚„ã™ã„ã€‚',
    action:'é¿ã‘ã¦ã‚‹å‹•ãã‚’1ã¤ã ã‘é¸ã‚“ã§ã€10åˆ†å‰²ã€‚ã„ã¡ã°ã‚“å°ã•ã„1å€‹ã ã‘è©¦ã™ã€‚'
  },
  {
    min:60, max:74, emo:'ğŸŒ§ï¸', label:'é›¨', img:'t03.webp', alt:'é›¨ï¼ˆé»„ä¿¡å·ãŒå¢—ãˆã¦ã„ã‚‹ï¼‰',
    headline:'æœ¬æ—¥ã®è…°ã€é›¨æ¨¡æ§˜ã€‚è­¦æˆ’ãŒå…ˆã«ç«‹ã¡ã‚„ã™ã„ã§ã—ã‚‡ã†ã€‚',
    blurb:'ã“ã®å¸¯ã¯ã€ç—›ã¿ãã®ã‚‚ã®ã‚ˆã‚Šã€Œæ°—ã«ã™ã‚‹æ™‚é–“ã€ãŒå¢—ãˆãŒã¡ã€‚ä½•åº¦ã‚‚æ€ã„å‡ºã™ã¨é€ƒã’ã‚‹ãŒã‚»ãƒƒãƒˆã«ãªã‚‹ã¨ã€é›¨ãŒé•·å¼•ãã¾ã™ã€‚<br><b>å¼·ã¿</b>ï¼šä½“ã ã‘ãŒåŸå› ã˜ã‚ƒãªã„å¯èƒ½æ€§ã«æ°—ã¥ã‘ã‚‹ã€‚<br><b>è½ã¨ã—ç©´</b>ï¼šè€ƒãˆã™ãã¦å‹•ã‘ãªããªã‚‹ã€‚',
    action:'ç—›ã¿ã®è§£é‡ˆã‚’1è¡Œã ã‘å·®ã—æ›¿ãˆã‚‹ï¼ˆä¾‹ï¼šã€Œæ•…éšœã€â†’ã€Œè­¦å ±ãŒæ•æ„Ÿã‹ã‚‚ã€ã€Œæ³¢ã‹ã‚‚ã€ï¼‰ã€‚'
  },
  {
    min:75, max:89, emo:'ğŸŒŠ', label:'è±ªé›¨', img:'t04.webp', alt:'è±ªé›¨ï¼ˆé»„ä¿¡å·ãŒæ¿ƒã„ï¼‰',
    headline:'æœ¬æ—¥ã®è…°ã€è±ªé›¨æ³¨æ„å ±ã€‚å›å¾©ãŒè¿½ã„ã¤ãã«ãã„è¦‹è¾¼ã¿ã§ã™ã€‚',
    blurb:'é ‘å¼µã‚Šã§å›ãã†ã¨ã—ã¦ã‚‚ã€ç¡çœ ã¨å®‰å¿ƒãŒå´©ã‚Œã¦ã„ã‚‹ã¨å›å¾©ãŒè¶³ã‚Šãªããªã‚Šã¾ã™ã€‚ãƒã‚§ãƒƒã‚¯ç™–ãŒå¢—ãˆã‚‹ã»ã©æ„Ÿåº¦ã‚‚ä¸ŠãŒã‚Šã€ã•ã‚‰ã«è’ã‚Œã‚„ã™ã„ã€‚<br><b>å¼·ã¿</b>ï¼šå®ˆã‚Šæ–¹ã•ãˆåˆãˆã°ç«‹ã¦ç›´ã›ã‚‹ã€‚<br><b>è½ã¨ã—ç©´</b>ï¼šã‚„ã‚‹ã“ã¨ã‚’å¢—ã‚„ã—ã¦ç©ºå›ã‚Šã€‚',
    action:'å¯ã‚‹90åˆ†å‰ã ã‘å›ºå®šï¼šé€šçŸ¥ã‚ªãƒ•ï¼‹ç…§æ˜è½ã¨ã™ï¼‹ã‚¹ãƒãƒ›é ã–ã‘ã‚‹ï¼ˆ3ç‚¹ã‚»ãƒƒãƒˆï¼‰ã€‚'
  },
  {
    min:90, max:100, emo:'ğŸŒªï¸', label:'åµ', img:'t05.webp', alt:'åµï¼ˆé»„ä¿¡å·ãŒæœ€å¤§ï¼‰',
    headline:'æœ¬æ—¥ã®è…°ã€è’å¤©æ³¨æ„å ±ã€‚ç„¡ç†ã«é€šå¸¸é‹è»¢ã‚’ç¶šã‘ã‚‹ã¨å´©ã‚Œã‚„ã™ã„ã§ã™ã€‚',
    blurb:'ç—›ã¿ã ã‘ã®å•é¡Œã˜ã‚ƒãªãã€Œæ­¢ã¾ã‚Œãªã„é‹è»¢ã€ãŒè’ã‚Œã‚’è‚²ã¦ã¦ã„ã‚‹å¯èƒ½æ€§ã€‚è²¬ä»»æ„Ÿã§å›ã›ã‚‹ã®ã¯å¼·ã¿ã§ã™ãŒã€ä»Šæ—¥ã¯ãã‚ŒãŒè£ç›®ã«å‡ºã‚„ã™ã„å¸¯ã§ã™ã€‚<br><b>å¼·ã¿</b>ï¼šåŠ¹ãå¯¾ç­–ãŒè¤‡æ•°ã‚ã‚‹<br><b>è½ã¨ã—ç©´</b>ï¼šä¸€äººã§è€ãˆã‚‹ã»ã©é•·å¼•ã',
    action:'ä»Šæ—¥ã ã‘ã¯æ¸›é€Ÿã‚’å…ˆã«æ±ºã‚ã‚‹ï¼šâ‘ å°‚é–€å®¶ã«ç›¸è«‡ â‘¡PSRT/PRT/CBT/MBSRç³»ã‚’èª¿ã¹ã‚‹ã€ã©ã£ã¡ã‹1ã¤ã ã‘é¸ã¶ã€‚'
  }
];
function gradeFromScore(pct){
  for(const g of GRADE_DEF){
    if(pct >= g.min && pct <= g.max) return g;
  }
  return GRADE_DEF[2];
}

/* æ¡ç‚¹
   - answers ã¯ 0..4ï¼ˆLABELSã®indexï¼‰
   - reverse:true ã¯ v=4-v
   - å› å­ã”ã¨å¹³å‡â†’0-100ã«å¤‰æ›
   - totalScore ã¯ 7å› å­pctã®å¹³å‡ï¼ˆ0-100ï¼‰
*/
function computeScores(answers){
  const sums = {}, counts = {};
  FACTS.forEach(k=>{ sums[k]=0; counts[k]=0; });

  QUESTIONS.forEach((q,i)=>{
    let v = answers[i];
    if(v==null) return;
    if(q.reverse) v = 4 - v;
    sums[q.key] += v;
    counts[q.key] += 1;
  });

  const pct = {};
  FACTS.forEach(k=>{
    const avg04 = counts[k] ? (sums[k]/counts[k]) : 0; // 0..4
    const a15 = avg04 + 1;                             // 1..5
    pct[k] = Math.round((a15-1)/4*100);                // 0..100
  });

  const totalScore = Math.round(FACTS.reduce((a,k)=>a+pct[k],0)/FACTS.length);
  return { pct, totalScore };
}

/* ã‚®ãƒ£ãƒ©ãƒªãƒ¼ï¼ˆt01ã€œt05ï¼‰ */
function buildGallery(){
  return [
    {img:'t01.webp', cap:'æ™´ã‚Œ', alt:'æ™´ã‚Œ'},
    {img:'t02.webp', cap:'è–„æ›‡ã‚Š', alt:'è–„æ›‡ã‚Š'},
    {img:'t03.webp', cap:'é›¨', alt:'é›¨'},
    {img:'t04.webp', cap:'è±ªé›¨', alt:'è±ªé›¨'},
    {img:'t05.webp', cap:'åµ', alt:'åµ'}
  ];
}

/* ===== çŠ¶æ…‹ ===== */
let idx = 0;
let answers = new Array(QUESTIONS.length).fill(null);

/* ===== è¦ç´  ===== */
const $qnum = document.getElementById('qnum');
const $qtag = document.getElementById('qtag');
const $qtext = document.getElementById('qtext');
const $opts = document.getElementById('opts');
const $prev = document.getElementById('prevBtn');

const $quiz = document.getElementById('quiz');
const $result = document.getElementById('result');
const $prologue = document.getElementById('prologue');
const $gate = document.getElementById('gate');
const $startBtn = document.getElementById('startBtn');

const $rankBadge = document.querySelector('.rank');
const $gradeBadge = document.getElementById('gradeBadge');
const $scoreBadge = document.getElementById('scoreBadge');

const $resultImg = document.getElementById('resultImg');
const $resultTitle = document.getElementById('resultTitle');
const $resultSubtitle = document.getElementById('resultSubtitle');

const $resultComment = document.getElementById('resultComment');
const $todayText = document.getElementById('todayText');

const $bars = document.getElementById('bars');
const $prevList = document.getElementById('prevList');
const $gallery = document.getElementById('gallery');

const $restart = document.getElementById('restartBtn');
const $toast = document.getElementById('toast');

/* Gate */
const $gateCheckBtn = document.getElementById('gateCheckBtn');
const $gateBackBtn = document.getElementById('gateBackBtn');
const $stopBox = document.getElementById('stopBox');

/* ===== ãƒˆãƒ¼ã‚¹ãƒˆ ===== */
let toastTimer = null;
function showToast(){
  if(!$toast) return;
  $toast.textContent = 'âœ…';
  $toast.classList.add('show');
  clearTimeout(toastTimer);
  toastTimer = setTimeout(()=> $toast.classList.remove('show'), 750);
}

/* ===== è¡¨ç¤ºåˆ‡æ›¿ ===== */
function enterPrologueMode(){
  $prologue.style.display = 'block';
  $gate.style.display = 'none';
  $quiz.style.display = 'none';
  $result.style.display = 'none';
  if($rankBadge) $rankBadge.innerHTML = '<span aria-hidden="true">ğŸ§©</span><span>æœªåˆ¤å®š</span>';
  updateProgress(0);
}
function enterGateMode(){
  $prologue.style.display = 'none';
  $gate.style.display = 'block';
  $quiz.style.display = 'none';
  $result.style.display = 'none';
  if($rankBadge) $rankBadge.innerHTML = '<span aria-hidden="true">ğŸ§©</span><span>æœªåˆ¤å®š</span>';
  updateProgress(0);
}
function enterQuizMode(){
  $prologue.style.display = 'none';
  $gate.style.display = 'none';
  $quiz.style.display = 'block';
  $result.style.display = 'none';
}
function enterResultMode(){
  $prologue.style.display = 'none';
  $gate.style.display = 'none';
  $quiz.style.display = 'none';
  $result.style.display = 'block';
}

/* ===== ä¿å­˜/å¾©å…ƒ ===== */
function persist(){
  try{
    localStorage.setItem(LS_ANS, JSON.stringify(answers));
    localStorage.setItem(LS_IDX, JSON.stringify(idx));
  }catch(_){}
}

/* ===== è³ªå•æç”» ===== */
function renderQuestion(){
  const q = QUESTIONS[idx];
  $qnum.textContent = `Q${idx+1}/${QUESTIONS.length}`;
  $qtext.textContent = q.t;

  // å› å­ãŒãƒãƒ¬ã‚‹ã¨èª¤èª­ã®æ¸©åºŠã«ãªã‚Šã‚„ã™ã„ã®ã§ã€å¸¸ã«å…±é€šãƒ©ãƒ™ãƒ«
  if($qtag) $qtag.innerHTML = `<span aria-hidden="true">ğŸ”–</span><span>ãƒã‚§ãƒƒã‚¯</span>`;

  $opts.innerHTML = '';
  LABELS.forEach((lab,i)=>{
    const btn = document.createElement('button');
    btn.type = 'button';
    btn.className = 'btn';
    btn.setAttribute('aria-pressed', answers[idx]===i ? 'true':'false');
    btn.innerHTML = `<span class="btn-label">${lab}</span><span class="opt-note">${descFor(i)}</span>`;
    btn.addEventListener('click', ()=> selectAnswer(i));
    $opts.appendChild(btn);
  });

  $prev.disabled = (idx===0);

  const done = answers.filter(v=>v!==null).length;
  updateProgress(Math.round(done/QUESTIONS.length*100));

  if($rankBadge) $rankBadge.innerHTML = '<span aria-hidden="true">ğŸ§©</span><span>æœªåˆ¤å®š</span>';
}
function markPressed(v){
  [...$opts.children].forEach((el,i)=> el.setAttribute('aria-pressed', i===v ? 'true' : 'false'));
}
function selectAnswer(v){
  answers[idx] = v;
  persist();
  markPressed(v);
  showToast();

  setTimeout(()=>{
    if(idx < QUESTIONS.length-1){
      idx++;
      renderQuestion();
    }else{
      enterResultMode();
      showResult();
    }
  },140);
}

/* ===== çµæœè¡¨ç¤º ===== */
function showResult(){
  // æœªå›ç­”ãŒã‚ã‚‹ãªã‚‰æœ€åˆã®æœªå›ç­”ã¸æˆ»ã™
  const firstNull = answers.findIndex(x=>x==null);
  if(firstNull !== -1){
    idx = firstNull;
    enterQuizMode();
    renderQuestion();
    return;
  }

  const {pct,totalScore} = computeScores(answers);
  const grade = gradeFromScore(totalScore);

  // ãƒ˜ãƒƒãƒ€ãƒãƒƒã‚¸
  if($rankBadge) $rankBadge.innerHTML = `<span aria-hidden="true">${grade.emo}</span><span>${grade.label}</span>`;

  // ç”»åƒ t01ã€œt05
  $resultImg.src = IMG_BASE + grade.img;
  $resultImg.alt = grade.alt || 'çµæœç”»åƒ';

  // è¦‹å‡ºã—ãƒ»ã‚¹ã‚³ã‚¢
  $resultTitle.textContent = `ã‚ãªãŸã®å¤©æ°—ï¼š${grade.label}`;
  $resultSubtitle.textContent = `ç·åˆï¼š${totalScore}ç‚¹ï¼ˆé»„ä¿¡å·ã®æ¿ƒã•ï¼‰`;
  if($scoreBadge) $scoreBadge.textContent = `ç·åˆ ${totalScore}ç‚¹`;
  if($gradeBadge) $gradeBadge.innerHTML = `<span aria-hidden="true">${grade.emo}</span><span>${grade.label}</span>`;

  if($resultComment){
    $resultComment.innerHTML = `
      <p class="rc-ttl">${grade.headline}</p>
      <p>${grade.blurb}</p>
    `;
  }
  if($todayText) $todayText.textContent = grade.action;

  // å› å­ãƒãƒ¼
  $bars.innerHTML = '';
  FACTS.forEach(k=>{
    const v = Math.max(0, Math.min(100, +pct[k]||0));
    const wrap = document.createElement('div');
    wrap.className = 'bar';
    wrap.innerHTML = `
      <div class="h"><span>${FACT_LABEL[k] || k}</span><span>${v}%</span></div>
      <div class="track"><div class="fill" style="width:${v}%"></div></div>
      <div class="bar-desc">${FACT_DESC[k] || ''}</div>
    `;
    $bars.appendChild(wrap);
  });

  // å‰å›å›ç­”ï¼ˆä¸€è¦§ï¼‰
  try{
    localStorage.setItem(LS_LASTANS, JSON.stringify({answers: answers.slice(), ts: Date.now()}));
  }catch(_){}
  buildPrevAnswers();

  // ã‚®ãƒ£ãƒ©ãƒªãƒ¼
  buildGalleryUI();

  // å®Œäº†ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆå¿…é ˆï¼‰
  document.dispatchEvent(new Event('result:ready'));
}

function buildPrevAnswers(){
  let prev = null;
  try{ prev = JSON.parse(localStorage.getItem(LS_LASTANS) || 'null'); }catch(_){}
  if(!prev || !Array.isArray(prev.answers)) return;

  $prevList.innerHTML = '';
  prev.answers.forEach((v,i)=>{
    const li = document.createElement('li');
    li.className = 'prev-item';
    const lab = (typeof v === 'number' && v>=0 && v<LABELS.length) ? LABELS[v] : 'â€”';
    li.innerHTML = `<span class="prev-q">Q${i+1}ï¼š${QUESTIONS[i].t}</span><span class="prev-a">ã€Œ${lab}ã€</span>`;
    $prevList.appendChild(li);
  });
}
function buildGalleryUI(){
  const g = buildGallery();
  $gallery.innerHTML = '';
  g.forEach(x=>{
    const fig = document.createElement('figure');
    fig.innerHTML = `
      <img src="${IMG_BASE + x.img}" alt="${x.alt||''}" loading="lazy">
      <figcaption>${x.cap||x.img}</figcaption>
    `;
    $gallery.appendChild(fig);
  });
}

/* ===== æ“ä½œ ===== */
$prev.addEventListener('click', ()=>{
  if(idx>0){ idx--; persist(); renderQuestion(); }
});
$startBtn.addEventListener('click', ()=>{
  enterGateMode();
  window.scrollTo({top:0,behavior:'smooth'});
});
$gateBackBtn.addEventListener('click', ()=>{
  enterPrologueMode();
  window.scrollTo({top:0,behavior:'smooth'});
});
$gateCheckBtn.addEventListener('click', ()=>{
  const any = !!document.querySelector('.rf:checked');
  if(any){
    $stopBox.style.display = 'block';
    updateProgress(0);
    // é€²æ—ã ã‘ã¯ã‚¼ãƒ­ã§å›ºå®šã€çµæœã«ã¯è¡Œã‹ãªã„
    return;
  }
  // OKãªã‚‰è¨­å•ã¸
  $stopBox.style.display = 'none';
  enterQuizMode();
  renderQuestion();
  window.scrollTo({top:0,behavior:'smooth'});
});

$restart.addEventListener('click', ()=>{
  answers = new Array(QUESTIONS.length).fill(null);
  idx = 0;
  try{ localStorage.removeItem(LS_ANS); localStorage.removeItem(LS_IDX); }catch(_){}
  enterPrologueMode();
  window.scrollTo({top:0,behavior:'smooth'});
  showToast();
});

/* ===== èµ·å‹•ï¼šå¾©å…ƒ or ãƒ—ãƒ­ãƒ­ãƒ¼ã‚° ===== */
(function init(){
  // ãƒ’ãƒ¼ãƒ­ãƒ¼ã¯å¸¸ã« t00.webpï¼ˆæ­£æ–¹å½¢ï¼‰
  const hero = document.getElementById('heroImg');
  if(hero) hero.src = IMG_BASE + 't00.webp';

  updateProgress(0);

  let savedAns=null, savedIdx=0;
  try{
    savedAns = JSON.parse(localStorage.getItem(LS_ANS) || 'null');
    savedIdx = JSON.parse(localStorage.getItem(LS_IDX) || '0');
  }catch(_){}
  const valid = Array.isArray(savedAns) && savedAns.length === QUESTIONS.length;
  const hasAny = valid && savedAns.some(v=>v!==null);
  const allDone = valid && savedAns.every(v=>v!==null);

  // é–‹ãç›´ã—ï¼šå®Œäº†æ¸ˆã¿ãªã‚‰çµæœã‹ã‚‰
  if(allDone){
    answers = savedAns;
    idx = QUESTIONS.length - 1;
    renderQuestion(); // çŠ¶æ…‹ã ã‘æ•´ãˆã‚‹
    enterResultMode();
    showResult();
    return;
  }
  // é€”ä¸­ãªã‚‰é€”ä¸­ã‹ã‚‰
  if(hasAny){
    answers = savedAns;
    idx = Math.min(Math.max(0, +savedIdx || 0), QUESTIONS.length-1);
    enterQuizMode();
    renderQuestion();
    return;
  }
  enterPrologueMode();
}());
</script>

<!-- ã‚ãªãŸã®ã“ã“ã‚Lvï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã®ã¿ï¼‰ -->
<script>(function(){
  var DONE_KEY='specimens:open:byid', TOTAL_KEY='specimens:open:total';
  var MY_ID=document.body.getAttribute('data-id')||SLUG;
  var marked=false;
  function mark(){ if(marked) return; marked=true;
    try{
      var t=(+localStorage.getItem(TOTAL_KEY)||0)+1;
      localStorage.setItem(TOTAL_KEY,String(t));
      var map={}; try{ map=JSON.parse(localStorage.getItem(DONE_KEY)||'{}'); }catch(_){}
      map[MY_ID]=(map[MY_ID]||0)+1;
      localStorage.setItem(DONE_KEY, JSON.stringify(Object.assign({},map,{_ts:Date.now()})));
    }catch(_){}
  }
  document.addEventListener('result:ready', mark);
  setTimeout(mark, 2000);
}());</script>

</body>
</html>